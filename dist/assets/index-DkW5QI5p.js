var Ax=Object.defineProperty;var h3=r=>{throw TypeError(r)};var Ex=(r,e,t)=>e in r?Ax(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var he=(r,e,t)=>Ex(r,typeof e!="symbol"?e+"":e,t),V1=(r,e,t)=>e.has(r)||h3("Cannot "+t);var u=(r,e,t)=>(V1(r,e,"read from private field"),t?t.call(r):e.get(r)),E=(r,e,t)=>e.has(r)?h3("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),S=(r,e,t,n)=>(V1(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),k=(r,e,t)=>(V1(r,e,"access private method"),t);var xr=(r,e,t,n)=>({set _(s){S(r,e,s,t)},get _(){return u(r,e,n)}});function kx(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function Tx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Cx(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var h6={exports:{}},h1={},d6={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf=Symbol.for("react.element"),Rx=Symbol.for("react.portal"),Px=Symbol.for("react.fragment"),Mx=Symbol.for("react.strict_mode"),Ix=Symbol.for("react.profiler"),Ox=Symbol.for("react.provider"),Nx=Symbol.for("react.context"),Lx=Symbol.for("react.forward_ref"),Dx=Symbol.for("react.suspense"),Fx=Symbol.for("react.memo"),zx=Symbol.for("react.lazy"),d3=Symbol.iterator;function Bx(r){return r===null||typeof r!="object"?null:(r=d3&&r[d3]||r["@@iterator"],typeof r=="function"?r:null)}var f6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p6=Object.assign,m6={};function hh(r,e,t){this.props=r,this.context=e,this.refs=m6,this.updater=t||f6}hh.prototype.isReactComponent={};hh.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};hh.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function g6(){}g6.prototype=hh.prototype;function Ey(r,e,t){this.props=r,this.context=e,this.refs=m6,this.updater=t||f6}var ky=Ey.prototype=new g6;ky.constructor=Ey;p6(ky,hh.prototype);ky.isPureReactComponent=!0;var f3=Array.isArray,v6=Object.prototype.hasOwnProperty,Ty={current:null},y6={key:!0,ref:!0,__self:!0,__source:!0};function w6(r,e,t){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)v6.call(e,n)&&!y6.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(r&&r.defaultProps)for(n in o=r.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:pf,type:r,key:i,ref:a,props:s,_owner:Ty.current}}function jx(r,e){return{$$typeof:pf,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function Cy(r){return typeof r=="object"&&r!==null&&r.$$typeof===pf}function $x(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(t){return e[t]})}var p3=/\/+/g;function G1(r,e){return typeof r=="object"&&r!==null&&r.key!=null?$x(""+r.key):e.toString(36)}function fp(r,e,t,n,s){var i=typeof r;(i==="undefined"||i==="boolean")&&(r=null);var a=!1;if(r===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(r.$$typeof){case pf:case Rx:a=!0}}if(a)return a=r,s=s(a),r=n===""?"."+G1(a,0):n,f3(s)?(t="",r!=null&&(t=r.replace(p3,"$&/")+"/"),fp(s,e,t,"",function(c){return c})):s!=null&&(Cy(s)&&(s=jx(s,t+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(p3,"$&/")+"/")+r)),e.push(s)),1;if(a=0,n=n===""?".":n+":",f3(r))for(var o=0;o<r.length;o++){i=r[o];var l=n+G1(i,o);a+=fp(i,e,t,l,s)}else if(l=Bx(r),typeof l=="function")for(r=l.call(r),o=0;!(i=r.next()).done;)i=i.value,l=n+G1(i,o++),a+=fp(i,e,t,l,s);else if(i==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Cf(r,e,t){if(r==null)return r;var n=[],s=0;return fp(r,n,"","",function(i){return e.call(t,i,s++)}),n}function Ux(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(t){(r._status===0||r._status===-1)&&(r._status=1,r._result=t)},function(t){(r._status===0||r._status===-1)&&(r._status=2,r._result=t)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var Fr={current:null},pp={transition:null},Hx={ReactCurrentDispatcher:Fr,ReactCurrentBatchConfig:pp,ReactCurrentOwner:Ty};function b6(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:Cf,forEach:function(r,e,t){Cf(r,function(){e.apply(this,arguments)},t)},count:function(r){var e=0;return Cf(r,function(){e++}),e},toArray:function(r){return Cf(r,function(e){return e})||[]},only:function(r){if(!Cy(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};Pe.Component=hh;Pe.Fragment=Px;Pe.Profiler=Ix;Pe.PureComponent=Ey;Pe.StrictMode=Mx;Pe.Suspense=Dx;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hx;Pe.act=b6;Pe.cloneElement=function(r,e,t){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var n=p6({},r.props),s=r.key,i=r.ref,a=r._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Ty.current),e.key!==void 0&&(s=""+e.key),r.type&&r.type.defaultProps)var o=r.type.defaultProps;for(l in e)v6.call(e,l)&&!y6.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:pf,type:r.type,key:s,ref:i,props:n,_owner:a}};Pe.createContext=function(r){return r={$$typeof:Nx,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:Ox,_context:r},r.Consumer=r};Pe.createElement=w6;Pe.createFactory=function(r){var e=w6.bind(null,r);return e.type=r,e};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(r){return{$$typeof:Lx,render:r}};Pe.isValidElement=Cy;Pe.lazy=function(r){return{$$typeof:zx,_payload:{_status:-1,_result:r},_init:Ux}};Pe.memo=function(r,e){return{$$typeof:Fx,type:r,compare:e===void 0?null:e}};Pe.startTransition=function(r){var e=pp.transition;pp.transition={};try{r()}finally{pp.transition=e}};Pe.unstable_act=b6;Pe.useCallback=function(r,e){return Fr.current.useCallback(r,e)};Pe.useContext=function(r){return Fr.current.useContext(r)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(r){return Fr.current.useDeferredValue(r)};Pe.useEffect=function(r,e){return Fr.current.useEffect(r,e)};Pe.useId=function(){return Fr.current.useId()};Pe.useImperativeHandle=function(r,e,t){return Fr.current.useImperativeHandle(r,e,t)};Pe.useInsertionEffect=function(r,e){return Fr.current.useInsertionEffect(r,e)};Pe.useLayoutEffect=function(r,e){return Fr.current.useLayoutEffect(r,e)};Pe.useMemo=function(r,e){return Fr.current.useMemo(r,e)};Pe.useReducer=function(r,e,t){return Fr.current.useReducer(r,e,t)};Pe.useRef=function(r){return Fr.current.useRef(r)};Pe.useState=function(r){return Fr.current.useState(r)};Pe.useSyncExternalStore=function(r,e,t){return Fr.current.useSyncExternalStore(r,e,t)};Pe.useTransition=function(){return Fr.current.useTransition()};Pe.version="18.3.1";d6.exports=Pe;var nt=d6.exports;const qx=Tx(nt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vx=nt,Gx=Symbol.for("react.element"),Wx=Symbol.for("react.fragment"),Kx=Object.prototype.hasOwnProperty,Xx=Vx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Yx={key:!0,ref:!0,__self:!0,__source:!0};function S6(r,e,t){var n,s={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Kx.call(e,n)&&!Yx.hasOwnProperty(n)&&(s[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Gx,type:r,key:i,ref:a,props:s,_owner:Xx.current}}h1.Fragment=Wx;h1.jsx=S6;h1.jsxs=S6;h6.exports=h1;var z=h6.exports,Yg={},_6={exports:{}},Rn={},x6={exports:{}},A6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(V,le){var re=V.length;V.push(le);e:for(;0<re;){var Se=re-1>>>1,ve=V[Se];if(0<s(ve,le))V[Se]=le,V[re]=ve,re=Se;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var le=V[0],re=V.pop();if(re!==le){V[0]=re;e:for(var Se=0,ve=V.length,De=ve>>>1;Se<De;){var Ct=2*(Se+1)-1,qt=V[Ct],Ve=Ct+1,F=V[Ve];if(0>s(qt,re))Ve<ve&&0>s(F,qt)?(V[Se]=F,V[Ve]=re,Se=Ve):(V[Se]=qt,V[Ct]=re,Se=Ct);else if(Ve<ve&&0>s(F,re))V[Se]=F,V[Ve]=re,Se=Ve;else break e}}return le}function s(V,le){var re=V.sortIndex-le.sortIndex;return re!==0?re:V.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,d=null,f=3,p=!1,g=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(V){for(var le=t(c);le!==null;){if(le.callback===null)n(c);else if(le.startTime<=V)n(c),le.sortIndex=le.expirationTime,e(l,le);else break;le=t(c)}}function C(V){if(w=!1,_(V),!g)if(t(l)!==null)g=!0,W(R);else{var le=t(c);le!==null&&ne(C,le.startTime-V)}}function R(V,le){g=!1,w&&(w=!1,y(D),D=-1),p=!0;var re=f;try{for(_(le),d=t(l);d!==null&&(!(d.expirationTime>le)||V&&!K());){var Se=d.callback;if(typeof Se=="function"){d.callback=null,f=d.priorityLevel;var ve=Se(d.expirationTime<=le);le=r.unstable_now(),typeof ve=="function"?d.callback=ve:d===t(l)&&n(l),_(le)}else n(l);d=t(l)}if(d!==null)var De=!0;else{var Ct=t(c);Ct!==null&&ne(C,Ct.startTime-le),De=!1}return De}finally{d=null,f=re,p=!1}}var I=!1,O=null,D=-1,B=5,q=-1;function K(){return!(r.unstable_now()-q<B)}function de(){if(O!==null){var V=r.unstable_now();q=V;var le=!0;try{le=O(!0,V)}finally{le?Re():(I=!1,O=null)}}else I=!1}var Re;if(typeof b=="function")Re=function(){b(de)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Be=ge.port2;ge.port1.onmessage=de,Re=function(){Be.postMessage(null)}}else Re=function(){x(de,0)};function W(V){O=V,I||(I=!0,Re())}function ne(V,le){D=x(function(){V(r.unstable_now())},le)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){g||p||(g=!0,W(R))},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return f},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(V){switch(f){case 1:case 2:case 3:var le=3;break;default:le=f}var re=f;f=le;try{return V()}finally{f=re}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,le){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var re=f;f=V;try{return le()}finally{f=re}},r.unstable_scheduleCallback=function(V,le,re){var Se=r.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?Se+re:Se):re=Se,V){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=re+ve,V={id:h++,callback:le,priorityLevel:V,startTime:re,expirationTime:ve,sortIndex:-1},re>Se?(V.sortIndex=re,e(c,V),t(l)===null&&V===t(c)&&(w?(y(D),D=-1):w=!0,ne(C,re-Se))):(V.sortIndex=ve,e(l,V),g||p||(g=!0,W(R))),V},r.unstable_shouldYield=K,r.unstable_wrapCallback=function(V){var le=f;return function(){var re=f;f=le;try{return V.apply(this,arguments)}finally{f=re}}}})(A6);x6.exports=A6;var Qx=x6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx=nt,Cn=Qx;function H(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var E6=new Set,m0={};function au(r,e){rh(r,e),rh(r+"Capture",e)}function rh(r,e){for(m0[r]=e,r=0;r<e.length;r++)E6.add(e[r])}var Ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qg=Object.prototype.hasOwnProperty,Zx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m3={},g3={};function e9(r){return Qg.call(g3,r)?!0:Qg.call(m3,r)?!1:Zx.test(r)?g3[r]=!0:(m3[r]=!0,!1)}function t9(r,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function r9(r,e,t,n){if(e===null||typeof e>"u"||t9(r,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zr(r,e,t,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=r,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var or={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){or[r]=new zr(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];or[e]=new zr(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){or[r]=new zr(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){or[r]=new zr(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){or[r]=new zr(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){or[r]=new zr(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){or[r]=new zr(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){or[r]=new zr(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){or[r]=new zr(r,5,!1,r.toLowerCase(),null,!1,!1)});var Ry=/[\-:]([a-z])/g;function Py(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(Ry,Py);or[e]=new zr(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(Ry,Py);or[e]=new zr(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(Ry,Py);or[e]=new zr(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){or[r]=new zr(r,1,!1,r.toLowerCase(),null,!1,!1)});or.xlinkHref=new zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){or[r]=new zr(r,1,!1,r.toLowerCase(),null,!0,!0)});function My(r,e,t,n){var s=or.hasOwnProperty(e)?or[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(r9(e,t,s,n)&&(t=null),n||s===null?e9(e)&&(t===null?r.removeAttribute(e):r.setAttribute(e,""+t)):s.mustUseProperty?r[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,n=s.attributeNamespace,t===null?r.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,n?r.setAttributeNS(n,e,t):r.setAttribute(e,t))))}var oa=Jx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rf=Symbol.for("react.element"),Tu=Symbol.for("react.portal"),Cu=Symbol.for("react.fragment"),Iy=Symbol.for("react.strict_mode"),Jg=Symbol.for("react.profiler"),k6=Symbol.for("react.provider"),T6=Symbol.for("react.context"),Oy=Symbol.for("react.forward_ref"),Zg=Symbol.for("react.suspense"),ev=Symbol.for("react.suspense_list"),Ny=Symbol.for("react.memo"),pa=Symbol.for("react.lazy"),C6=Symbol.for("react.offscreen"),v3=Symbol.iterator;function wh(r){return r===null||typeof r!="object"?null:(r=v3&&r[v3]||r["@@iterator"],typeof r=="function"?r:null)}var yt=Object.assign,W1;function Ih(r){if(W1===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);W1=e&&e[1]||""}return`
`+W1+r}var K1=!1;function X1(r,e){if(!r||K1)return"";K1=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(r,[],e)}else{try{e.call()}catch(c){n=c}r.call(e.prototype)}else{try{throw Error()}catch(c){n=c}r()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=a&&0<=o);break}}}finally{K1=!1,Error.prepareStackTrace=t}return(r=r?r.displayName||r.name:"")?Ih(r):""}function n9(r){switch(r.tag){case 5:return Ih(r.type);case 16:return Ih("Lazy");case 13:return Ih("Suspense");case 19:return Ih("SuspenseList");case 0:case 2:case 15:return r=X1(r.type,!1),r;case 11:return r=X1(r.type.render,!1),r;case 1:return r=X1(r.type,!0),r;default:return""}}function tv(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case Cu:return"Fragment";case Tu:return"Portal";case Jg:return"Profiler";case Iy:return"StrictMode";case Zg:return"Suspense";case ev:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case T6:return(r.displayName||"Context")+".Consumer";case k6:return(r._context.displayName||"Context")+".Provider";case Oy:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Ny:return e=r.displayName||null,e!==null?e:tv(r.type)||"Memo";case pa:e=r._payload,r=r._init;try{return tv(r(e))}catch{}}return null}function s9(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tv(e);case 8:return e===Iy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function co(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function R6(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function i9(r){var e=R6(r)?"checked":"value",t=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),n=""+r[e];if(!r.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(r,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function Pf(r){r._valueTracker||(r._valueTracker=i9(r))}function P6(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return r&&(n=R6(r)?r.checked?"true":"false":r.value),r=n,r!==t?(e.setValue(r),!0):!1}function sm(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function rv(r,e){var t=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??r._wrapperState.initialChecked})}function y3(r,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=co(e.value!=null?e.value:t),r._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function M6(r,e){e=e.checked,e!=null&&My(r,"checked",e,!1)}function nv(r,e){M6(r,e);var t=co(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&r.value===""||r.value!=t)&&(r.value=""+t):r.value!==""+t&&(r.value=""+t);else if(n==="submit"||n==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?sv(r,e.type,t):e.hasOwnProperty("defaultValue")&&sv(r,e.type,co(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function w3(r,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,t||e===r.value||(r.value=e),r.defaultValue=e}t=r.name,t!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,t!==""&&(r.name=t)}function sv(r,e,t){(e!=="number"||sm(r.ownerDocument)!==r)&&(t==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+t&&(r.defaultValue=""+t))}var Oh=Array.isArray;function $u(r,e,t,n){if(r=r.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<r.length;t++)s=e.hasOwnProperty("$"+r[t].value),r[t].selected!==s&&(r[t].selected=s),s&&n&&(r[t].defaultSelected=!0)}else{for(t=""+co(t),e=null,s=0;s<r.length;s++){if(r[s].value===t){r[s].selected=!0,n&&(r[s].defaultSelected=!0);return}e!==null||r[s].disabled||(e=r[s])}e!==null&&(e.selected=!0)}}function iv(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function b3(r,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(H(92));if(Oh(t)){if(1<t.length)throw Error(H(93));t=t[0]}e=t}e==null&&(e=""),t=e}r._wrapperState={initialValue:co(t)}}function I6(r,e){var t=co(e.value),n=co(e.defaultValue);t!=null&&(t=""+t,t!==r.value&&(r.value=t),e.defaultValue==null&&r.defaultValue!==t&&(r.defaultValue=t)),n!=null&&(r.defaultValue=""+n)}function S3(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function O6(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function av(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?O6(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Mf,N6=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,s){MSApp.execUnsafeLocalFunction(function(){return r(e,t,n,s)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for(Mf=Mf||document.createElement("div"),Mf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mf.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function g0(r,e){if(e){var t=r.firstChild;if(t&&t===r.lastChild&&t.nodeType===3){t.nodeValue=e;return}}r.textContent=e}var e0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a9=["Webkit","ms","Moz","O"];Object.keys(e0).forEach(function(r){a9.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),e0[e]=e0[r]})});function L6(r,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||e0.hasOwnProperty(r)&&e0[r]?(""+e).trim():e+"px"}function D6(r,e){r=r.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,s=L6(t,e[t],n);t==="float"&&(t="cssFloat"),n?r.setProperty(t,s):r[t]=s}}var o9=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ov(r,e){if(e){if(o9[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function lv(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uv=null;function Ly(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var cv=null,Uu=null,Hu=null;function _3(r){if(r=vf(r)){if(typeof cv!="function")throw Error(H(280));var e=r.stateNode;e&&(e=g1(e),cv(r.stateNode,r.type,e))}}function F6(r){Uu?Hu?Hu.push(r):Hu=[r]:Uu=r}function z6(){if(Uu){var r=Uu,e=Hu;if(Hu=Uu=null,_3(r),e)for(r=0;r<e.length;r++)_3(e[r])}}function B6(r,e){return r(e)}function j6(){}var Y1=!1;function $6(r,e,t){if(Y1)return r(e,t);Y1=!0;try{return B6(r,e,t)}finally{Y1=!1,(Uu!==null||Hu!==null)&&(j6(),z6())}}function v0(r,e){var t=r.stateNode;if(t===null)return null;var n=g1(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(r=r.type,n=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!n;break e;default:r=!1}if(r)return null;if(t&&typeof t!="function")throw Error(H(231,e,typeof t));return t}var hv=!1;if(Ji)try{var bh={};Object.defineProperty(bh,"passive",{get:function(){hv=!0}}),window.addEventListener("test",bh,bh),window.removeEventListener("test",bh,bh)}catch{hv=!1}function l9(r,e,t,n,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(h){this.onError(h)}}var t0=!1,im=null,am=!1,dv=null,u9={onError:function(r){t0=!0,im=r}};function c9(r,e,t,n,s,i,a,o,l){t0=!1,im=null,l9.apply(u9,arguments)}function h9(r,e,t,n,s,i,a,o,l){if(c9.apply(this,arguments),t0){if(t0){var c=im;t0=!1,im=null}else throw Error(H(198));am||(am=!0,dv=c)}}function ou(r){var e=r,t=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,e.flags&4098&&(t=e.return),r=e.return;while(r)}return e.tag===3?t:null}function U6(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function x3(r){if(ou(r)!==r)throw Error(H(188))}function d9(r){var e=r.alternate;if(!e){if(e=ou(r),e===null)throw Error(H(188));return e!==r?null:r}for(var t=r,n=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){t=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return x3(s),r;if(i===n)return x3(s),e;i=i.sibling}throw Error(H(188))}if(t.return!==n.return)t=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===t){a=!0,t=s,n=i;break}if(o===n){a=!0,n=s,t=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===t){a=!0,t=i,n=s;break}if(o===n){a=!0,n=i,t=s;break}o=o.sibling}if(!a)throw Error(H(189))}}if(t.alternate!==n)throw Error(H(190))}if(t.tag!==3)throw Error(H(188));return t.stateNode.current===t?r:e}function H6(r){return r=d9(r),r!==null?q6(r):null}function q6(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=q6(r);if(e!==null)return e;r=r.sibling}return null}var V6=Cn.unstable_scheduleCallback,A3=Cn.unstable_cancelCallback,f9=Cn.unstable_shouldYield,p9=Cn.unstable_requestPaint,Et=Cn.unstable_now,m9=Cn.unstable_getCurrentPriorityLevel,Dy=Cn.unstable_ImmediatePriority,G6=Cn.unstable_UserBlockingPriority,om=Cn.unstable_NormalPriority,g9=Cn.unstable_LowPriority,W6=Cn.unstable_IdlePriority,d1=null,ri=null;function v9(r){if(ri&&typeof ri.onCommitFiberRoot=="function")try{ri.onCommitFiberRoot(d1,r,void 0,(r.current.flags&128)===128)}catch{}}var xs=Math.clz32?Math.clz32:b9,y9=Math.log,w9=Math.LN2;function b9(r){return r>>>=0,r===0?32:31-(y9(r)/w9|0)|0}var If=64,Of=4194304;function Nh(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function lm(r,e){var t=r.pendingLanes;if(t===0)return 0;var n=0,s=r.suspendedLanes,i=r.pingedLanes,a=t&268435455;if(a!==0){var o=a&~s;o!==0?n=Nh(o):(i&=a,i!==0&&(n=Nh(i)))}else a=t&~s,a!==0?n=Nh(a):i!==0&&(n=Nh(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=t&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=n;0<e;)t=31-xs(e),s=1<<t,n|=r[t],e&=~s;return n}function S9(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _9(r,e){for(var t=r.suspendedLanes,n=r.pingedLanes,s=r.expirationTimes,i=r.pendingLanes;0<i;){var a=31-xs(i),o=1<<a,l=s[a];l===-1?(!(o&t)||o&n)&&(s[a]=S9(o,e)):l<=e&&(r.expiredLanes|=o),i&=~o}}function fv(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function K6(){var r=If;return If<<=1,!(If&4194240)&&(If=64),r}function Q1(r){for(var e=[],t=0;31>t;t++)e.push(r);return e}function mf(r,e,t){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-xs(e),r[e]=t}function x9(r,e){var t=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var n=r.eventTimes;for(r=r.expirationTimes;0<t;){var s=31-xs(t),i=1<<s;e[s]=0,n[s]=-1,r[s]=-1,t&=~i}}function Fy(r,e){var t=r.entangledLanes|=e;for(r=r.entanglements;t;){var n=31-xs(t),s=1<<n;s&e|r[n]&e&&(r[n]|=e),t&=~s}}var qe=0;function X6(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Y6,zy,Q6,J6,Z6,pv=!1,Nf=[],eo=null,to=null,ro=null,y0=new Map,w0=new Map,va=[],A9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E3(r,e){switch(r){case"focusin":case"focusout":eo=null;break;case"dragenter":case"dragleave":to=null;break;case"mouseover":case"mouseout":ro=null;break;case"pointerover":case"pointerout":y0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":w0.delete(e.pointerId)}}function Sh(r,e,t,n,s,i){return r===null||r.nativeEvent!==i?(r={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=vf(e),e!==null&&zy(e)),r):(r.eventSystemFlags|=n,e=r.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),r)}function E9(r,e,t,n,s){switch(e){case"focusin":return eo=Sh(eo,r,e,t,n,s),!0;case"dragenter":return to=Sh(to,r,e,t,n,s),!0;case"mouseover":return ro=Sh(ro,r,e,t,n,s),!0;case"pointerover":var i=s.pointerId;return y0.set(i,Sh(y0.get(i)||null,r,e,t,n,s)),!0;case"gotpointercapture":return i=s.pointerId,w0.set(i,Sh(w0.get(i)||null,r,e,t,n,s)),!0}return!1}function eb(r){var e=jo(r.target);if(e!==null){var t=ou(e);if(t!==null){if(e=t.tag,e===13){if(e=U6(t),e!==null){r.blockedOn=e,Z6(r.priority,function(){Q6(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){r.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}r.blockedOn=null}function mp(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var t=mv(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(t===null){t=r.nativeEvent;var n=new t.constructor(t.type,t);uv=n,t.target.dispatchEvent(n),uv=null}else return e=vf(t),e!==null&&zy(e),r.blockedOn=t,!1;e.shift()}return!0}function k3(r,e,t){mp(r)&&t.delete(e)}function k9(){pv=!1,eo!==null&&mp(eo)&&(eo=null),to!==null&&mp(to)&&(to=null),ro!==null&&mp(ro)&&(ro=null),y0.forEach(k3),w0.forEach(k3)}function _h(r,e){r.blockedOn===e&&(r.blockedOn=null,pv||(pv=!0,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,k9)))}function b0(r){function e(s){return _h(s,r)}if(0<Nf.length){_h(Nf[0],r);for(var t=1;t<Nf.length;t++){var n=Nf[t];n.blockedOn===r&&(n.blockedOn=null)}}for(eo!==null&&_h(eo,r),to!==null&&_h(to,r),ro!==null&&_h(ro,r),y0.forEach(e),w0.forEach(e),t=0;t<va.length;t++)n=va[t],n.blockedOn===r&&(n.blockedOn=null);for(;0<va.length&&(t=va[0],t.blockedOn===null);)eb(t),t.blockedOn===null&&va.shift()}var qu=oa.ReactCurrentBatchConfig,um=!0;function T9(r,e,t,n){var s=qe,i=qu.transition;qu.transition=null;try{qe=1,By(r,e,t,n)}finally{qe=s,qu.transition=i}}function C9(r,e,t,n){var s=qe,i=qu.transition;qu.transition=null;try{qe=4,By(r,e,t,n)}finally{qe=s,qu.transition=i}}function By(r,e,t,n){if(um){var s=mv(r,e,t,n);if(s===null)og(r,e,n,cm,t),E3(r,n);else if(E9(s,r,e,t,n))n.stopPropagation();else if(E3(r,n),e&4&&-1<A9.indexOf(r)){for(;s!==null;){var i=vf(s);if(i!==null&&Y6(i),i=mv(r,e,t,n),i===null&&og(r,e,n,cm,t),i===s)break;s=i}s!==null&&n.stopPropagation()}else og(r,e,n,null,t)}}var cm=null;function mv(r,e,t,n){if(cm=null,r=Ly(n),r=jo(r),r!==null)if(e=ou(r),e===null)r=null;else if(t=e.tag,t===13){if(r=U6(e),r!==null)return r;r=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return cm=r,null}function tb(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(m9()){case Dy:return 1;case G6:return 4;case om:case g9:return 16;case W6:return 536870912;default:return 16}default:return 16}}var Qa=null,jy=null,gp=null;function rb(){if(gp)return gp;var r,e=jy,t=e.length,n,s="value"in Qa?Qa.value:Qa.textContent,i=s.length;for(r=0;r<t&&e[r]===s[r];r++);var a=t-r;for(n=1;n<=a&&e[t-n]===s[i-n];n++);return gp=s.slice(r,1<n?1-n:void 0)}function vp(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function Lf(){return!0}function T3(){return!1}function Pn(r){function e(t,n,s,i,a){this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in r)r.hasOwnProperty(o)&&(t=r[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Lf:T3,this.isPropagationStopped=T3,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Lf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Lf)},persist:function(){},isPersistent:Lf}),e}var dh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$y=Pn(dh),gf=yt({},dh,{view:0,detail:0}),R9=Pn(gf),J1,Z1,xh,f1=yt({},gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uy,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==xh&&(xh&&r.type==="mousemove"?(J1=r.screenX-xh.screenX,Z1=r.screenY-xh.screenY):Z1=J1=0,xh=r),J1)},movementY:function(r){return"movementY"in r?r.movementY:Z1}}),C3=Pn(f1),P9=yt({},f1,{dataTransfer:0}),M9=Pn(P9),I9=yt({},gf,{relatedTarget:0}),eg=Pn(I9),O9=yt({},dh,{animationName:0,elapsedTime:0,pseudoElement:0}),N9=Pn(O9),L9=yt({},dh,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),D9=Pn(L9),F9=yt({},dh,{data:0}),R3=Pn(F9),z9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $9(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=j9[r])?!!e[r]:!1}function Uy(){return $9}var U9=yt({},gf,{key:function(r){if(r.key){var e=z9[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=vp(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?B9[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uy,charCode:function(r){return r.type==="keypress"?vp(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?vp(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),H9=Pn(U9),q9=yt({},f1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P3=Pn(q9),V9=yt({},gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uy}),G9=Pn(V9),W9=yt({},dh,{propertyName:0,elapsedTime:0,pseudoElement:0}),K9=Pn(W9),X9=yt({},f1,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Y9=Pn(X9),Q9=[9,13,27,32],Hy=Ji&&"CompositionEvent"in window,r0=null;Ji&&"documentMode"in document&&(r0=document.documentMode);var J9=Ji&&"TextEvent"in window&&!r0,nb=Ji&&(!Hy||r0&&8<r0&&11>=r0),M3=" ",I3=!1;function sb(r,e){switch(r){case"keyup":return Q9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ib(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ru=!1;function Z9(r,e){switch(r){case"compositionend":return ib(e);case"keypress":return e.which!==32?null:(I3=!0,M3);case"textInput":return r=e.data,r===M3&&I3?null:r;default:return null}}function eA(r,e){if(Ru)return r==="compositionend"||!Hy&&sb(r,e)?(r=rb(),gp=jy=Qa=null,Ru=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nb&&e.locale!=="ko"?null:e.data;default:return null}}var tA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O3(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!tA[r.type]:e==="textarea"}function ab(r,e,t,n){F6(n),e=hm(e,"onChange"),0<e.length&&(t=new $y("onChange","change",null,t,n),r.push({event:t,listeners:e}))}var n0=null,S0=null;function rA(r){vb(r,0)}function p1(r){var e=Iu(r);if(P6(e))return r}function nA(r,e){if(r==="change")return e}var ob=!1;if(Ji){var tg;if(Ji){var rg="oninput"in document;if(!rg){var N3=document.createElement("div");N3.setAttribute("oninput","return;"),rg=typeof N3.oninput=="function"}tg=rg}else tg=!1;ob=tg&&(!document.documentMode||9<document.documentMode)}function L3(){n0&&(n0.detachEvent("onpropertychange",lb),S0=n0=null)}function lb(r){if(r.propertyName==="value"&&p1(S0)){var e=[];ab(e,S0,r,Ly(r)),$6(rA,e)}}function sA(r,e,t){r==="focusin"?(L3(),n0=e,S0=t,n0.attachEvent("onpropertychange",lb)):r==="focusout"&&L3()}function iA(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return p1(S0)}function aA(r,e){if(r==="click")return p1(e)}function oA(r,e){if(r==="input"||r==="change")return p1(e)}function lA(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Es=typeof Object.is=="function"?Object.is:lA;function _0(r,e){if(Es(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var s=t[n];if(!Qg.call(e,s)||!Es(r[s],e[s]))return!1}return!0}function D3(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function F3(r,e){var t=D3(r);r=0;for(var n;t;){if(t.nodeType===3){if(n=r+t.textContent.length,r<=e&&n>=e)return{node:t,offset:e-r};r=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=D3(t)}}function ub(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?ub(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function cb(){for(var r=window,e=sm();e instanceof r.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)r=e.contentWindow;else break;e=sm(r.document)}return e}function qy(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function uA(r){var e=cb(),t=r.focusedElem,n=r.selectionRange;if(e!==t&&t&&t.ownerDocument&&ub(t.ownerDocument.documentElement,t)){if(n!==null&&qy(t)){if(e=n.start,r=n.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var s=t.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!r.extend&&i>n&&(s=n,n=i,i=s),s=F3(t,i);var a=F3(t,n);s&&a&&(r.rangeCount!==1||r.anchorNode!==s.node||r.anchorOffset!==s.offset||r.focusNode!==a.node||r.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),r.removeAllRanges(),i>n?(r.addRange(e),r.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var cA=Ji&&"documentMode"in document&&11>=document.documentMode,Pu=null,gv=null,s0=null,vv=!1;function z3(r,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;vv||Pu==null||Pu!==sm(n)||(n=Pu,"selectionStart"in n&&qy(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),s0&&_0(s0,n)||(s0=n,n=hm(gv,"onSelect"),0<n.length&&(e=new $y("onSelect","select",null,e,t),r.push({event:e,listeners:n}),e.target=Pu)))}function Df(r,e){var t={};return t[r.toLowerCase()]=e.toLowerCase(),t["Webkit"+r]="webkit"+e,t["Moz"+r]="moz"+e,t}var Mu={animationend:Df("Animation","AnimationEnd"),animationiteration:Df("Animation","AnimationIteration"),animationstart:Df("Animation","AnimationStart"),transitionend:Df("Transition","TransitionEnd")},ng={},hb={};Ji&&(hb=document.createElement("div").style,"AnimationEvent"in window||(delete Mu.animationend.animation,delete Mu.animationiteration.animation,delete Mu.animationstart.animation),"TransitionEvent"in window||delete Mu.transitionend.transition);function m1(r){if(ng[r])return ng[r];if(!Mu[r])return r;var e=Mu[r],t;for(t in e)if(e.hasOwnProperty(t)&&t in hb)return ng[r]=e[t];return r}var db=m1("animationend"),fb=m1("animationiteration"),pb=m1("animationstart"),mb=m1("transitionend"),gb=new Map,B3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wo(r,e){gb.set(r,e),au(e,[r])}for(var sg=0;sg<B3.length;sg++){var ig=B3[sg],hA=ig.toLowerCase(),dA=ig[0].toUpperCase()+ig.slice(1);wo(hA,"on"+dA)}wo(db,"onAnimationEnd");wo(fb,"onAnimationIteration");wo(pb,"onAnimationStart");wo("dblclick","onDoubleClick");wo("focusin","onFocus");wo("focusout","onBlur");wo(mb,"onTransitionEnd");rh("onMouseEnter",["mouseout","mouseover"]);rh("onMouseLeave",["mouseout","mouseover"]);rh("onPointerEnter",["pointerout","pointerover"]);rh("onPointerLeave",["pointerout","pointerover"]);au("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));au("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));au("onBeforeInput",["compositionend","keypress","textInput","paste"]);au("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));au("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));au("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lh));function j3(r,e,t){var n=r.type||"unknown-event";r.currentTarget=t,h9(n,e,void 0,r),r.currentTarget=null}function vb(r,e){e=(e&4)!==0;for(var t=0;t<r.length;t++){var n=r[t],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;j3(s,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;j3(s,o,c),i=l}}}if(am)throw r=dv,am=!1,dv=null,r}function tt(r,e){var t=e[_v];t===void 0&&(t=e[_v]=new Set);var n=r+"__bubble";t.has(n)||(yb(e,r,2,!1),t.add(n))}function ag(r,e,t){var n=0;e&&(n|=4),yb(t,r,n,e)}var Ff="_reactListening"+Math.random().toString(36).slice(2);function x0(r){if(!r[Ff]){r[Ff]=!0,E6.forEach(function(t){t!=="selectionchange"&&(fA.has(t)||ag(t,!1,r),ag(t,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[Ff]||(e[Ff]=!0,ag("selectionchange",!1,e))}}function yb(r,e,t,n){switch(tb(e)){case 1:var s=T9;break;case 4:s=C9;break;default:s=By}t=s.bind(null,e,t,r),s=void 0,!hv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?r.addEventListener(e,t,{capture:!0,passive:s}):r.addEventListener(e,t,!0):s!==void 0?r.addEventListener(e,t,{passive:s}):r.addEventListener(e,t,!1)}function og(r,e,t,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=jo(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}$6(function(){var c=i,h=Ly(t),d=[];e:{var f=gb.get(r);if(f!==void 0){var p=$y,g=r;switch(r){case"keypress":if(vp(t)===0)break e;case"keydown":case"keyup":p=H9;break;case"focusin":g="focus",p=eg;break;case"focusout":g="blur",p=eg;break;case"beforeblur":case"afterblur":p=eg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=C3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=M9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=G9;break;case db:case fb:case pb:p=N9;break;case mb:p=K9;break;case"scroll":p=R9;break;case"wheel":p=Y9;break;case"copy":case"cut":case"paste":p=D9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=P3}var w=(e&4)!==0,x=!w&&r==="scroll",y=w?f!==null?f+"Capture":null:f;w=[];for(var b=c,_;b!==null;){_=b;var C=_.stateNode;if(_.tag===5&&C!==null&&(_=C,y!==null&&(C=v0(b,y),C!=null&&w.push(A0(b,C,_)))),x)break;b=b.return}0<w.length&&(f=new p(f,g,null,t,h),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=r==="mouseover"||r==="pointerover",p=r==="mouseout"||r==="pointerout",f&&t!==uv&&(g=t.relatedTarget||t.fromElement)&&(jo(g)||g[Zi]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=t.relatedTarget||t.toElement,p=c,g=g?jo(g):null,g!==null&&(x=ou(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(w=C3,C="onMouseLeave",y="onMouseEnter",b="mouse",(r==="pointerout"||r==="pointerover")&&(w=P3,C="onPointerLeave",y="onPointerEnter",b="pointer"),x=p==null?f:Iu(p),_=g==null?f:Iu(g),f=new w(C,b+"leave",p,t,h),f.target=x,f.relatedTarget=_,C=null,jo(h)===c&&(w=new w(y,b+"enter",g,t,h),w.target=_,w.relatedTarget=x,C=w),x=C,p&&g)t:{for(w=p,y=g,b=0,_=w;_;_=cu(_))b++;for(_=0,C=y;C;C=cu(C))_++;for(;0<b-_;)w=cu(w),b--;for(;0<_-b;)y=cu(y),_--;for(;b--;){if(w===y||y!==null&&w===y.alternate)break t;w=cu(w),y=cu(y)}w=null}else w=null;p!==null&&$3(d,f,p,w,!1),g!==null&&x!==null&&$3(d,x,g,w,!0)}}e:{if(f=c?Iu(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var R=nA;else if(O3(f))if(ob)R=oA;else{R=iA;var I=sA}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(R=aA);if(R&&(R=R(r,c))){ab(d,R,t,h);break e}I&&I(r,f,c),r==="focusout"&&(I=f._wrapperState)&&I.controlled&&f.type==="number"&&sv(f,"number",f.value)}switch(I=c?Iu(c):window,r){case"focusin":(O3(I)||I.contentEditable==="true")&&(Pu=I,gv=c,s0=null);break;case"focusout":s0=gv=Pu=null;break;case"mousedown":vv=!0;break;case"contextmenu":case"mouseup":case"dragend":vv=!1,z3(d,t,h);break;case"selectionchange":if(cA)break;case"keydown":case"keyup":z3(d,t,h)}var O;if(Hy)e:{switch(r){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Ru?sb(r,t)&&(D="onCompositionEnd"):r==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(nb&&t.locale!=="ko"&&(Ru||D!=="onCompositionStart"?D==="onCompositionEnd"&&Ru&&(O=rb()):(Qa=h,jy="value"in Qa?Qa.value:Qa.textContent,Ru=!0)),I=hm(c,D),0<I.length&&(D=new R3(D,r,null,t,h),d.push({event:D,listeners:I}),O?D.data=O:(O=ib(t),O!==null&&(D.data=O)))),(O=J9?Z9(r,t):eA(r,t))&&(c=hm(c,"onBeforeInput"),0<c.length&&(h=new R3("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:c}),h.data=O))}vb(d,e)})}function A0(r,e,t){return{instance:r,listener:e,currentTarget:t}}function hm(r,e){for(var t=e+"Capture",n=[];r!==null;){var s=r,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=v0(r,t),i!=null&&n.unshift(A0(r,i,s)),i=v0(r,e),i!=null&&n.push(A0(r,i,s))),r=r.return}return n}function cu(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function $3(r,e,t,n,s){for(var i=e._reactName,a=[];t!==null&&t!==n;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=v0(t,i),l!=null&&a.unshift(A0(t,l,o))):s||(l=v0(t,i),l!=null&&a.push(A0(t,l,o)))),t=t.return}a.length!==0&&r.push({event:e,listeners:a})}var pA=/\r\n?/g,mA=/\u0000|\uFFFD/g;function U3(r){return(typeof r=="string"?r:""+r).replace(pA,`
`).replace(mA,"")}function zf(r,e,t){if(e=U3(e),U3(r)!==e&&t)throw Error(H(425))}function dm(){}var yv=null,wv=null;function bv(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sv=typeof setTimeout=="function"?setTimeout:void 0,gA=typeof clearTimeout=="function"?clearTimeout:void 0,H3=typeof Promise=="function"?Promise:void 0,vA=typeof queueMicrotask=="function"?queueMicrotask:typeof H3<"u"?function(r){return H3.resolve(null).then(r).catch(yA)}:Sv;function yA(r){setTimeout(function(){throw r})}function lg(r,e){var t=e,n=0;do{var s=t.nextSibling;if(r.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(n===0){r.removeChild(s),b0(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=s}while(t);b0(e)}function no(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function q3(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return r;e--}else t==="/$"&&e++}r=r.previousSibling}return null}var fh=Math.random().toString(36).slice(2),Zs="__reactFiber$"+fh,E0="__reactProps$"+fh,Zi="__reactContainer$"+fh,_v="__reactEvents$"+fh,wA="__reactListeners$"+fh,bA="__reactHandles$"+fh;function jo(r){var e=r[Zs];if(e)return e;for(var t=r.parentNode;t;){if(e=t[Zi]||t[Zs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(r=q3(r);r!==null;){if(t=r[Zs])return t;r=q3(r)}return e}r=t,t=r.parentNode}return null}function vf(r){return r=r[Zs]||r[Zi],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Iu(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(H(33))}function g1(r){return r[E0]||null}var xv=[],Ou=-1;function bo(r){return{current:r}}function st(r){0>Ou||(r.current=xv[Ou],xv[Ou]=null,Ou--)}function Ze(r,e){Ou++,xv[Ou]=r.current,r.current=e}var ho={},_r=bo(ho),Zr=bo(!1),Yl=ho;function nh(r,e){var t=r.type.contextTypes;if(!t)return ho;var n=r.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=s),s}function en(r){return r=r.childContextTypes,r!=null}function fm(){st(Zr),st(_r)}function V3(r,e,t){if(_r.current!==ho)throw Error(H(168));Ze(_r,e),Ze(Zr,t)}function wb(r,e,t){var n=r.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(H(108,s9(r)||"Unknown",s));return yt({},t,n)}function pm(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||ho,Yl=_r.current,Ze(_r,r),Ze(Zr,Zr.current),!0}function G3(r,e,t){var n=r.stateNode;if(!n)throw Error(H(169));t?(r=wb(r,e,Yl),n.__reactInternalMemoizedMergedChildContext=r,st(Zr),st(_r),Ze(_r,r)):st(Zr),Ze(Zr,t)}var vi=null,v1=!1,ug=!1;function bb(r){vi===null?vi=[r]:vi.push(r)}function SA(r){v1=!0,bb(r)}function So(){if(!ug&&vi!==null){ug=!0;var r=0,e=qe;try{var t=vi;for(qe=1;r<t.length;r++){var n=t[r];do n=n(!0);while(n!==null)}vi=null,v1=!1}catch(s){throw vi!==null&&(vi=vi.slice(r+1)),V6(Dy,So),s}finally{qe=e,ug=!1}}return null}var Nu=[],Lu=0,mm=null,gm=0,$n=[],Un=0,Ql=null,Vi=1,Gi="";function Ro(r,e){Nu[Lu++]=gm,Nu[Lu++]=mm,mm=r,gm=e}function Sb(r,e,t){$n[Un++]=Vi,$n[Un++]=Gi,$n[Un++]=Ql,Ql=r;var n=Vi;r=Gi;var s=32-xs(n)-1;n&=~(1<<s),t+=1;var i=32-xs(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Vi=1<<32-xs(e)+s|t<<s|n,Gi=i+r}else Vi=1<<i|t<<s|n,Gi=r}function Vy(r){r.return!==null&&(Ro(r,1),Sb(r,1,0))}function Gy(r){for(;r===mm;)mm=Nu[--Lu],Nu[Lu]=null,gm=Nu[--Lu],Nu[Lu]=null;for(;r===Ql;)Ql=$n[--Un],$n[Un]=null,Gi=$n[--Un],$n[Un]=null,Vi=$n[--Un],$n[Un]=null}var En=null,An=null,lt=!1,Ss=null;function _b(r,e){var t=Vn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=r,e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)}function W3(r,e){switch(r.tag){case 5:var t=r.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,En=r,An=no(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,En=r,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ql!==null?{id:Vi,overflow:Gi}:null,r.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Vn(18,null,null,0),t.stateNode=e,t.return=r,r.child=t,En=r,An=null,!0):!1;default:return!1}}function Av(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Ev(r){if(lt){var e=An;if(e){var t=e;if(!W3(r,e)){if(Av(r))throw Error(H(418));e=no(t.nextSibling);var n=En;e&&W3(r,e)?_b(n,t):(r.flags=r.flags&-4097|2,lt=!1,En=r)}}else{if(Av(r))throw Error(H(418));r.flags=r.flags&-4097|2,lt=!1,En=r}}}function K3(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;En=r}function Bf(r){if(r!==En)return!1;if(!lt)return K3(r),lt=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!bv(r.type,r.memoizedProps)),e&&(e=An)){if(Av(r))throw xb(),Error(H(418));for(;e;)_b(r,e),e=no(e.nextSibling)}if(K3(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(H(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="/$"){if(e===0){An=no(r.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}r=r.nextSibling}An=null}}else An=En?no(r.stateNode.nextSibling):null;return!0}function xb(){for(var r=An;r;)r=no(r.nextSibling)}function sh(){An=En=null,lt=!1}function Wy(r){Ss===null?Ss=[r]:Ss.push(r)}var _A=oa.ReactCurrentBatchConfig;function Ah(r,e,t){if(r=t.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(H(309));var n=t.stateNode}if(!n)throw Error(H(147,r));var s=n,i=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof r!="string")throw Error(H(284));if(!t._owner)throw Error(H(290,r))}return r}function jf(r,e){throw r=Object.prototype.toString.call(e),Error(H(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function X3(r){var e=r._init;return e(r._payload)}function Ab(r){function e(y,b){if(r){var _=y.deletions;_===null?(y.deletions=[b],y.flags|=16):_.push(b)}}function t(y,b){if(!r)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function n(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function s(y,b){return y=oo(y,b),y.index=0,y.sibling=null,y}function i(y,b,_){return y.index=_,r?(_=y.alternate,_!==null?(_=_.index,_<b?(y.flags|=2,b):_):(y.flags|=2,b)):(y.flags|=1048576,b)}function a(y){return r&&y.alternate===null&&(y.flags|=2),y}function o(y,b,_,C){return b===null||b.tag!==6?(b=gg(_,y.mode,C),b.return=y,b):(b=s(b,_),b.return=y,b)}function l(y,b,_,C){var R=_.type;return R===Cu?h(y,b,_.props.children,C,_.key):b!==null&&(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===pa&&X3(R)===b.type)?(C=s(b,_.props),C.ref=Ah(y,b,_),C.return=y,C):(C=Ap(_.type,_.key,_.props,null,y.mode,C),C.ref=Ah(y,b,_),C.return=y,C)}function c(y,b,_,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=vg(_,y.mode,C),b.return=y,b):(b=s(b,_.children||[]),b.return=y,b)}function h(y,b,_,C,R){return b===null||b.tag!==7?(b=Xl(_,y.mode,C,R),b.return=y,b):(b=s(b,_),b.return=y,b)}function d(y,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=gg(""+b,y.mode,_),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rf:return _=Ap(b.type,b.key,b.props,null,y.mode,_),_.ref=Ah(y,null,b),_.return=y,_;case Tu:return b=vg(b,y.mode,_),b.return=y,b;case pa:var C=b._init;return d(y,C(b._payload),_)}if(Oh(b)||wh(b))return b=Xl(b,y.mode,_,null),b.return=y,b;jf(y,b)}return null}function f(y,b,_,C){var R=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return R!==null?null:o(y,b,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Rf:return _.key===R?l(y,b,_,C):null;case Tu:return _.key===R?c(y,b,_,C):null;case pa:return R=_._init,f(y,b,R(_._payload),C)}if(Oh(_)||wh(_))return R!==null?null:h(y,b,_,C,null);jf(y,_)}return null}function p(y,b,_,C,R){if(typeof C=="string"&&C!==""||typeof C=="number")return y=y.get(_)||null,o(b,y,""+C,R);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Rf:return y=y.get(C.key===null?_:C.key)||null,l(b,y,C,R);case Tu:return y=y.get(C.key===null?_:C.key)||null,c(b,y,C,R);case pa:var I=C._init;return p(y,b,_,I(C._payload),R)}if(Oh(C)||wh(C))return y=y.get(_)||null,h(b,y,C,R,null);jf(b,C)}return null}function g(y,b,_,C){for(var R=null,I=null,O=b,D=b=0,B=null;O!==null&&D<_.length;D++){O.index>D?(B=O,O=null):B=O.sibling;var q=f(y,O,_[D],C);if(q===null){O===null&&(O=B);break}r&&O&&q.alternate===null&&e(y,O),b=i(q,b,D),I===null?R=q:I.sibling=q,I=q,O=B}if(D===_.length)return t(y,O),lt&&Ro(y,D),R;if(O===null){for(;D<_.length;D++)O=d(y,_[D],C),O!==null&&(b=i(O,b,D),I===null?R=O:I.sibling=O,I=O);return lt&&Ro(y,D),R}for(O=n(y,O);D<_.length;D++)B=p(O,y,D,_[D],C),B!==null&&(r&&B.alternate!==null&&O.delete(B.key===null?D:B.key),b=i(B,b,D),I===null?R=B:I.sibling=B,I=B);return r&&O.forEach(function(K){return e(y,K)}),lt&&Ro(y,D),R}function w(y,b,_,C){var R=wh(_);if(typeof R!="function")throw Error(H(150));if(_=R.call(_),_==null)throw Error(H(151));for(var I=R=null,O=b,D=b=0,B=null,q=_.next();O!==null&&!q.done;D++,q=_.next()){O.index>D?(B=O,O=null):B=O.sibling;var K=f(y,O,q.value,C);if(K===null){O===null&&(O=B);break}r&&O&&K.alternate===null&&e(y,O),b=i(K,b,D),I===null?R=K:I.sibling=K,I=K,O=B}if(q.done)return t(y,O),lt&&Ro(y,D),R;if(O===null){for(;!q.done;D++,q=_.next())q=d(y,q.value,C),q!==null&&(b=i(q,b,D),I===null?R=q:I.sibling=q,I=q);return lt&&Ro(y,D),R}for(O=n(y,O);!q.done;D++,q=_.next())q=p(O,y,D,q.value,C),q!==null&&(r&&q.alternate!==null&&O.delete(q.key===null?D:q.key),b=i(q,b,D),I===null?R=q:I.sibling=q,I=q);return r&&O.forEach(function(de){return e(y,de)}),lt&&Ro(y,D),R}function x(y,b,_,C){if(typeof _=="object"&&_!==null&&_.type===Cu&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Rf:e:{for(var R=_.key,I=b;I!==null;){if(I.key===R){if(R=_.type,R===Cu){if(I.tag===7){t(y,I.sibling),b=s(I,_.props.children),b.return=y,y=b;break e}}else if(I.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===pa&&X3(R)===I.type){t(y,I.sibling),b=s(I,_.props),b.ref=Ah(y,I,_),b.return=y,y=b;break e}t(y,I);break}else e(y,I);I=I.sibling}_.type===Cu?(b=Xl(_.props.children,y.mode,C,_.key),b.return=y,y=b):(C=Ap(_.type,_.key,_.props,null,y.mode,C),C.ref=Ah(y,b,_),C.return=y,y=C)}return a(y);case Tu:e:{for(I=_.key;b!==null;){if(b.key===I)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){t(y,b.sibling),b=s(b,_.children||[]),b.return=y,y=b;break e}else{t(y,b);break}else e(y,b);b=b.sibling}b=vg(_,y.mode,C),b.return=y,y=b}return a(y);case pa:return I=_._init,x(y,b,I(_._payload),C)}if(Oh(_))return g(y,b,_,C);if(wh(_))return w(y,b,_,C);jf(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(t(y,b.sibling),b=s(b,_),b.return=y,y=b):(t(y,b),b=gg(_,y.mode,C),b.return=y,y=b),a(y)):t(y,b)}return x}var ih=Ab(!0),Eb=Ab(!1),vm=bo(null),ym=null,Du=null,Ky=null;function Xy(){Ky=Du=ym=null}function Yy(r){var e=vm.current;st(vm),r._currentValue=e}function kv(r,e,t){for(;r!==null;){var n=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),r===t)break;r=r.return}}function Vu(r,e){ym=r,Ky=Du=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&e&&(Jr=!0),r.firstContext=null)}function Xn(r){var e=r._currentValue;if(Ky!==r)if(r={context:r,memoizedValue:e,next:null},Du===null){if(ym===null)throw Error(H(308));Du=r,ym.dependencies={lanes:0,firstContext:r}}else Du=Du.next=r;return e}var $o=null;function Qy(r){$o===null?$o=[r]:$o.push(r)}function kb(r,e,t,n){var s=e.interleaved;return s===null?(t.next=t,Qy(e)):(t.next=s.next,s.next=t),e.interleaved=t,ea(r,n)}function ea(r,e){r.lanes|=e;var t=r.alternate;for(t!==null&&(t.lanes|=e),t=r,r=r.return;r!==null;)r.childLanes|=e,t=r.alternate,t!==null&&(t.childLanes|=e),t=r,r=r.return;return t.tag===3?t.stateNode:null}var ma=!1;function Jy(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tb(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Wi(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function so(r,e,t){var n=r.updateQueue;if(n===null)return null;if(n=n.shared,Oe&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,ea(r,t)}return s=n.interleaved,s===null?(e.next=e,Qy(n)):(e.next=s.next,s.next=e),n.interleaved=e,ea(r,t)}function yp(r,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,Fy(r,t)}}function Y3(r,e){var t=r.updateQueue,n=r.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=a:i=i.next=a,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},r.updateQueue=t;return}r=t.lastBaseUpdate,r===null?t.firstBaseUpdate=e:r.next=e,t.lastBaseUpdate=e}function wm(r,e,t,n){var s=r.updateQueue;ma=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var h=r.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;a=0,h=c=l=null,o=i;do{var f=o.lane,p=o.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=r,w=o;switch(f=e,p=t,w.tag){case 1:if(g=w.payload,typeof g=="function"){d=g.call(p,d,f);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=w.payload,f=typeof g=="function"?g.call(p,d,f):g,f==null)break e;d=yt({},d,f);break e;case 2:ma=!0}}o.callback!==null&&o.lane!==0&&(r.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(c=h=p,l=d):h=h.next=p,a|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Zl|=a,r.lanes=a,r.memoizedState=d}}function Q3(r,e,t){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var n=r[e],s=n.callback;if(s!==null){if(n.callback=null,n=t,typeof s!="function")throw Error(H(191,s));s.call(n)}}}var yf={},ni=bo(yf),k0=bo(yf),T0=bo(yf);function Uo(r){if(r===yf)throw Error(H(174));return r}function Zy(r,e){switch(Ze(T0,e),Ze(k0,r),Ze(ni,yf),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:av(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=av(e,r)}st(ni),Ze(ni,e)}function ah(){st(ni),st(k0),st(T0)}function Cb(r){Uo(T0.current);var e=Uo(ni.current),t=av(e,r.type);e!==t&&(Ze(k0,r),Ze(ni,t))}function e2(r){k0.current===r&&(st(ni),st(k0))}var pt=bo(0);function bm(r){for(var e=r;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cg=[];function t2(){for(var r=0;r<cg.length;r++)cg[r]._workInProgressVersionPrimary=null;cg.length=0}var wp=oa.ReactCurrentDispatcher,hg=oa.ReactCurrentBatchConfig,Jl=0,vt=null,jt=null,Qt=null,Sm=!1,i0=!1,C0=0,xA=0;function ur(){throw Error(H(321))}function r2(r,e){if(e===null)return!1;for(var t=0;t<e.length&&t<r.length;t++)if(!Es(r[t],e[t]))return!1;return!0}function n2(r,e,t,n,s,i){if(Jl=i,vt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wp.current=r===null||r.memoizedState===null?TA:CA,r=t(n,s),i0){i=0;do{if(i0=!1,C0=0,25<=i)throw Error(H(301));i+=1,Qt=jt=null,e.updateQueue=null,wp.current=RA,r=t(n,s)}while(i0)}if(wp.current=_m,e=jt!==null&&jt.next!==null,Jl=0,Qt=jt=vt=null,Sm=!1,e)throw Error(H(300));return r}function s2(){var r=C0!==0;return C0=0,r}function Ns(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qt===null?vt.memoizedState=Qt=r:Qt=Qt.next=r,Qt}function Yn(){if(jt===null){var r=vt.alternate;r=r!==null?r.memoizedState:null}else r=jt.next;var e=Qt===null?vt.memoizedState:Qt.next;if(e!==null)Qt=e,jt=r;else{if(r===null)throw Error(H(310));jt=r,r={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Qt===null?vt.memoizedState=Qt=r:Qt=Qt.next=r}return Qt}function R0(r,e){return typeof e=="function"?e(r):e}function dg(r){var e=Yn(),t=e.queue;if(t===null)throw Error(H(311));t.lastRenderedReducer=r;var n=jt,s=n.baseQueue,i=t.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,c=i;do{var h=c.lane;if((Jl&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:r(n,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,vt.lanes|=h,Zl|=h}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,Es(n,e.memoizedState)||(Jr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,t.lastRenderedState=n}if(r=t.interleaved,r!==null){s=r;do i=s.lane,vt.lanes|=i,Zl|=i,s=s.next;while(s!==r)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function fg(r){var e=Yn(),t=e.queue;if(t===null)throw Error(H(311));t.lastRenderedReducer=r;var n=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var a=s=s.next;do i=r(i,a.action),a=a.next;while(a!==s);Es(i,e.memoizedState)||(Jr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,n]}function Rb(){}function Pb(r,e){var t=vt,n=Yn(),s=e(),i=!Es(n.memoizedState,s);if(i&&(n.memoizedState=s,Jr=!0),n=n.queue,i2(Ob.bind(null,t,n,r),[r]),n.getSnapshot!==e||i||Qt!==null&&Qt.memoizedState.tag&1){if(t.flags|=2048,P0(9,Ib.bind(null,t,n,s,e),void 0,null),Jt===null)throw Error(H(349));Jl&30||Mb(t,e,s)}return s}function Mb(r,e,t){r.flags|=16384,r={getSnapshot:e,value:t},e=vt.updateQueue,e===null?(e={lastEffect:null,stores:null},vt.updateQueue=e,e.stores=[r]):(t=e.stores,t===null?e.stores=[r]:t.push(r))}function Ib(r,e,t,n){e.value=t,e.getSnapshot=n,Nb(e)&&Lb(r)}function Ob(r,e,t){return t(function(){Nb(e)&&Lb(r)})}function Nb(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Es(r,t)}catch{return!0}}function Lb(r){var e=ea(r,1);e!==null&&As(e,r,1,-1)}function J3(r){var e=Ns();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:R0,lastRenderedState:r},e.queue=r,r=r.dispatch=kA.bind(null,vt,r),[e.memoizedState,r]}function P0(r,e,t,n){return r={tag:r,create:e,destroy:t,deps:n,next:null},e=vt.updateQueue,e===null?(e={lastEffect:null,stores:null},vt.updateQueue=e,e.lastEffect=r.next=r):(t=e.lastEffect,t===null?e.lastEffect=r.next=r:(n=t.next,t.next=r,r.next=n,e.lastEffect=r)),r}function Db(){return Yn().memoizedState}function bp(r,e,t,n){var s=Ns();vt.flags|=r,s.memoizedState=P0(1|e,t,void 0,n===void 0?null:n)}function y1(r,e,t,n){var s=Yn();n=n===void 0?null:n;var i=void 0;if(jt!==null){var a=jt.memoizedState;if(i=a.destroy,n!==null&&r2(n,a.deps)){s.memoizedState=P0(e,t,i,n);return}}vt.flags|=r,s.memoizedState=P0(1|e,t,i,n)}function Z3(r,e){return bp(8390656,8,r,e)}function i2(r,e){return y1(2048,8,r,e)}function Fb(r,e){return y1(4,2,r,e)}function zb(r,e){return y1(4,4,r,e)}function Bb(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function jb(r,e,t){return t=t!=null?t.concat([r]):null,y1(4,4,Bb.bind(null,e,r),t)}function a2(){}function $b(r,e){var t=Yn();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&r2(e,n[1])?n[0]:(t.memoizedState=[r,e],r)}function Ub(r,e){var t=Yn();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&r2(e,n[1])?n[0]:(r=r(),t.memoizedState=[r,e],r)}function Hb(r,e,t){return Jl&21?(Es(t,e)||(t=K6(),vt.lanes|=t,Zl|=t,r.baseState=!0),e):(r.baseState&&(r.baseState=!1,Jr=!0),r.memoizedState=t)}function AA(r,e){var t=qe;qe=t!==0&&4>t?t:4,r(!0);var n=hg.transition;hg.transition={};try{r(!1),e()}finally{qe=t,hg.transition=n}}function qb(){return Yn().memoizedState}function EA(r,e,t){var n=ao(r);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},Vb(r))Gb(e,t);else if(t=kb(r,e,t,n),t!==null){var s=Or();As(t,r,n,s),Wb(t,e,n)}}function kA(r,e,t){var n=ao(r),s={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(Vb(r))Gb(e,s);else{var i=r.alternate;if(r.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,t);if(s.hasEagerState=!0,s.eagerState=o,Es(o,a)){var l=e.interleaved;l===null?(s.next=s,Qy(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=kb(r,e,s,n),t!==null&&(s=Or(),As(t,r,n,s),Wb(t,e,n))}}function Vb(r){var e=r.alternate;return r===vt||e!==null&&e===vt}function Gb(r,e){i0=Sm=!0;var t=r.pending;t===null?e.next=e:(e.next=t.next,t.next=e),r.pending=e}function Wb(r,e,t){if(t&4194240){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,Fy(r,t)}}var _m={readContext:Xn,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useInsertionEffect:ur,useLayoutEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useMutableSource:ur,useSyncExternalStore:ur,useId:ur,unstable_isNewReconciler:!1},TA={readContext:Xn,useCallback:function(r,e){return Ns().memoizedState=[r,e===void 0?null:e],r},useContext:Xn,useEffect:Z3,useImperativeHandle:function(r,e,t){return t=t!=null?t.concat([r]):null,bp(4194308,4,Bb.bind(null,e,r),t)},useLayoutEffect:function(r,e){return bp(4194308,4,r,e)},useInsertionEffect:function(r,e){return bp(4,2,r,e)},useMemo:function(r,e){var t=Ns();return e=e===void 0?null:e,r=r(),t.memoizedState=[r,e],r},useReducer:function(r,e,t){var n=Ns();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},n.queue=r,r=r.dispatch=EA.bind(null,vt,r),[n.memoizedState,r]},useRef:function(r){var e=Ns();return r={current:r},e.memoizedState=r},useState:J3,useDebugValue:a2,useDeferredValue:function(r){return Ns().memoizedState=r},useTransition:function(){var r=J3(!1),e=r[0];return r=AA.bind(null,r[1]),Ns().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,t){var n=vt,s=Ns();if(lt){if(t===void 0)throw Error(H(407));t=t()}else{if(t=e(),Jt===null)throw Error(H(349));Jl&30||Mb(n,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Z3(Ob.bind(null,n,i,r),[r]),n.flags|=2048,P0(9,Ib.bind(null,n,i,t,e),void 0,null),t},useId:function(){var r=Ns(),e=Jt.identifierPrefix;if(lt){var t=Gi,n=Vi;t=(n&~(1<<32-xs(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=C0++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=xA++,e=":"+e+"r"+t.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},CA={readContext:Xn,useCallback:$b,useContext:Xn,useEffect:i2,useImperativeHandle:jb,useInsertionEffect:Fb,useLayoutEffect:zb,useMemo:Ub,useReducer:dg,useRef:Db,useState:function(){return dg(R0)},useDebugValue:a2,useDeferredValue:function(r){var e=Yn();return Hb(e,jt.memoizedState,r)},useTransition:function(){var r=dg(R0)[0],e=Yn().memoizedState;return[r,e]},useMutableSource:Rb,useSyncExternalStore:Pb,useId:qb,unstable_isNewReconciler:!1},RA={readContext:Xn,useCallback:$b,useContext:Xn,useEffect:i2,useImperativeHandle:jb,useInsertionEffect:Fb,useLayoutEffect:zb,useMemo:Ub,useReducer:fg,useRef:Db,useState:function(){return fg(R0)},useDebugValue:a2,useDeferredValue:function(r){var e=Yn();return jt===null?e.memoizedState=r:Hb(e,jt.memoizedState,r)},useTransition:function(){var r=fg(R0)[0],e=Yn().memoizedState;return[r,e]},useMutableSource:Rb,useSyncExternalStore:Pb,useId:qb,unstable_isNewReconciler:!1};function ss(r,e){if(r&&r.defaultProps){e=yt({},e),r=r.defaultProps;for(var t in r)e[t]===void 0&&(e[t]=r[t]);return e}return e}function Tv(r,e,t,n){e=r.memoizedState,t=t(n,e),t=t==null?e:yt({},e,t),r.memoizedState=t,r.lanes===0&&(r.updateQueue.baseState=t)}var w1={isMounted:function(r){return(r=r._reactInternals)?ou(r)===r:!1},enqueueSetState:function(r,e,t){r=r._reactInternals;var n=Or(),s=ao(r),i=Wi(n,s);i.payload=e,t!=null&&(i.callback=t),e=so(r,i,s),e!==null&&(As(e,r,s,n),yp(e,r,s))},enqueueReplaceState:function(r,e,t){r=r._reactInternals;var n=Or(),s=ao(r),i=Wi(n,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=so(r,i,s),e!==null&&(As(e,r,s,n),yp(e,r,s))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var t=Or(),n=ao(r),s=Wi(t,n);s.tag=2,e!=null&&(s.callback=e),e=so(r,s,n),e!==null&&(As(e,r,n,t),yp(e,r,n))}};function e5(r,e,t,n,s,i,a){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!_0(t,n)||!_0(s,i):!0}function Kb(r,e,t){var n=!1,s=ho,i=e.contextType;return typeof i=="object"&&i!==null?i=Xn(i):(s=en(e)?Yl:_r.current,n=e.contextTypes,i=(n=n!=null)?nh(r,s):ho),e=new e(t,i),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=w1,r.stateNode=e,e._reactInternals=r,n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=i),e}function t5(r,e,t,n){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==r&&w1.enqueueReplaceState(e,e.state,null)}function Cv(r,e,t,n){var s=r.stateNode;s.props=t,s.state=r.memoizedState,s.refs={},Jy(r);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Xn(i):(i=en(e)?Yl:_r.current,s.context=nh(r,i)),s.state=r.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Tv(r,e,i,t),s.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&w1.enqueueReplaceState(s,s.state,null),wm(r,t,s,n),s.state=r.memoizedState),typeof s.componentDidMount=="function"&&(r.flags|=4194308)}function oh(r,e){try{var t="",n=e;do t+=n9(n),n=n.return;while(n);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:r,source:e,stack:s,digest:null}}function pg(r,e,t){return{value:r,source:null,stack:t??null,digest:e??null}}function Rv(r,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var PA=typeof WeakMap=="function"?WeakMap:Map;function Xb(r,e,t){t=Wi(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){Am||(Am=!0,Bv=n),Rv(r,e)},t}function Yb(r,e,t){t=Wi(-1,t),t.tag=3;var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;t.payload=function(){return n(s)},t.callback=function(){Rv(r,e)}}var i=r.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Rv(r,e),typeof n!="function"&&(io===null?io=new Set([this]):io.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function r5(r,e,t){var n=r.pingCache;if(n===null){n=r.pingCache=new PA;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(t)||(s.add(t),r=qA.bind(null,r,e,t),e.then(r,r))}function n5(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function s5(r,e,t,n,s){return r.mode&1?(r.flags|=65536,r.lanes=s,r):(r===e?r.flags|=65536:(r.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Wi(-1,1),e.tag=2,so(t,e,1))),t.lanes|=1),r)}var MA=oa.ReactCurrentOwner,Jr=!1;function Pr(r,e,t,n){e.child=r===null?Eb(e,null,t,n):ih(e,r.child,t,n)}function i5(r,e,t,n,s){t=t.render;var i=e.ref;return Vu(e,s),n=n2(r,e,t,n,i,s),t=s2(),r!==null&&!Jr?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,ta(r,e,s)):(lt&&t&&Vy(e),e.flags|=1,Pr(r,e,n,s),e.child)}function a5(r,e,t,n,s){if(r===null){var i=t.type;return typeof i=="function"&&!p2(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Qb(r,e,i,n,s)):(r=Ap(t.type,null,n,e,e.mode,s),r.ref=e.ref,r.return=e,e.child=r)}if(i=r.child,!(r.lanes&s)){var a=i.memoizedProps;if(t=t.compare,t=t!==null?t:_0,t(a,n)&&r.ref===e.ref)return ta(r,e,s)}return e.flags|=1,r=oo(i,n),r.ref=e.ref,r.return=e,e.child=r}function Qb(r,e,t,n,s){if(r!==null){var i=r.memoizedProps;if(_0(i,n)&&r.ref===e.ref)if(Jr=!1,e.pendingProps=n=i,(r.lanes&s)!==0)r.flags&131072&&(Jr=!0);else return e.lanes=r.lanes,ta(r,e,s)}return Pv(r,e,t,n,s)}function Jb(r,e,t){var n=e.pendingProps,s=n.children,i=r!==null?r.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(zu,yn),yn|=t;else{if(!(t&1073741824))return r=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,Ze(zu,yn),yn|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:t,Ze(zu,yn),yn|=n}else i!==null?(n=i.baseLanes|t,e.memoizedState=null):n=t,Ze(zu,yn),yn|=n;return Pr(r,e,s,t),e.child}function Zb(r,e){var t=e.ref;(r===null&&t!==null||r!==null&&r.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Pv(r,e,t,n,s){var i=en(t)?Yl:_r.current;return i=nh(e,i),Vu(e,s),t=n2(r,e,t,n,i,s),n=s2(),r!==null&&!Jr?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,ta(r,e,s)):(lt&&n&&Vy(e),e.flags|=1,Pr(r,e,t,s),e.child)}function o5(r,e,t,n,s){if(en(t)){var i=!0;pm(e)}else i=!1;if(Vu(e,s),e.stateNode===null)Sp(r,e),Kb(e,t,n),Cv(e,t,n,s),n=!0;else if(r===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=Xn(c):(c=en(t)?Yl:_r.current,c=nh(e,c));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&t5(e,a,n,c),ma=!1;var f=e.memoizedState;a.state=f,wm(e,n,a,s),l=e.memoizedState,o!==n||f!==l||Zr.current||ma?(typeof h=="function"&&(Tv(e,t,h,n),l=e.memoizedState),(o=ma||e5(e,t,o,n,f,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Tb(r,e),o=e.memoizedProps,c=e.type===e.elementType?o:ss(e.type,o),a.props=c,d=e.pendingProps,f=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=en(t)?Yl:_r.current,l=nh(e,l));var p=t.getDerivedStateFromProps;(h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==l)&&t5(e,a,n,l),ma=!1,f=e.memoizedState,a.state=f,wm(e,n,a,s);var g=e.memoizedState;o!==d||f!==g||Zr.current||ma?(typeof p=="function"&&(Tv(e,t,p,n),g=e.memoizedState),(c=ma||e5(e,t,c,n,f,g,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===r.memoizedProps&&f===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===r.memoizedProps&&f===r.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===r.memoizedProps&&f===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===r.memoizedProps&&f===r.memoizedState||(e.flags|=1024),n=!1)}return Mv(r,e,t,n,i,s)}function Mv(r,e,t,n,s,i){Zb(r,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&G3(e,t,!1),ta(r,e,i);n=e.stateNode,MA.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,r!==null&&a?(e.child=ih(e,r.child,null,i),e.child=ih(e,null,o,i)):Pr(r,e,o,i),e.memoizedState=n.state,s&&G3(e,t,!0),e.child}function e7(r){var e=r.stateNode;e.pendingContext?V3(r,e.pendingContext,e.pendingContext!==e.context):e.context&&V3(r,e.context,!1),Zy(r,e.containerInfo)}function l5(r,e,t,n,s){return sh(),Wy(s),e.flags|=256,Pr(r,e,t,n),e.child}var Iv={dehydrated:null,treeContext:null,retryLane:0};function Ov(r){return{baseLanes:r,cachePool:null,transitions:null}}function t7(r,e,t){var n=e.pendingProps,s=pt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=r!==null&&r.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(s|=1),Ze(pt,s&1),r===null)return Ev(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(e.mode&1?r.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,r=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=_1(a,n,0,null),r=Xl(r,n,t,null),i.return=e,r.return=e,i.sibling=r,e.child=i,e.child.memoizedState=Ov(t),e.memoizedState=Iv,r):o2(e,a));if(s=r.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return IA(r,e,a,n,o,s,t);if(i){i=n.fallback,a=e.mode,s=r.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=oo(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=oo(o,i):(i=Xl(i,a,t,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=r.child.memoizedState,a=a===null?Ov(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=r.childLanes&~t,e.memoizedState=Iv,n}return i=r.child,r=i.sibling,n=oo(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,r!==null&&(t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)),e.child=n,e.memoizedState=null,n}function o2(r,e){return e=_1({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function $f(r,e,t,n){return n!==null&&Wy(n),ih(e,r.child,null,t),r=o2(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function IA(r,e,t,n,s,i,a){if(t)return e.flags&256?(e.flags&=-257,n=pg(Error(H(422))),$f(r,e,a,n)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=_1({mode:"visible",children:n.children},s,0,null),i=Xl(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&ih(e,r.child,null,a),e.child.memoizedState=Ov(a),e.memoizedState=Iv,i);if(!(e.mode&1))return $f(r,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(H(419)),n=pg(i,n,void 0),$f(r,e,a,n)}if(o=(a&r.childLanes)!==0,Jr||o){if(n=Jt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ea(r,s),As(n,r,s,-1))}return f2(),n=pg(Error(H(421))),$f(r,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=r.child,e=VA.bind(null,r),s._reactRetry=e,null):(r=i.treeContext,An=no(s.nextSibling),En=e,lt=!0,Ss=null,r!==null&&($n[Un++]=Vi,$n[Un++]=Gi,$n[Un++]=Ql,Vi=r.id,Gi=r.overflow,Ql=e),e=o2(e,n.children),e.flags|=4096,e)}function u5(r,e,t){r.lanes|=e;var n=r.alternate;n!==null&&(n.lanes|=e),kv(r.return,e,t)}function mg(r,e,t,n,s){var i=r.memoizedState;i===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=t,i.tailMode=s)}function r7(r,e,t){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Pr(r,e,n.children,t),n=pt.current,n&2)n=n&1|2,e.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&u5(r,t,e);else if(r.tag===19)u5(r,t,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}n&=1}if(Ze(pt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)r=t.alternate,r!==null&&bm(r)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),mg(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(r=s.alternate,r!==null&&bm(r)===null){e.child=s;break}r=s.sibling,s.sibling=t,t=s,s=r}mg(e,!0,t,null,i);break;case"together":mg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sp(r,e){!(e.mode&1)&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function ta(r,e,t){if(r!==null&&(e.dependencies=r.dependencies),Zl|=e.lanes,!(t&e.childLanes))return null;if(r!==null&&e.child!==r.child)throw Error(H(153));if(e.child!==null){for(r=e.child,t=oo(r,r.pendingProps),e.child=t,t.return=e;r.sibling!==null;)r=r.sibling,t=t.sibling=oo(r,r.pendingProps),t.return=e;t.sibling=null}return e.child}function OA(r,e,t){switch(e.tag){case 3:e7(e),sh();break;case 5:Cb(e);break;case 1:en(e.type)&&pm(e);break;case 4:Zy(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Ze(vm,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ze(pt,pt.current&1),e.flags|=128,null):t&e.child.childLanes?t7(r,e,t):(Ze(pt,pt.current&1),r=ta(r,e,t),r!==null?r.sibling:null);Ze(pt,pt.current&1);break;case 19:if(n=(t&e.childLanes)!==0,r.flags&128){if(n)return r7(r,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ze(pt,pt.current),n)break;return null;case 22:case 23:return e.lanes=0,Jb(r,e,t)}return ta(r,e,t)}var n7,Nv,s7,i7;n7=function(r,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)r.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Nv=function(){};s7=function(r,e,t,n){var s=r.memoizedProps;if(s!==n){r=e.stateNode,Uo(ni.current);var i=null;switch(t){case"input":s=rv(r,s),n=rv(r,n),i=[];break;case"select":s=yt({},s,{value:void 0}),n=yt({},n,{value:void 0}),i=[];break;case"textarea":s=iv(r,s),n=iv(r,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(r.onclick=dm)}ov(t,n);var a;t=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(m0.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(m0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&tt("scroll",r),i||o===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};i7=function(r,e,t,n){t!==n&&(e.flags|=4)};function Eh(r,e){if(!lt)switch(r.tailMode){case"hidden":e=r.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?r.tail=null:t.sibling=null;break;case"collapsed":t=r.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:n.sibling=null}}function cr(r){var e=r.alternate!==null&&r.alternate.child===r.child,t=0,n=0;if(e)for(var s=r.child;s!==null;)t|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=r,s=s.sibling;else for(s=r.child;s!==null;)t|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=r,s=s.sibling;return r.subtreeFlags|=n,r.childLanes=t,e}function NA(r,e,t){var n=e.pendingProps;switch(Gy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(e),null;case 1:return en(e.type)&&fm(),cr(e),null;case 3:return n=e.stateNode,ah(),st(Zr),st(_r),t2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(r===null||r.child===null)&&(Bf(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ss!==null&&(Uv(Ss),Ss=null))),Nv(r,e),cr(e),null;case 5:e2(e);var s=Uo(T0.current);if(t=e.type,r!==null&&e.stateNode!=null)s7(r,e,t,n,s),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(H(166));return cr(e),null}if(r=Uo(ni.current),Bf(e)){n=e.stateNode,t=e.type;var i=e.memoizedProps;switch(n[Zs]=e,n[E0]=i,r=(e.mode&1)!==0,t){case"dialog":tt("cancel",n),tt("close",n);break;case"iframe":case"object":case"embed":tt("load",n);break;case"video":case"audio":for(s=0;s<Lh.length;s++)tt(Lh[s],n);break;case"source":tt("error",n);break;case"img":case"image":case"link":tt("error",n),tt("load",n);break;case"details":tt("toggle",n);break;case"input":y3(n,i),tt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},tt("invalid",n);break;case"textarea":b3(n,i),tt("invalid",n)}ov(t,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&zf(n.textContent,o,r),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&zf(n.textContent,o,r),s=["children",""+o]):m0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&tt("scroll",n)}switch(t){case"input":Pf(n),w3(n,i,!0);break;case"textarea":Pf(n),S3(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=dm)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=O6(t)),r==="http://www.w3.org/1999/xhtml"?t==="script"?(r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof n.is=="string"?r=a.createElement(t,{is:n.is}):(r=a.createElement(t),t==="select"&&(a=r,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):r=a.createElementNS(r,t),r[Zs]=e,r[E0]=n,n7(r,e,!1,!1),e.stateNode=r;e:{switch(a=lv(t,n),t){case"dialog":tt("cancel",r),tt("close",r),s=n;break;case"iframe":case"object":case"embed":tt("load",r),s=n;break;case"video":case"audio":for(s=0;s<Lh.length;s++)tt(Lh[s],r);s=n;break;case"source":tt("error",r),s=n;break;case"img":case"image":case"link":tt("error",r),tt("load",r),s=n;break;case"details":tt("toggle",r),s=n;break;case"input":y3(r,n),s=rv(r,n),tt("invalid",r);break;case"option":s=n;break;case"select":r._wrapperState={wasMultiple:!!n.multiple},s=yt({},n,{value:void 0}),tt("invalid",r);break;case"textarea":b3(r,n),s=iv(r,n),tt("invalid",r);break;default:s=n}ov(t,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?D6(r,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&N6(r,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&g0(r,l):typeof l=="number"&&g0(r,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(m0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&tt("scroll",r):l!=null&&My(r,i,l,a))}switch(t){case"input":Pf(r),w3(r,n,!1);break;case"textarea":Pf(r),S3(r);break;case"option":n.value!=null&&r.setAttribute("value",""+co(n.value));break;case"select":r.multiple=!!n.multiple,i=n.value,i!=null?$u(r,!!n.multiple,i,!1):n.defaultValue!=null&&$u(r,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(r.onclick=dm)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return cr(e),null;case 6:if(r&&e.stateNode!=null)i7(r,e,r.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(H(166));if(t=Uo(T0.current),Uo(ni.current),Bf(e)){if(n=e.stateNode,t=e.memoizedProps,n[Zs]=e,(i=n.nodeValue!==t)&&(r=En,r!==null))switch(r.tag){case 3:zf(n.nodeValue,t,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&zf(n.nodeValue,t,(r.mode&1)!==0)}i&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Zs]=e,e.stateNode=n}return cr(e),null;case 13:if(st(pt),n=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(lt&&An!==null&&e.mode&1&&!(e.flags&128))xb(),sh(),e.flags|=98560,i=!1;else if(i=Bf(e),n!==null&&n.dehydrated!==null){if(r===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Zs]=e}else sh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;cr(e),i=!1}else Ss!==null&&(Uv(Ss),Ss=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(r!==null&&r.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(r===null||pt.current&1?$t===0&&($t=3):f2())),e.updateQueue!==null&&(e.flags|=4),cr(e),null);case 4:return ah(),Nv(r,e),r===null&&x0(e.stateNode.containerInfo),cr(e),null;case 10:return Yy(e.type._context),cr(e),null;case 17:return en(e.type)&&fm(),cr(e),null;case 19:if(st(pt),i=e.memoizedState,i===null)return cr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Eh(i,!1);else{if($t!==0||r!==null&&r.flags&128)for(r=e.child;r!==null;){if(a=bm(r),a!==null){for(e.flags|=128,Eh(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)i=t,r=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,r=a.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t=t.sibling;return Ze(pt,pt.current&1|2),e.child}r=r.sibling}i.tail!==null&&Et()>lh&&(e.flags|=128,n=!0,Eh(i,!1),e.lanes=4194304)}else{if(!n)if(r=bm(a),r!==null){if(e.flags|=128,n=!0,t=r.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Eh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!lt)return cr(e),null}else 2*Et()-i.renderingStartTime>lh&&t!==1073741824&&(e.flags|=128,n=!0,Eh(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(t=i.last,t!==null?t.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Et(),e.sibling=null,t=pt.current,Ze(pt,n?t&1|2:t&1),e):(cr(e),null);case 22:case 23:return d2(),n=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?yn&1073741824&&(cr(e),e.subtreeFlags&6&&(e.flags|=8192)):cr(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function LA(r,e){switch(Gy(e),e.tag){case 1:return en(e.type)&&fm(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return ah(),st(Zr),st(_r),t2(),r=e.flags,r&65536&&!(r&128)?(e.flags=r&-65537|128,e):null;case 5:return e2(e),null;case 13:if(st(pt),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(H(340));sh()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return st(pt),null;case 4:return ah(),null;case 10:return Yy(e.type._context),null;case 22:case 23:return d2(),null;case 24:return null;default:return null}}var Uf=!1,br=!1,DA=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Fu(r,e){var t=r.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){_t(r,e,n)}else t.current=null}function Lv(r,e,t){try{t()}catch(n){_t(r,e,n)}}var c5=!1;function FA(r,e){if(yv=um,r=cb(),qy(r)){if("selectionStart"in r)var t={start:r.selectionStart,end:r.selectionEnd};else e:{t=(t=r.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,h=0,d=r,f=null;t:for(;;){for(var p;d!==t||s!==0&&d.nodeType!==3||(o=a+s),d!==i||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===r)break t;if(f===t&&++c===s&&(o=a),f===i&&++h===n&&(l=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(wv={focusedElem:r,selectionRange:t},um=!1,ee=e;ee!==null;)if(e=ee,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,ee=r;else for(;ee!==null;){e=ee;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var w=g.memoizedProps,x=g.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?w:ss(e.type,w),x);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(C){_t(e,e.return,C)}if(r=e.sibling,r!==null){r.return=e.return,ee=r;break}ee=e.return}return g=c5,c5=!1,g}function a0(r,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&r)===r){var i=s.destroy;s.destroy=void 0,i!==void 0&&Lv(e,t,i)}s=s.next}while(s!==n)}}function b1(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&r)===r){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function Dv(r){var e=r.ref;if(e!==null){var t=r.stateNode;switch(r.tag){case 5:r=t;break;default:r=t}typeof e=="function"?e(r):e.current=r}}function a7(r){var e=r.alternate;e!==null&&(r.alternate=null,a7(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[Zs],delete e[E0],delete e[_v],delete e[wA],delete e[bA])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function o7(r){return r.tag===5||r.tag===3||r.tag===4}function h5(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||o7(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Fv(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(r,e):t.insertBefore(r,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(r,t)):(e=t,e.appendChild(r)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=dm));else if(n!==4&&(r=r.child,r!==null))for(Fv(r,e,t),r=r.sibling;r!==null;)Fv(r,e,t),r=r.sibling}function zv(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.insertBefore(r,e):t.appendChild(r);else if(n!==4&&(r=r.child,r!==null))for(zv(r,e,t),r=r.sibling;r!==null;)zv(r,e,t),r=r.sibling}var sr=null,ws=!1;function ua(r,e,t){for(t=t.child;t!==null;)l7(r,e,t),t=t.sibling}function l7(r,e,t){if(ri&&typeof ri.onCommitFiberUnmount=="function")try{ri.onCommitFiberUnmount(d1,t)}catch{}switch(t.tag){case 5:br||Fu(t,e);case 6:var n=sr,s=ws;sr=null,ua(r,e,t),sr=n,ws=s,sr!==null&&(ws?(r=sr,t=t.stateNode,r.nodeType===8?r.parentNode.removeChild(t):r.removeChild(t)):sr.removeChild(t.stateNode));break;case 18:sr!==null&&(ws?(r=sr,t=t.stateNode,r.nodeType===8?lg(r.parentNode,t):r.nodeType===1&&lg(r,t),b0(r)):lg(sr,t.stateNode));break;case 4:n=sr,s=ws,sr=t.stateNode.containerInfo,ws=!0,ua(r,e,t),sr=n,ws=s;break;case 0:case 11:case 14:case 15:if(!br&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Lv(t,e,a),s=s.next}while(s!==n)}ua(r,e,t);break;case 1:if(!br&&(Fu(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(o){_t(t,e,o)}ua(r,e,t);break;case 21:ua(r,e,t);break;case 22:t.mode&1?(br=(n=br)||t.memoizedState!==null,ua(r,e,t),br=n):ua(r,e,t);break;default:ua(r,e,t)}}function d5(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var t=r.stateNode;t===null&&(t=r.stateNode=new DA),e.forEach(function(n){var s=GA.bind(null,r,n);t.has(n)||(t.add(n),n.then(s,s))})}}function es(r,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];try{var i=r,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:sr=o.stateNode,ws=!1;break e;case 3:sr=o.stateNode.containerInfo,ws=!0;break e;case 4:sr=o.stateNode.containerInfo,ws=!0;break e}o=o.return}if(sr===null)throw Error(H(160));l7(i,a,s),sr=null,ws=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){_t(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)u7(e,r),e=e.sibling}function u7(r,e){var t=r.alternate,n=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(es(e,r),Ps(r),n&4){try{a0(3,r,r.return),b1(3,r)}catch(w){_t(r,r.return,w)}try{a0(5,r,r.return)}catch(w){_t(r,r.return,w)}}break;case 1:es(e,r),Ps(r),n&512&&t!==null&&Fu(t,t.return);break;case 5:if(es(e,r),Ps(r),n&512&&t!==null&&Fu(t,t.return),r.flags&32){var s=r.stateNode;try{g0(s,"")}catch(w){_t(r,r.return,w)}}if(n&4&&(s=r.stateNode,s!=null)){var i=r.memoizedProps,a=t!==null?t.memoizedProps:i,o=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&M6(s,i),lv(o,a);var c=lv(o,i);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];h==="style"?D6(s,d):h==="dangerouslySetInnerHTML"?N6(s,d):h==="children"?g0(s,d):My(s,h,d,c)}switch(o){case"input":nv(s,i);break;case"textarea":I6(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?$u(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?$u(s,!!i.multiple,i.defaultValue,!0):$u(s,!!i.multiple,i.multiple?[]:"",!1))}s[E0]=i}catch(w){_t(r,r.return,w)}}break;case 6:if(es(e,r),Ps(r),n&4){if(r.stateNode===null)throw Error(H(162));s=r.stateNode,i=r.memoizedProps;try{s.nodeValue=i}catch(w){_t(r,r.return,w)}}break;case 3:if(es(e,r),Ps(r),n&4&&t!==null&&t.memoizedState.isDehydrated)try{b0(e.containerInfo)}catch(w){_t(r,r.return,w)}break;case 4:es(e,r),Ps(r);break;case 13:es(e,r),Ps(r),s=r.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(c2=Et())),n&4&&d5(r);break;case 22:if(h=t!==null&&t.memoizedState!==null,r.mode&1?(br=(c=br)||h,es(e,r),br=c):es(e,r),Ps(r),n&8192){if(c=r.memoizedState!==null,(r.stateNode.isHidden=c)&&!h&&r.mode&1)for(ee=r,h=r.child;h!==null;){for(d=ee=h;ee!==null;){switch(f=ee,p=f.child,f.tag){case 0:case 11:case 14:case 15:a0(4,f,f.return);break;case 1:Fu(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,t=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(w){_t(n,t,w)}}break;case 5:Fu(f,f.return);break;case 22:if(f.memoizedState!==null){p5(d);continue}}p!==null?(p.return=f,ee=p):p5(d)}h=h.sibling}e:for(h=null,d=r;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=L6("display",a))}catch(w){_t(r,r.return,w)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(w){_t(r,r.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===r)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===r)break e;for(;d.sibling===null;){if(d.return===null||d.return===r)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:es(e,r),Ps(r),n&4&&d5(r);break;case 21:break;default:es(e,r),Ps(r)}}function Ps(r){var e=r.flags;if(e&2){try{e:{for(var t=r.return;t!==null;){if(o7(t)){var n=t;break e}t=t.return}throw Error(H(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(g0(s,""),n.flags&=-33);var i=h5(r);zv(r,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=h5(r);Fv(r,o,a);break;default:throw Error(H(161))}}catch(l){_t(r,r.return,l)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function zA(r,e,t){ee=r,c7(r)}function c7(r,e,t){for(var n=(r.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Uf;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||br;o=Uf;var c=br;if(Uf=a,(br=l)&&!c)for(ee=s;ee!==null;)a=ee,l=a.child,a.tag===22&&a.memoizedState!==null?m5(s):l!==null?(l.return=a,ee=l):m5(s);for(;i!==null;)ee=i,c7(i),i=i.sibling;ee=s,Uf=o,br=c}f5(r)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):f5(r)}}function f5(r){for(;ee!==null;){var e=ee;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:br||b1(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!br)if(t===null)n.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:ss(e.type,t.memoizedProps);n.componentDidUpdate(s,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Q3(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Q3(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&b0(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}br||e.flags&512&&Dv(e)}catch(f){_t(e,e.return,f)}}if(e===r){ee=null;break}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}}function p5(r){for(;ee!==null;){var e=ee;if(e===r){ee=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ee=t;break}ee=e.return}}function m5(r){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{b1(4,e)}catch(l){_t(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){_t(e,s,l)}}var i=e.return;try{Dv(e)}catch(l){_t(e,i,l)}break;case 5:var a=e.return;try{Dv(e)}catch(l){_t(e,a,l)}}}catch(l){_t(e,e.return,l)}if(e===r){ee=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ee=o;break}ee=e.return}}var BA=Math.ceil,xm=oa.ReactCurrentDispatcher,l2=oa.ReactCurrentOwner,Wn=oa.ReactCurrentBatchConfig,Oe=0,Jt=null,Mt=null,ar=0,yn=0,zu=bo(0),$t=0,M0=null,Zl=0,S1=0,u2=0,o0=null,Yr=null,c2=0,lh=1/0,fi=null,Am=!1,Bv=null,io=null,Hf=!1,Ja=null,Em=0,l0=0,jv=null,_p=-1,xp=0;function Or(){return Oe&6?Et():_p!==-1?_p:_p=Et()}function ao(r){return r.mode&1?Oe&2&&ar!==0?ar&-ar:_A.transition!==null?(xp===0&&(xp=K6()),xp):(r=qe,r!==0||(r=window.event,r=r===void 0?16:tb(r.type)),r):1}function As(r,e,t,n){if(50<l0)throw l0=0,jv=null,Error(H(185));mf(r,t,n),(!(Oe&2)||r!==Jt)&&(r===Jt&&(!(Oe&2)&&(S1|=t),$t===4&&ya(r,ar)),tn(r,n),t===1&&Oe===0&&!(e.mode&1)&&(lh=Et()+500,v1&&So()))}function tn(r,e){var t=r.callbackNode;_9(r,e);var n=lm(r,r===Jt?ar:0);if(n===0)t!==null&&A3(t),r.callbackNode=null,r.callbackPriority=0;else if(e=n&-n,r.callbackPriority!==e){if(t!=null&&A3(t),e===1)r.tag===0?SA(g5.bind(null,r)):bb(g5.bind(null,r)),vA(function(){!(Oe&6)&&So()}),t=null;else{switch(X6(n)){case 1:t=Dy;break;case 4:t=G6;break;case 16:t=om;break;case 536870912:t=W6;break;default:t=om}t=y7(t,h7.bind(null,r))}r.callbackPriority=e,r.callbackNode=t}}function h7(r,e){if(_p=-1,xp=0,Oe&6)throw Error(H(327));var t=r.callbackNode;if(Gu()&&r.callbackNode!==t)return null;var n=lm(r,r===Jt?ar:0);if(n===0)return null;if(n&30||n&r.expiredLanes||e)e=km(r,n);else{e=n;var s=Oe;Oe|=2;var i=f7();(Jt!==r||ar!==e)&&(fi=null,lh=Et()+500,Kl(r,e));do try{UA();break}catch(o){d7(r,o)}while(!0);Xy(),xm.current=i,Oe=s,Mt!==null?e=0:(Jt=null,ar=0,e=$t)}if(e!==0){if(e===2&&(s=fv(r),s!==0&&(n=s,e=$v(r,s))),e===1)throw t=M0,Kl(r,0),ya(r,n),tn(r,Et()),t;if(e===6)ya(r,n);else{if(s=r.current.alternate,!(n&30)&&!jA(s)&&(e=km(r,n),e===2&&(i=fv(r),i!==0&&(n=i,e=$v(r,i))),e===1))throw t=M0,Kl(r,0),ya(r,n),tn(r,Et()),t;switch(r.finishedWork=s,r.finishedLanes=n,e){case 0:case 1:throw Error(H(345));case 2:Po(r,Yr,fi);break;case 3:if(ya(r,n),(n&130023424)===n&&(e=c2+500-Et(),10<e)){if(lm(r,0)!==0)break;if(s=r.suspendedLanes,(s&n)!==n){Or(),r.pingedLanes|=r.suspendedLanes&s;break}r.timeoutHandle=Sv(Po.bind(null,r,Yr,fi),e);break}Po(r,Yr,fi);break;case 4:if(ya(r,n),(n&4194240)===n)break;for(e=r.eventTimes,s=-1;0<n;){var a=31-xs(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Et()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*BA(n/1960))-n,10<n){r.timeoutHandle=Sv(Po.bind(null,r,Yr,fi),n);break}Po(r,Yr,fi);break;case 5:Po(r,Yr,fi);break;default:throw Error(H(329))}}}return tn(r,Et()),r.callbackNode===t?h7.bind(null,r):null}function $v(r,e){var t=o0;return r.current.memoizedState.isDehydrated&&(Kl(r,e).flags|=256),r=km(r,e),r!==2&&(e=Yr,Yr=t,e!==null&&Uv(e)),r}function Uv(r){Yr===null?Yr=r:Yr.push.apply(Yr,r)}function jA(r){for(var e=r;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var s=t[n],i=s.getSnapshot;s=s.value;try{if(!Es(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ya(r,e){for(e&=~u2,e&=~S1,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var t=31-xs(e),n=1<<t;r[t]=-1,e&=~n}}function g5(r){if(Oe&6)throw Error(H(327));Gu();var e=lm(r,0);if(!(e&1))return tn(r,Et()),null;var t=km(r,e);if(r.tag!==0&&t===2){var n=fv(r);n!==0&&(e=n,t=$v(r,n))}if(t===1)throw t=M0,Kl(r,0),ya(r,e),tn(r,Et()),t;if(t===6)throw Error(H(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,Po(r,Yr,fi),tn(r,Et()),null}function h2(r,e){var t=Oe;Oe|=1;try{return r(e)}finally{Oe=t,Oe===0&&(lh=Et()+500,v1&&So())}}function eu(r){Ja!==null&&Ja.tag===0&&!(Oe&6)&&Gu();var e=Oe;Oe|=1;var t=Wn.transition,n=qe;try{if(Wn.transition=null,qe=1,r)return r()}finally{qe=n,Wn.transition=t,Oe=e,!(Oe&6)&&So()}}function d2(){yn=zu.current,st(zu)}function Kl(r,e){r.finishedWork=null,r.finishedLanes=0;var t=r.timeoutHandle;if(t!==-1&&(r.timeoutHandle=-1,gA(t)),Mt!==null)for(t=Mt.return;t!==null;){var n=t;switch(Gy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&fm();break;case 3:ah(),st(Zr),st(_r),t2();break;case 5:e2(n);break;case 4:ah();break;case 13:st(pt);break;case 19:st(pt);break;case 10:Yy(n.type._context);break;case 22:case 23:d2()}t=t.return}if(Jt=r,Mt=r=oo(r.current,null),ar=yn=e,$t=0,M0=null,u2=S1=Zl=0,Yr=o0=null,$o!==null){for(e=0;e<$o.length;e++)if(t=$o[e],n=t.interleaved,n!==null){t.interleaved=null;var s=n.next,i=t.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}t.pending=n}$o=null}return r}function d7(r,e){do{var t=Mt;try{if(Xy(),wp.current=_m,Sm){for(var n=vt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Sm=!1}if(Jl=0,Qt=jt=vt=null,i0=!1,C0=0,l2.current=null,t===null||t.return===null){$t=1,M0=e,Mt=null;break}e:{var i=r,a=t.return,o=t,l=e;if(e=ar,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=n5(a);if(p!==null){p.flags&=-257,s5(p,a,o,i,e),p.mode&1&&r5(i,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var w=new Set;w.add(l),e.updateQueue=w}else g.add(l);break e}else{if(!(e&1)){r5(i,c,e),f2();break e}l=Error(H(426))}}else if(lt&&o.mode&1){var x=n5(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),s5(x,a,o,i,e),Wy(oh(l,o));break e}}i=l=oh(l,o),$t!==4&&($t=2),o0===null?o0=[i]:o0.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=Xb(i,l,e);Y3(i,y);break e;case 1:o=l;var b=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(io===null||!io.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=Yb(i,o,e);Y3(i,C);break e}}i=i.return}while(i!==null)}m7(t)}catch(R){e=R,Mt===t&&t!==null&&(Mt=t=t.return);continue}break}while(!0)}function f7(){var r=xm.current;return xm.current=_m,r===null?_m:r}function f2(){($t===0||$t===3||$t===2)&&($t=4),Jt===null||!(Zl&268435455)&&!(S1&268435455)||ya(Jt,ar)}function km(r,e){var t=Oe;Oe|=2;var n=f7();(Jt!==r||ar!==e)&&(fi=null,Kl(r,e));do try{$A();break}catch(s){d7(r,s)}while(!0);if(Xy(),Oe=t,xm.current=n,Mt!==null)throw Error(H(261));return Jt=null,ar=0,$t}function $A(){for(;Mt!==null;)p7(Mt)}function UA(){for(;Mt!==null&&!f9();)p7(Mt)}function p7(r){var e=v7(r.alternate,r,yn);r.memoizedProps=r.pendingProps,e===null?m7(r):Mt=e,l2.current=null}function m7(r){var e=r;do{var t=e.alternate;if(r=e.return,e.flags&32768){if(t=LA(t,e),t!==null){t.flags&=32767,Mt=t;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{$t=6,Mt=null;return}}else if(t=NA(t,e,yn),t!==null){Mt=t;return}if(e=e.sibling,e!==null){Mt=e;return}Mt=e=r}while(e!==null);$t===0&&($t=5)}function Po(r,e,t){var n=qe,s=Wn.transition;try{Wn.transition=null,qe=1,HA(r,e,t,n)}finally{Wn.transition=s,qe=n}return null}function HA(r,e,t,n){do Gu();while(Ja!==null);if(Oe&6)throw Error(H(327));t=r.finishedWork;var s=r.finishedLanes;if(t===null)return null;if(r.finishedWork=null,r.finishedLanes=0,t===r.current)throw Error(H(177));r.callbackNode=null,r.callbackPriority=0;var i=t.lanes|t.childLanes;if(x9(r,i),r===Jt&&(Mt=Jt=null,ar=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Hf||(Hf=!0,y7(om,function(){return Gu(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Wn.transition,Wn.transition=null;var a=qe;qe=1;var o=Oe;Oe|=4,l2.current=null,FA(r,t),u7(t,r),uA(wv),um=!!yv,wv=yv=null,r.current=t,zA(t),p9(),Oe=o,qe=a,Wn.transition=i}else r.current=t;if(Hf&&(Hf=!1,Ja=r,Em=s),i=r.pendingLanes,i===0&&(io=null),v9(t.stateNode),tn(r,Et()),e!==null)for(n=r.onRecoverableError,t=0;t<e.length;t++)s=e[t],n(s.value,{componentStack:s.stack,digest:s.digest});if(Am)throw Am=!1,r=Bv,Bv=null,r;return Em&1&&r.tag!==0&&Gu(),i=r.pendingLanes,i&1?r===jv?l0++:(l0=0,jv=r):l0=0,So(),null}function Gu(){if(Ja!==null){var r=X6(Em),e=Wn.transition,t=qe;try{if(Wn.transition=null,qe=16>r?16:r,Ja===null)var n=!1;else{if(r=Ja,Ja=null,Em=0,Oe&6)throw Error(H(331));var s=Oe;for(Oe|=4,ee=r.current;ee!==null;){var i=ee,a=i.child;if(ee.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ee=c;ee!==null;){var h=ee;switch(h.tag){case 0:case 11:case 15:a0(8,h,i)}var d=h.child;if(d!==null)d.return=h,ee=d;else for(;ee!==null;){h=ee;var f=h.sibling,p=h.return;if(a7(h),h===c){ee=null;break}if(f!==null){f.return=p,ee=f;break}ee=p}}}var g=i.alternate;if(g!==null){var w=g.child;if(w!==null){g.child=null;do{var x=w.sibling;w.sibling=null,w=x}while(w!==null)}}ee=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ee=a;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:a0(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ee=y;break e}ee=i.return}}var b=r.current;for(ee=b;ee!==null;){a=ee;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,ee=_;else e:for(a=b;ee!==null;){if(o=ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:b1(9,o)}}catch(R){_t(o,o.return,R)}if(o===a){ee=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,ee=C;break e}ee=o.return}}if(Oe=s,So(),ri&&typeof ri.onPostCommitFiberRoot=="function")try{ri.onPostCommitFiberRoot(d1,r)}catch{}n=!0}return n}finally{qe=t,Wn.transition=e}}return!1}function v5(r,e,t){e=oh(t,e),e=Xb(r,e,1),r=so(r,e,1),e=Or(),r!==null&&(mf(r,1,e),tn(r,e))}function _t(r,e,t){if(r.tag===3)v5(r,r,t);else for(;e!==null;){if(e.tag===3){v5(e,r,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(io===null||!io.has(n))){r=oh(t,r),r=Yb(e,r,1),e=so(e,r,1),r=Or(),e!==null&&(mf(e,1,r),tn(e,r));break}}e=e.return}}function qA(r,e,t){var n=r.pingCache;n!==null&&n.delete(e),e=Or(),r.pingedLanes|=r.suspendedLanes&t,Jt===r&&(ar&t)===t&&($t===4||$t===3&&(ar&130023424)===ar&&500>Et()-c2?Kl(r,0):u2|=t),tn(r,e)}function g7(r,e){e===0&&(r.mode&1?(e=Of,Of<<=1,!(Of&130023424)&&(Of=4194304)):e=1);var t=Or();r=ea(r,e),r!==null&&(mf(r,e,t),tn(r,t))}function VA(r){var e=r.memoizedState,t=0;e!==null&&(t=e.retryLane),g7(r,t)}function GA(r,e){var t=0;switch(r.tag){case 13:var n=r.stateNode,s=r.memoizedState;s!==null&&(t=s.retryLane);break;case 19:n=r.stateNode;break;default:throw Error(H(314))}n!==null&&n.delete(e),g7(r,t)}var v7;v7=function(r,e,t){if(r!==null)if(r.memoizedProps!==e.pendingProps||Zr.current)Jr=!0;else{if(!(r.lanes&t)&&!(e.flags&128))return Jr=!1,OA(r,e,t);Jr=!!(r.flags&131072)}else Jr=!1,lt&&e.flags&1048576&&Sb(e,gm,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Sp(r,e),r=e.pendingProps;var s=nh(e,_r.current);Vu(e,t),s=n2(null,e,n,r,s,t);var i=s2();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(n)?(i=!0,pm(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Jy(e),s.updater=w1,e.stateNode=s,s._reactInternals=e,Cv(e,n,r,t),e=Mv(null,e,n,!0,i,t)):(e.tag=0,lt&&i&&Vy(e),Pr(null,e,s,t),e=e.child),e;case 16:n=e.elementType;e:{switch(Sp(r,e),r=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=KA(n),r=ss(n,r),s){case 0:e=Pv(null,e,n,r,t);break e;case 1:e=o5(null,e,n,r,t);break e;case 11:e=i5(null,e,n,r,t);break e;case 14:e=a5(null,e,n,ss(n.type,r),t);break e}throw Error(H(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ss(n,s),Pv(r,e,n,s,t);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ss(n,s),o5(r,e,n,s,t);case 3:e:{if(e7(e),r===null)throw Error(H(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Tb(r,e),wm(e,n,null,t);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=oh(Error(H(423)),e),e=l5(r,e,n,t,s);break e}else if(n!==s){s=oh(Error(H(424)),e),e=l5(r,e,n,t,s);break e}else for(An=no(e.stateNode.containerInfo.firstChild),En=e,lt=!0,Ss=null,t=Eb(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(sh(),n===s){e=ta(r,e,t);break e}Pr(r,e,n,t)}e=e.child}return e;case 5:return Cb(e),r===null&&Ev(e),n=e.type,s=e.pendingProps,i=r!==null?r.memoizedProps:null,a=s.children,bv(n,s)?a=null:i!==null&&bv(n,i)&&(e.flags|=32),Zb(r,e),Pr(r,e,a,t),e.child;case 6:return r===null&&Ev(e),null;case 13:return t7(r,e,t);case 4:return Zy(e,e.stateNode.containerInfo),n=e.pendingProps,r===null?e.child=ih(e,null,n,t):Pr(r,e,n,t),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ss(n,s),i5(r,e,n,s,t);case 7:return Pr(r,e,e.pendingProps,t),e.child;case 8:return Pr(r,e,e.pendingProps.children,t),e.child;case 12:return Pr(r,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ze(vm,n._currentValue),n._currentValue=a,i!==null)if(Es(i.value,a)){if(i.children===s.children&&!Zr.current){e=ta(r,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Wi(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),kv(i.return,t,e),o.lanes|=t;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(H(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),kv(a,t,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Pr(r,e,s.children,t),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Vu(e,t),s=Xn(s),n=n(s),e.flags|=1,Pr(r,e,n,t),e.child;case 14:return n=e.type,s=ss(n,e.pendingProps),s=ss(n.type,s),a5(r,e,n,s,t);case 15:return Qb(r,e,e.type,e.pendingProps,t);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ss(n,s),Sp(r,e),e.tag=1,en(n)?(r=!0,pm(e)):r=!1,Vu(e,t),Kb(e,n,s),Cv(e,n,s,t),Mv(null,e,n,!0,r,t);case 19:return r7(r,e,t);case 22:return Jb(r,e,t)}throw Error(H(156,e.tag))};function y7(r,e){return V6(r,e)}function WA(r,e,t,n){this.tag=r,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(r,e,t,n){return new WA(r,e,t,n)}function p2(r){return r=r.prototype,!(!r||!r.isReactComponent)}function KA(r){if(typeof r=="function")return p2(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Oy)return 11;if(r===Ny)return 14}return 2}function oo(r,e){var t=r.alternate;return t===null?(t=Vn(r.tag,e,r.key,r.mode),t.elementType=r.elementType,t.type=r.type,t.stateNode=r.stateNode,t.alternate=r,r.alternate=t):(t.pendingProps=e,t.type=r.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=r.flags&14680064,t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=r.sibling,t.index=r.index,t.ref=r.ref,t}function Ap(r,e,t,n,s,i){var a=2;if(n=r,typeof r=="function")p2(r)&&(a=1);else if(typeof r=="string")a=5;else e:switch(r){case Cu:return Xl(t.children,s,i,e);case Iy:a=8,s|=8;break;case Jg:return r=Vn(12,t,e,s|2),r.elementType=Jg,r.lanes=i,r;case Zg:return r=Vn(13,t,e,s),r.elementType=Zg,r.lanes=i,r;case ev:return r=Vn(19,t,e,s),r.elementType=ev,r.lanes=i,r;case C6:return _1(t,s,i,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k6:a=10;break e;case T6:a=9;break e;case Oy:a=11;break e;case Ny:a=14;break e;case pa:a=16,n=null;break e}throw Error(H(130,r==null?r:typeof r,""))}return e=Vn(a,t,e,s),e.elementType=r,e.type=n,e.lanes=i,e}function Xl(r,e,t,n){return r=Vn(7,r,n,e),r.lanes=t,r}function _1(r,e,t,n){return r=Vn(22,r,n,e),r.elementType=C6,r.lanes=t,r.stateNode={isHidden:!1},r}function gg(r,e,t){return r=Vn(6,r,null,e),r.lanes=t,r}function vg(r,e,t){return e=Vn(4,r.children!==null?r.children:[],r.key,e),e.lanes=t,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function XA(r,e,t,n,s){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q1(0),this.expirationTimes=Q1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q1(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function m2(r,e,t,n,s,i,a,o,l){return r=new XA(r,e,t,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vn(3,null,null,e),r.current=i,i.stateNode=r,i.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jy(i),r}function YA(r,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tu,key:n==null?null:""+n,children:r,containerInfo:e,implementation:t}}function w7(r){if(!r)return ho;r=r._reactInternals;e:{if(ou(r)!==r||r.tag!==1)throw Error(H(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(r.tag===1){var t=r.type;if(en(t))return wb(r,t,e)}return e}function b7(r,e,t,n,s,i,a,o,l){return r=m2(t,n,!0,r,s,i,a,o,l),r.context=w7(null),t=r.current,n=Or(),s=ao(t),i=Wi(n,s),i.callback=e??null,so(t,i,s),r.current.lanes=s,mf(r,s,n),tn(r,n),r}function x1(r,e,t,n){var s=e.current,i=Or(),a=ao(s);return t=w7(t),e.context===null?e.context=t:e.pendingContext=t,e=Wi(i,a),e.payload={element:r},n=n===void 0?null:n,n!==null&&(e.callback=n),r=so(s,e,a),r!==null&&(As(r,s,a,i),yp(r,s,a)),a}function Tm(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function y5(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var t=r.retryLane;r.retryLane=t!==0&&t<e?t:e}}function g2(r,e){y5(r,e),(r=r.alternate)&&y5(r,e)}function QA(){return null}var S7=typeof reportError=="function"?reportError:function(r){console.error(r)};function v2(r){this._internalRoot=r}A1.prototype.render=v2.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(H(409));x1(r,e,null,null)};A1.prototype.unmount=v2.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;eu(function(){x1(null,r,null,null)}),e[Zi]=null}};function A1(r){this._internalRoot=r}A1.prototype.unstable_scheduleHydration=function(r){if(r){var e=J6();r={blockedOn:null,target:r,priority:e};for(var t=0;t<va.length&&e!==0&&e<va[t].priority;t++);va.splice(t,0,r),t===0&&eb(r)}};function y2(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function E1(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function w5(){}function JA(r,e,t,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Tm(a);i.call(c)}}var a=b7(e,n,r,0,null,!1,!1,"",w5);return r._reactRootContainer=a,r[Zi]=a.current,x0(r.nodeType===8?r.parentNode:r),eu(),a}for(;s=r.lastChild;)r.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Tm(l);o.call(c)}}var l=m2(r,0,!1,null,null,!1,!1,"",w5);return r._reactRootContainer=l,r[Zi]=l.current,x0(r.nodeType===8?r.parentNode:r),eu(function(){x1(e,l,t,n)}),l}function k1(r,e,t,n,s){var i=t._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=Tm(a);o.call(l)}}x1(e,a,r,s)}else a=JA(t,e,r,s,n);return Tm(a)}Y6=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var t=Nh(e.pendingLanes);t!==0&&(Fy(e,t|1),tn(e,Et()),!(Oe&6)&&(lh=Et()+500,So()))}break;case 13:eu(function(){var n=ea(r,1);if(n!==null){var s=Or();As(n,r,1,s)}}),g2(r,1)}};zy=function(r){if(r.tag===13){var e=ea(r,134217728);if(e!==null){var t=Or();As(e,r,134217728,t)}g2(r,134217728)}};Q6=function(r){if(r.tag===13){var e=ao(r),t=ea(r,e);if(t!==null){var n=Or();As(t,r,e,n)}g2(r,e)}};J6=function(){return qe};Z6=function(r,e){var t=qe;try{return qe=r,e()}finally{qe=t}};cv=function(r,e,t){switch(e){case"input":if(nv(r,t),e=t.name,t.type==="radio"&&e!=null){for(t=r;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==r&&n.form===r.form){var s=g1(n);if(!s)throw Error(H(90));P6(n),nv(n,s)}}}break;case"textarea":I6(r,t);break;case"select":e=t.value,e!=null&&$u(r,!!t.multiple,e,!1)}};B6=h2;j6=eu;var ZA={usingClientEntryPoint:!1,Events:[vf,Iu,g1,F6,z6,h2]},kh={findFiberByHostInstance:jo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eE={bundleType:kh.bundleType,version:kh.version,rendererPackageName:kh.rendererPackageName,rendererConfig:kh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oa.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=H6(r),r===null?null:r.stateNode},findFiberByHostInstance:kh.findFiberByHostInstance||QA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qf.isDisabled&&qf.supportsFiber)try{d1=qf.inject(eE),ri=qf}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZA;Rn.createPortal=function(r,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y2(e))throw Error(H(200));return YA(r,e,null,t)};Rn.createRoot=function(r,e){if(!y2(r))throw Error(H(299));var t=!1,n="",s=S7;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=m2(r,1,!1,null,null,t,!1,n,s),r[Zi]=e.current,x0(r.nodeType===8?r.parentNode:r),new v2(e)};Rn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(H(188)):(r=Object.keys(r).join(","),Error(H(268,r)));return r=H6(e),r=r===null?null:r.stateNode,r};Rn.flushSync=function(r){return eu(r)};Rn.hydrate=function(r,e,t){if(!E1(e))throw Error(H(200));return k1(null,r,e,!0,t)};Rn.hydrateRoot=function(r,e,t){if(!y2(r))throw Error(H(405));var n=t!=null&&t.hydratedSources||null,s=!1,i="",a=S7;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=b7(e,null,r,1,t??null,s,!1,i,a),r[Zi]=e.current,x0(r),n)for(r=0;r<n.length;r++)t=n[r],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new A1(e)};Rn.render=function(r,e,t){if(!E1(e))throw Error(H(200));return k1(null,r,e,!1,t)};Rn.unmountComponentAtNode=function(r){if(!E1(r))throw Error(H(40));return r._reactRootContainer?(eu(function(){k1(null,null,r,!1,function(){r._reactRootContainer=null,r[Zi]=null})}),!0):!1};Rn.unstable_batchedUpdates=h2;Rn.unstable_renderSubtreeIntoContainer=function(r,e,t,n){if(!E1(t))throw Error(H(200));if(r==null||r._reactInternals===void 0)throw Error(H(38));return k1(r,e,t,!1,n)};Rn.version="18.3.1-next-f1338f8080-20240426";function _7(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_7)}catch(r){console.error(r)}}_7(),_6.exports=Rn;var tE=_6.exports,b5=tE;Yg.createRoot=b5.createRoot,Yg.hydrateRoot=b5.hydrateRoot;var Hv=function(r,e){return Hv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},Hv(r,e)};function x7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Hv(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Cm=function(){return Cm=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Cm.apply(this,arguments)};function ph(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function A7(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var o=r.length-1;o>=0;o--)(a=r[o])&&(i=(s<3?a(i):s>3?a(e,t,i):a(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function E7(r,e){return function(t,n){e(t,n,r)}}function k7(r,e,t,n,s,i){function a(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var o=n.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!e&&r?n.static?r:r.prototype:null,h=e||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d,f=!1,p=t.length-1;p>=0;p--){var g={};for(var w in n)g[w]=w==="access"?{}:n[w];for(var w in n.access)g.access[w]=n.access[w];g.addInitializer=function(y){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(y||null))};var x=(0,t[p])(o==="accessor"?{get:h.get,set:h.set}:h[l],g);if(o==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(d=a(x.get))&&(h.get=d),(d=a(x.set))&&(h.set=d),(d=a(x.init))&&s.unshift(d)}else(d=a(x))&&(o==="field"?s.unshift(d):h[l]=d)}c&&Object.defineProperty(c,n.name,h),f=!0}function T7(r,e,t){for(var n=arguments.length>2,s=0;s<e.length;s++)t=n?e[s].call(r,t):e[s].call(r);return n?t:void 0}function C7(r){return typeof r=="symbol"?r:"".concat(r)}function R7(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function P7(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function ie(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(n.next(h))}catch(d){a(d)}}function l(h){try{c(n.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):s(h.value).then(o,l)}c((n=n.apply(r,e||[])).next())})}function M7(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(h){return l([c,h])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(n=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(h){c=[6,h],s=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var T1=Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};function I7(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&T1(e,r,t)}function Rm(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function w2(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function O7(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(w2(arguments[e]));return r}function N7(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],a=0,o=i.length;a<o;a++,s++)n[s]=i[a];return n}function L7(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function uh(r){return this instanceof uh?(this.v=r,this):new uh(r)}function D7(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(p){return function(g){return Promise.resolve(g).then(p,d)}}function o(p,g){n[p]&&(s[p]=function(w){return new Promise(function(x,y){i.push([p,w,x,y])>1||l(p,w)})},g&&(s[p]=g(s[p])))}function l(p,g){try{c(n[p](g))}catch(w){f(i[0][3],w)}}function c(p){p.value instanceof uh?Promise.resolve(p.value.v).then(h,d):f(i[0][2],p)}function h(p){l("next",p)}function d(p){l("throw",p)}function f(p,g){p(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}function F7(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(a){return(t=!t)?{value:uh(r[s](a)),done:!1}:i?i(a):a}:i}}function z7(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Rm=="function"?Rm(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(a){return new Promise(function(o,l){a=r[i](a),s(o,l,a.done,a.value)})}}function s(i,a,o,l){Promise.resolve(l).then(function(c){i({value:c,done:o})},a)}}function B7(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var rE=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},qv=function(r){return qv=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},qv(r)};function j7(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=qv(r),n=0;n<t.length;n++)t[n]!=="default"&&T1(e,r,t[n]);return rE(e,r),e}function $7(r){return r&&r.__esModule?r:{default:r}}function U7(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function H7(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}function q7(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function V7(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}var nE=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};function G7(r){function e(i){r.error=r.hasError?new nE(i,r.error,"An error was suppressed during disposal."):i,r.hasError=!0}var t,n=0;function s(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(s);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(i).then(s,function(a){return e(a),s()})}else n|=1}catch(a){e(a)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return s()}function W7(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,s,i,a){return n?e?".jsx":".js":s&&(!i||!a)?t:s+i+"."+a.toLowerCase()+"js"}):r}const sE={__extends:x7,__assign:Cm,__rest:ph,__decorate:A7,__param:E7,__esDecorate:k7,__runInitializers:T7,__propKey:C7,__setFunctionName:R7,__metadata:P7,__awaiter:ie,__generator:M7,__createBinding:T1,__exportStar:I7,__values:Rm,__read:w2,__spread:O7,__spreadArrays:N7,__spreadArray:L7,__await:uh,__asyncGenerator:D7,__asyncDelegator:F7,__asyncValues:z7,__makeTemplateObject:B7,__importStar:j7,__importDefault:$7,__classPrivateFieldGet:U7,__classPrivateFieldSet:H7,__classPrivateFieldIn:q7,__addDisposableResource:V7,__disposeResources:G7,__rewriteRelativeImportExtension:W7},iE=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:V7,get __assign(){return Cm},__asyncDelegator:F7,__asyncGenerator:D7,__asyncValues:z7,__await:uh,__awaiter:ie,__classPrivateFieldGet:U7,__classPrivateFieldIn:q7,__classPrivateFieldSet:H7,__createBinding:T1,__decorate:A7,__disposeResources:G7,__esDecorate:k7,__exportStar:I7,__extends:x7,__generator:M7,__importDefault:$7,__importStar:j7,__makeTemplateObject:B7,__metadata:P7,__param:E7,__propKey:C7,__read:w2,__rest:ph,__rewriteRelativeImportExtension:W7,__runInitializers:T7,__setFunctionName:R7,__spread:O7,__spreadArray:L7,__spreadArrays:N7,__values:Rm,default:sE},Symbol.toStringTag,{value:"Module"})),aE=r=>r?(...e)=>r(...e):(...e)=>fetch(...e);class b2 extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class oE extends b2{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class S5 extends b2{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class _5 extends b2{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Vv;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Vv||(Vv={}));class lE{constructor(e,{headers:t={},customFetch:n,region:s=Vv.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=aE(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ie(this,arguments,void 0,function*(t,n={}){var s;let i,a;try{const{headers:o,method:l,body:c,signal:h,timeout:d}=n;let f={},{region:p}=n;p||(p=this.region);const g=new URL(`${this.url}/${t}`);p&&p!=="any"&&(f["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let w;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",w=c):typeof c=="string"?(f["Content-Type"]="text/plain",w=c):typeof FormData<"u"&&c instanceof FormData?w=c:(f["Content-Type"]="application/json",w=JSON.stringify(c)):w=c;let x=h;d&&(a=new AbortController,i=setTimeout(()=>a.abort(),d),h?(x=a.signal,h.addEventListener("abort",()=>a.abort())):x=a.signal);const y=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:w,signal:x}).catch(R=>{throw new oE(R)}),b=y.headers.get("x-relay-error");if(b&&b==="true")throw new S5(y);if(!y.ok)throw new _5(y);let _=((s=y.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),C;return _==="application/json"?C=yield y.json():_==="application/octet-stream"||_==="application/pdf"?C=yield y.blob():_==="text/event-stream"?C=y:_==="multipart/form-data"?C=yield y.formData():C=yield y.text(),{data:C,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof _5||o instanceof S5?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var Mr={};const mh=Cx(iE);var Vf={},Gf={},Wf={},Kf={},Xf={},Yf={},x5;function K7(){if(x5)return Yf;x5=1,Object.defineProperty(Yf,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Yf.default=r,Yf}var A5;function X7(){if(A5)return Xf;A5=1,Object.defineProperty(Xf,"__esModule",{value:!0});const e=mh.__importDefault(K7());class t{constructor(s){var i,a;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(a=s.isMaybeSingle)!==null&&a!==void 0?a:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,h,d,f;let p=null,g=null,w=null,x=l.status,y=l.statusText;if(l.ok){if(this.method!=="HEAD"){const R=await l.text();R===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?g=R:g=JSON.parse(R))}const _=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),C=(d=l.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");_&&C&&C.length>1&&(w=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,w=null,x=406,y="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await l.text();try{p=JSON.parse(_),Array.isArray(p)&&l.status===404&&(g=[],p=null,x=200,y="OK")}catch{l.status===404&&_===""?(x=204,y="No Content"):p={message:_}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,x=200,y="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:g,count:w,status:x,statusText:y}});return this.shouldThrowOnError||(o=o.catch(l=>{var c,h,d;return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(h=l==null?void 0:l.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=l==null?void 0:l.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),o.then(s,i)}returns(){return this}overrideTypes(){return this}}return Xf.default=t,Xf}var E5;function Y7(){if(E5)return Kf;E5=1,Object.defineProperty(Kf,"__esModule",{value:!0});const e=mh.__importDefault(X7());class t extends e.default{select(s){let i=!1;const a=(s??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",h=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${h?`${h},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var h;const d=[s?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${f}"; options=${d};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Kf.default=t,Kf}var k5;function S2(){if(k5)return Wf;k5=1,Object.defineProperty(Wf,"__esModule",{value:!0});const e=mh.__importDefault(Y7()),t=new RegExp("[,()]");class n extends e.default{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&t.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(i,`in.(${o})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const h=o===void 0?"":`(${o})`;return this.url.searchParams.append(i,`${c}fts${h}.${a}`),this}match(i){return Object.entries(i).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(i,a,o){return this.url.searchParams.append(i,`not.${a}.${o}`),this}or(i,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${i})`),this}filter(i,a,o){return this.url.searchParams.append(i,`${a}.${o}`),this}}return Wf.default=n,Wf}var T5;function Q7(){if(T5)return Gf;T5=1,Object.defineProperty(Gf,"__esModule",{value:!0});const e=mh.__importDefault(S2());class t{constructor(s,{headers:i={},schema:a,fetch:o}){this.url=s,this.headers=new Headers(i),this.schema=a,this.fetch=o}select(s,i){const{head:a=!1,count:o}=i??{},l=a?"HEAD":"GET";let c=!1;const h=(s??"*").split("").map(d=>/\s/.test(d)&&!c?"":(d==='"'&&(c=!c),d)).join("");return this.url.searchParams.set("select",h),o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:a=!0}={}){var o;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const c=s.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var c;const h="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(d.length>0){const f=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(s,{count:i}={}){var a;const o="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:s}={}){var i;const a="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Gf.default=t,Gf}var C5;function uE(){if(C5)return Vf;C5=1,Object.defineProperty(Vf,"__esModule",{value:!0});const r=mh,e=r.__importDefault(Q7()),t=r.__importDefault(S2());class n{constructor(i,{headers:a={},schema:o,fetch:l}={}){this.url=i,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:o=!1,get:l=!1,count:c}={}){var h;let d;const f=new URL(`${this.url}/rpc/${i}`);let p;o||l?(d=o?"HEAD":"GET",Object.entries(a).filter(([w,x])=>x!==void 0).map(([w,x])=>[w,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([w,x])=>{f.searchParams.append(w,x)})):(d="POST",p=a);const g=new Headers(this.headers);return c&&g.set("Prefer",`count=${c}`),new t.default({method:d,url:f,headers:g,schema:this.schemaName,body:p,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Vf.default=n,Vf}Object.defineProperty(Mr,"__esModule",{value:!0});var J7=Mr.PostgrestError=l8=Mr.PostgrestBuilder=a8=Mr.PostgrestTransformBuilder=s8=Mr.PostgrestFilterBuilder=r8=Mr.PostgrestQueryBuilder=e8=Mr.PostgrestClient=void 0;const gh=mh,Z7=gh.__importDefault(uE());var e8=Mr.PostgrestClient=Z7.default;const t8=gh.__importDefault(Q7());var r8=Mr.PostgrestQueryBuilder=t8.default;const n8=gh.__importDefault(S2());var s8=Mr.PostgrestFilterBuilder=n8.default;const i8=gh.__importDefault(Y7());var a8=Mr.PostgrestTransformBuilder=i8.default;const o8=gh.__importDefault(X7());var l8=Mr.PostgrestBuilder=o8.default;const u8=gh.__importDefault(K7());J7=Mr.PostgrestError=u8.default;var c8=Mr.default={PostgrestClient:Z7.default,PostgrestQueryBuilder:t8.default,PostgrestFilterBuilder:n8.default,PostgrestTransformBuilder:i8.default,PostgrestBuilder:o8.default,PostgrestError:u8.default};const cE=kx({__proto__:null,get PostgrestBuilder(){return l8},get PostgrestClient(){return e8},get PostgrestError(){return J7},get PostgrestFilterBuilder(){return s8},get PostgrestQueryBuilder(){return r8},get PostgrestTransformBuilder(){return a8},default:c8},[Mr]),{PostgrestClient:hE,PostgrestQueryBuilder:aI,PostgrestFilterBuilder:oI,PostgrestTransformBuilder:lI,PostgrestBuilder:uI,PostgrestError:cI}=c8||cE;class dE{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const fE="2.81.0",pE=`realtime-js/${fE}`,h8="1.0.0",mE="2.0.0",R5=h8,Gv=1e4,gE=1e3,vE=100;var Lo;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Lo||(Lo={}));var Dt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Dt||(Dt={}));var jn;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(jn||(jn={}));var Wv;(function(r){r.websocket="websocket"})(Wv||(Wv={}));var Do;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Do||(Do={}));class yE{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodePush(e){const{join_ref:t,ref:n,event:s,topic:i,payload:a}=e,o=this.META_LENGTH+t.length+n.length+i.length+s.length,l=new ArrayBuffer(this.HEADER_LENGTH+o);let c=new DataView(l),h=0;c.setUint8(h++,this.KINDS.push),c.setUint8(h++,t.length),c.setUint8(h++,n.length),c.setUint8(h++,i.length),c.setUint8(h++,s.length),Array.from(t,f=>c.setUint8(h++,f.charCodeAt(0))),Array.from(n,f=>c.setUint8(h++,f.charCodeAt(0))),Array.from(i,f=>c.setUint8(h++,f.charCodeAt(0))),Array.from(s,f=>c.setUint8(h++,f.charCodeAt(0)));var d=new Uint8Array(l.byteLength+a.byteLength);return d.set(new Uint8Array(l),0),d.set(new Uint8Array(a),l.byteLength),d.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const{join_ref:s,ref:i,topic:a}=e,o=e.payload.event,l=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0),c=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+i.length+a.length+o.length,h=new ArrayBuffer(this.HEADER_LENGTH+c);let d=new DataView(h),f=0;d.setUint8(f++,this.KINDS.userBroadcastPush),d.setUint8(f++,s.length),d.setUint8(f++,i.length),d.setUint8(f++,a.length),d.setUint8(f++,o.length),d.setUint8(f++,this.BINARY_ENCODING),Array.from(s,g=>d.setUint8(f++,g.charCodeAt(0))),Array.from(i,g=>d.setUint8(f++,g.charCodeAt(0))),Array.from(a,g=>d.setUint8(f++,g.charCodeAt(0))),Array.from(o,g=>d.setUint8(f++,g.charCodeAt(0)));var p=new Uint8Array(h.byteLength+l.byteLength);return p.set(new Uint8Array(h),0),p.set(new Uint8Array(l),h.byteLength),p.buffer}_encodeJsonUserBroadcastPush(e){var t,n;const{join_ref:s,ref:i,topic:a}=e,o=e.payload.event,l=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},h=new TextEncoder().encode(JSON.stringify(l)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+i.length+a.length+o.length,f=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(f),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,s.length),p.setUint8(g++,i.length),p.setUint8(g++,a.length),p.setUint8(g++,o.length),p.setUint8(g++,this.JSON_ENCODING),Array.from(s,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(i,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(a,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(g++,x.charCodeAt(0)));var w=new Uint8Array(f.byteLength+h.byteLength);return w.set(new Uint8Array(f),0),w.set(new Uint8Array(h),f.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,i,a,o,l]=n;return t({join_ref:s,ref:i,topic:a,event:o,payload:l})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,n){const s=t.getUint8(1),i=t.getUint8(2),a=t.getUint8(3);let o=this.HEADER_LENGTH+this.META_LENGTH-1;const l=n.decode(e.slice(o,o+s));o=o+s;const c=n.decode(e.slice(o,o+i));o=o+i;const h=n.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{join_ref:l,ref:null,topic:c,event:h,payload:d}}_decodeReply(e,t,n){const s=t.getUint8(1),i=t.getUint8(2),a=t.getUint8(3),o=t.getUint8(4);let l=this.HEADER_LENGTH+this.META_LENGTH;const c=n.decode(e.slice(l,l+s));l=l+s;const h=n.decode(e.slice(l,l+i));l=l+i;const d=n.decode(e.slice(l,l+a));l=l+a;const f=n.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(n.decode(e.slice(l,e.byteLength))),g={status:f,response:p};return{join_ref:c,ref:h,topic:d,event:jn.reply,payload:g}}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+s));a=a+s;const l=n.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{join_ref:null,ref:null,topic:o,event:l,payload:c}}_decodeUserBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2),a=t.getUint8(3),o=t.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(e.slice(l,l+s));l=l+s;const h=n.decode(e.slice(l,l+i));l=l+i;const d=n.decode(e.slice(l,l+a));l=l+a;const f=e.slice(l,e.byteLength),p=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,g={type:this.BROADCAST,event:h,payload:p};return a>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST,payload:g}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class d8{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Qe;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Qe||(Qe={}));const P5=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=wE(a,r,e,s),i),{}):{}},wE=(r,e,t,n)=>{const s=e.find(o=>o.name===r),i=s==null?void 0:s.type,a=t[r];return i&&!n.includes(i)?f8(i,a):Kv(a)},f8=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return xE(e,t)}switch(r){case Qe.bool:return bE(e);case Qe.float4:case Qe.float8:case Qe.int2:case Qe.int4:case Qe.int8:case Qe.numeric:case Qe.oid:return SE(e);case Qe.json:case Qe.jsonb:return _E(e);case Qe.timestamp:return AE(e);case Qe.abstime:case Qe.date:case Qe.daterange:case Qe.int4range:case Qe.int8range:case Qe.money:case Qe.reltime:case Qe.text:case Qe.time:case Qe.timestamptz:case Qe.timetz:case Qe.tsrange:case Qe.tstzrange:return Kv(e);default:return Kv(e)}},Kv=r=>r,bE=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},SE=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},_E=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},xE=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>f8(e,o))}return r},AE=r=>typeof r=="string"?r.replace(" ","T"):r,p8=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class yg{constructor(e,t,n={},s=Gv){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var M5;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(M5||(M5={}));class u0{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=u0.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=u0.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=u0.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const d=i[c];if(d){const f=h.map(x=>x.presence_ref),p=d.map(x=>x.presence_ref),g=h.filter(x=>p.indexOf(x.presence_ref)<0),w=d.filter(x=>f.indexOf(x.presence_ref)<0);g.length>0&&(o[c]=g),w.length>0&&(l[c]=w)}else o[c]=h}),this.syncDiff(i,{joins:o,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const d=e[o].map(p=>p.presence_ref),f=h.filter(p=>d.indexOf(p.presence_ref)<0);e[o].unshift(...f)}n(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),e[o]=c,s(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var I5;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(I5||(I5={}));var c0;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(c0||(c0={}));var pi;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(pi||(pi={}));class _2{constructor(e,t={config:{}},n){var s,i;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new yg(this,jn.join,this.params,this.timeout),this.rejoinTimer=new d8(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jn.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new u0(this),this.broadcastEndpointURL=p8(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Dt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[c0.PRESENCE]&&this.bindings[c0.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:h}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(pi.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(pi.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e==null||e(pi.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,x=(g=w==null?void 0:w.length)!==null&&g!==void 0?g:0,y=[];for(let b=0;b<x;b++){const _=w[b],{filter:{event:C,schema:R,table:I,filter:O}}=_,D=p&&p[b];if(D&&D.event===C&&D.schema===R&&D.table===I&&D.filter===O)y.push(Object.assign(Object.assign({},_),{id:D.id}));else{this.unsubscribe(),this.state=Dt.errored,e==null||e(pi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(pi.SUBSCRIBED);return}}).receive("error",p=>{this.state=Dt.errored,e==null||e(pi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Dt.joined&&e===c0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Dt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new yg(this,jn.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Dt.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new yg(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>vE){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=jn;if(n&&[o,l,c,h].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,w,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(w=p.filter)===null||w===void 0?void 0:w.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(f,n)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var g,w,x,y,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const C=p.id,R=(g=p.filter)===null||g===void 0?void 0:g.event;return C&&((w=t.ids)===null||w===void 0?void 0:w.includes(C))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const C=(b=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return C==="*"||C===((_=t==null?void 0:t.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:w,table:x,commit_timestamp:y,type:b,errors:_}=g;f=Object.assign(Object.assign({},{schema:w,table:x,commit_timestamp:y,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(g))}p.callback(f,n)})}_isClosed(){return this.state===Dt.closed}_isJoined(){return this.state===Dt.joined}_isJoining(){return this.state===Dt.joining}_isLeaving(){return this.state===Dt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&_2.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(jn.close,{},e)}_onError(e){this._on(jn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=P5(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=P5(e.columns,e.old_record)),t}}const wg=()=>{},Qf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},EE=[1e3,2e3,5e3,1e4],kE=1e4,TE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class CE{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gv,this.transport=null,this.heartbeatIntervalMs=Qf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=wg,this.ref=0,this.reconnectTimer=null,this.vsn=R5,this.logger=wg,this.conn=null,this.sendBuffer=[],this.serializer=new yE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Wv.websocket}`,this.httpEndpoint=p8(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=dE.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Lo.connecting:return Do.Connecting;case Lo.open:return Do.Open;case Lo.closing:return Do.Closing;default:return Do.Closed}}isConnected(){return this.connectionState()===Do.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new _2(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(gE,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Qf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:a}=t,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${s} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Lo.open||this.conn.readyState===Lo.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(jn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([TE],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:pE};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(jn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new d8(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,i,a,o,l,c,h,d,f,p;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Gv,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Qf.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:wg,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:R5,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:g=>EE[g-1]||kE,this.vsn){case h8:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(g,w)=>w(JSON.stringify(g)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:(g,w)=>w(JSON.parse(g));break;case mE:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class x2 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ft(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class RE extends x2{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Xv extends x2{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const A2=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),PE=()=>Response,Yv=r=>{if(Array.isArray(r))return r.map(t=>Yv(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Yv(n)}),e},ME=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},bg=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},IE=(r,e,t)=>ie(void 0,void 0,void 0,function*(){const n=yield PE();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{const i=r.status||500,a=(s==null?void 0:s.statusCode)||i+"";e(new RE(bg(s),i,a))}).catch(s=>{e(new Xv(bg(s),s))}):e(new Xv(bg(r),r))}),OE=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!n?s:(ME(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function wf(r,e,t,n,s,i){return ie(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,OE(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>IE(l,o,n))})})}function I0(r,e,t,n){return ie(this,void 0,void 0,function*(){return wf(r,"GET",e,t,n)})}function is(r,e,t,n,s){return ie(this,void 0,void 0,function*(){return wf(r,"POST",e,n,s,t)})}function Qv(r,e,t,n,s){return ie(this,void 0,void 0,function*(){return wf(r,"PUT",e,n,s,t)})}function NE(r,e,t,n){return ie(this,void 0,void 0,function*(){return wf(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function E2(r,e,t,n,s){return ie(this,void 0,void 0,function*(){return wf(r,"DELETE",e,n,s,t)})}class LE{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return ie(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ft(e))return{data:null,error:e};throw e}})}}var m8;class DE{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[m8]="BlobDownloadBuilder",this.promise=null}asStream(){return new LE(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ie(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ft(e))return{data:null,error:e};throw e}})}}m8=Symbol.toStringTag;const FE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},O5={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zE{constructor(e,t={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=A2(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,s){return ie(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},O5),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),l&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),d=yield(e=="PUT"?Qv:is)(this.fetch,`${this.url}/object/${h}`,i,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ft(i))return{data:null,error:i};throw i}})}upload(e,t,n){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return ie(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:O5.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const d=yield Qv(this.fetch,o.toString(),l,{headers:h});return{data:{path:i,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ie(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield is(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new x2("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}update(e,t,n){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return ie(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}copy(e,t,n){return ie(this,void 0,void 0,function*(){try{return{data:{path:(yield is(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return ie(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield is(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return ie(this,void 0,void 0,function*(){try{const s=yield is(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"",o=this._getFinalPath(e),l=()=>I0(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new DE(l,this.shouldThrowOnError)}info(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield I0(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Yv(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}exists(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield NE(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n)&&n instanceof Xv){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(e){return ie(this,void 0,void 0,function*(){try{return{data:yield E2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}list(e,t,n){return ie(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},FE),t),{prefix:e||""});return{data:yield is(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}listV2(e,t){return ie(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield is(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const g8="2.81.0",v8={"X-Client-Info":`storage-js/${g8}`};class BE{constructor(e,t={},n,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},v8),t),this.fetch=A2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return ie(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield I0(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}getBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield I0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}createBucket(e){return ie(this,arguments,void 0,function*(t,n={public:!1}){try{return{data:yield is(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return ie(this,void 0,void 0,function*(){try{return{data:yield Qv(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ft(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield E2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class jE{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},v8),t),this.fetch=A2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}listBuckets(e){return ie(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const n=t.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield I0(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield E2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}}const k2={"X-Client-Info":`storage-js/${g8}`,"Content-Type":"application/json"};class y8 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function bn(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}class Sg extends y8{constructor(e,t,n){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class $E extends y8{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var N5;(function(r){r.InternalError="InternalError",r.S3VectorConflictException="S3VectorConflictException",r.S3VectorNotFoundException="S3VectorNotFoundException",r.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",r.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",r.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(N5||(N5={}));const T2=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),UE=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},L5=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),HE=(r,e,t)=>ie(void 0,void 0,void 0,function*(){if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!(t!=null&&t.noResolveJson)){const s=r.status||500,i=r;if(typeof i.json=="function")i.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";e(new Sg(L5(a),s,o))}).catch(()=>{const a=s+"",o=i.statusText||`HTTP ${s} error`;e(new Sg(o,s,a))});else{const a=s+"",o=i.statusText||`HTTP ${s} error`;e(new Sg(o,s,a))}}else e(new $E(L5(r),r))}),qE=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return n?(UE(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),t)):s};function VE(r,e,t,n,s,i){return ie(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,qE(e,n,s,i)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>HE(l,o,n))})})}function Sn(r,e,t,n,s){return ie(this,void 0,void 0,function*(){return VE(r,"POST",e,n,s,t)})}class GE{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},k2),t),this.fetch=T2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}getIndex(e,t){return ie(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(bn(n))return{data:null,error:n};throw n}})}listIndexes(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return ie(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(bn(n))return{data:null,error:n};throw n}})}}class WE{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},k2),t),this.fetch=T2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Sn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}getVectors(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}listVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Sn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}queryVectors(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}deleteVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Sn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}}class KE{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},k2),t),this.fetch=T2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}getBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}listBuckets(){return ie(this,arguments,void 0,function*(e={}){try{return{data:yield Sn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(bn(t))return{data:null,error:t};throw t}})}}class XE extends KE{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new YE(this.url,this.headers,e,this.fetch)}}class YE extends GE{constructor(e,t,n,s){super(e,t,s),this.vectorBucketName=n}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ie(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ie(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ie(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ie(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new QE(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class QE extends WE{constructor(e,t,n,s,i){super(e,t,i),this.vectorBucketName=n,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ie(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ie(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ie(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ie(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ie(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class JE extends BE{constructor(e,t={},n,s){super(e,t,n,s)}from(e){return new zE(this.url,this.headers,e,this.fetch)}get vectors(){return new XE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jE(this.url+"/iceberg",this.headers,this.fetch)}}const ZE="2.81.0";let Dh="";typeof Deno<"u"?Dh="deno":typeof document<"u"?Dh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Dh="react-native":Dh="node";const ek={"X-Client-Info":`supabase-js-${Dh}/${ZE}`},tk={headers:ek},rk={schema:"public"},nk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sk={},ik=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),ak=()=>Headers,ok=(r,e,t)=>{const n=ik(t),s=ak();return async(i,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:r;let c=new s(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},a),{headers:c}))}};function lk(r){return r.endsWith("/")?r:r+"/"}function uk(r,e){var t,n;const{db:s,auth:i,realtime:a,global:o}=r,{db:l,auth:c,realtime:h,global:d}=e,f={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},h),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(t=d==null?void 0:d.headers)!==null&&t!==void 0?t:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}function ck(r){const e=r==null?void 0:r.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(lk(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const w8="2.81.0",yu=30*1e3,Jv=3,_g=Jv*yu,hk="http://localhost:9999",dk="supabase.auth.token",fk={"X-Client-Info":`gotrue-js/${w8}`},Zv="X-Supabase-Api-Version",b8={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,mk=10*60*1e3;class O0 extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ce(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class gk extends O0{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function vk(r){return ce(r)&&r.name==="AuthApiError"}class Fo extends O0{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class _o extends O0{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class ts extends _o{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yk(r){return ce(r)&&r.name==="AuthSessionMissingError"}class hu extends _o{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jf extends _o{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Zf extends _o{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wk(r){return ce(r)&&r.name==="AuthImplicitGrantRedirectError"}class D5 extends _o{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e4 extends _o{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function xg(r){return ce(r)&&r.name==="AuthRetryableFetchError"}class F5 extends _o{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class t4 extends _o{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),z5=` 	
\r=`.split(""),bk=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<z5.length;e+=1)r[z5[e].charCodeAt(0)]=-2;for(let e=0;e<Pm.length;e+=1)r[Pm[e].charCodeAt(0)]=e;return r})();function B5(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Pm[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Pm[n]),e.queuedBits-=6}}function S8(r,e,t){const n=bk[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function j5(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{xk(a,n,t)};for(let a=0;a<r.length;a+=1)S8(r.charCodeAt(a),s,i);return e.join("")}function Sk(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function _k(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Sk(n,e)}}function xk(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Wu(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)S8(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Ak(r){const e=[];return _k(r,t=>e.push(t)),new Uint8Array(e)}function Ho(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>B5(s,t,n)),B5(null,t,n),e.join("")}function Ek(r){return Math.round(Date.now()/1e3)+r}function kk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const fr=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},_8=()=>{if(!fr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function Tk(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const x8=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),Ck=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",wu=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ko=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ca=async(r,e)=>{await r.removeItem(e)};class C1{constructor(){this.promise=new C1.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}C1.promiseConstructor=Promise;function Ag(r){const e=r.split(".");if(e.length!==3)throw new t4("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!pk.test(e[n]))throw new t4("JWT not in base64url format");return{header:JSON.parse(j5(e[0])),payload:JSON.parse(j5(e[1])),signature:Wu(e[2]),raw:{header:e[0],payload:e[1]}}}async function Rk(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Pk(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function Mk(r){return("0"+r.toString(16)).substr(-2)}function Ik(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Mk).join("")}async function Ok(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Nk(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Ok(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function du(r,e,t=!1){const n=Ik();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await wu(r,`${e}-code-verifier`,s);const i=await Nk(n);return[i,n===i?"plain":"s256"]}const Lk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Dk(r){const e=r.headers.get(Zv);if(!e||!e.match(Lk))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Fk(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function zk(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Bk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fu(r){if(!Bk.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Eg(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jk(r,e){return new Proxy(r,{get:(t,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,s)}})}function $5(r){return JSON.parse(JSON.stringify(r))}const Mo=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),$k=[502,503,504];async function U5(r){var e;if(!Ck(r))throw new e4(Mo(r),0);if($k.includes(r.status))throw new e4(Mo(r),r.status);let t;try{t=await r.json()}catch(i){throw new Fo(Mo(i),i)}let n;const s=Dk(r);if(s&&s.getTime()>=b8["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new F5(Mo(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new ts}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new F5(Mo(t),r.status,t.weak_password.reasons);throw new gk(Mo(t),r.status||500,n)}const Uk=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function we(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Zv]||(i[Zv]=b8["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Hk(r,e,t+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Hk(r,e,t,n,s,i){const a=Uk(e,n,s,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new e4(Mo(l),0)}if(o.ok||await U5(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await U5(l)}}function rs(r){var e;let t=null;Gk(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Ek(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function H5(r){const e=rs(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function wa(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function qk(r){return{data:r,error:null}}function Vk(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,a=ph(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function q5(r){return r}function Gk(r){return r.access_token&&r.refresh_token&&r.expires_in}const kg=["global","local","others"];class Wk{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=x8(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=kg[0]){if(kg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kg.join(", ")}`);try{return await we(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await we(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:wa})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=ph(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await we(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Vk,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ce(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await we(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:wa})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await we(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:q5});if(h.error)throw h.error;const d=await h.json(),f=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const w=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);c[`${x}Page`]=w}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ce(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){fu(e);try{return await we(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:wa})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){fu(e);try{return await we(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:wa})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){fu(e);try{return await we(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:wa})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){fu(e.userId);try{const{data:t,error:n}=await we(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _deleteFactor(e){fu(e.userId),fu(e.id);try{return{data:await we(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await we(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:q5});if(h.error)throw h.error;const d=await h.json(),f=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const w=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);c[`${x}Page`]=w}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ce(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await we(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await we(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await we(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await we(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}}function V5(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const pu={debug:!!(globalThis&&_8()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class A8 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Kk extends A8{}async function Xk(r,e,t){pu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),pu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){pu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{pu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw pu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Kk(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(pu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function Yk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function E8(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function Qk(r){return parseInt(r,16)}function Jk(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function Zk(r){var e;const{chainId:t,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:h,uri:d,version:f}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const p=E8(r.address),g=h?`${h}://${n}`:n,w=r.statement?`${r.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${w}`;let y=`URI: ${d}
Version: ${f}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),c){let b=`
Resources:`;for(const _ of c){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);b+=`
- ${_}`}y+=b}return`${x}
${y}`}class Pt extends Error{constructor({message:e,code:t,cause:n,name:s}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class Mm extends Pt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function eT({error:r,options:e}){var t,n,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Pt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Pt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Pt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new Pt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new Pt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Pt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new Pt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const a=window.location.hostname;if(k8(a)){if(i.rp.id!==a)return new Pt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Pt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new Pt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function tT({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new Pt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const n=window.location.hostname;if(k8(n)){if(t.rpId!==n)return new Pt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new Pt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class rT{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const nT=new rT;function sT(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:n}=r,s=ph(r,["challenge","user","excludeCredentials"]),i=Wu(e).buffer,a=Object.assign(Object.assign({},t),{id:Wu(t.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:i,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Wu(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function iT(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,n=ph(r,["challenge","allowCredentials"]),s=Wu(e).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const o=t[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Wu(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function aT(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ho(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ho(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function oT(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,n=r.getClientExtensionResults(),s=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ho(new Uint8Array(s.authenticatorData)),clientDataJSON:Ho(new Uint8Array(s.clientDataJSON)),signature:Ho(new Uint8Array(s.signature)),userHandle:s.userHandle?Ho(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function k8(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function G5(){var r,e;return!!(fr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function lT(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Mm("Browser returned unexpected credential type",e)}:{data:null,error:new Mm("Empty credential response",e)}}catch(e){return{data:null,error:eT({error:e,options:r})}}}async function uT(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Mm("Browser returned unexpected credential type",e)}:{data:null,error:new Mm("Empty credential response",e)}}catch(e){return{data:null,error:tT({error:e,options:r})}}}const cT={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},hT={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Im(...r){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of r)if(s)for(const i in s){const a=s[i];if(a!==void 0)if(Array.isArray(a))n[i]=a;else if(t(a))n[i]=a;else if(e(a)){const o=n[i];e(o)?n[i]=Im(o,a):n[i]=Im(a)}else n[i]=a}return n}function dT(r,e){return Im(cT,r,e||{})}function fT(r,e){return Im(hT,r,e||{})}class pT{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:s},i){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:o};const l=s??nT.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=dT(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:d}=await lT({publicKey:c,signal:l});return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const c=fT(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:d}=await uT(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new Fo("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new O0("rpId is required for WebAuthn authentication")};try{if(!G5())return{data:null,error:new Fo("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:s},{request:i});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new Fo("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new O0("rpId is required for WebAuthn registration")};try{if(!G5())return{data:null,error:new Fo("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(h=>{var d;return(d=h.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:s},{create:i});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new Fo("Unexpected error in register",a)}}}}Yk();const mT={url:hk,storageKey:dk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:fk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function W5(r,e,t){return await t()}const mu={};class N0{get jwks(){var e,t;return(t=(e=mu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){mu[this.storageKey]=Object.assign(Object.assign({},mu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=mu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){mu[this.storageKey]=Object.assign(Object.assign({},mu[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},mT),e);if(this.storageKey=i.storageKey,this.instanceID=(t=N0.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,N0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&fr()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Wk({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=x8(i.fetch),this.lock=i.lock||W5,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:fr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Xk:this.lock=W5,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new pT(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:_8()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=V5(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=V5(this.memoryStorage)),fr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${w8}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(fr()&&(t=Tk(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),fr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),wk(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ce(t)?this._returnResult({error:t}):this._returnResult({error:new Fo("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:rs}),{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:h,password:d,options:f}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await du(this.storage,this.storageKey)),i=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:rs})}else if("phone"in e){const{phone:h,password:d,options:f}=e;i=await we(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:rs})}else throw new Jf("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H5})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await we(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:H5})}else throw new Jf("You must provide either an email or phone number and a password");const{data:n,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new hu;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,s,i,a,o,l,c,h,d,f;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:w,wallet:x,statement:y,options:b}=e;let _;if(fr())if(typeof x=="object")_=x;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")_=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const C=new URL((t=b==null?void 0:b.url)!==null&&t!==void 0?t:window.location.href),R=await _.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=E8(R[0]);let O=(n=b==null?void 0:b.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!O){const B=await _.request({method:"eth_chainId"});O=Qk(B)}const D={domain:C.host,address:I,statement:y,uri:C.href,version:"1",chainId:O,nonce:(s=b==null?void 0:b.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(i=b==null?void 0:b.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=b==null?void 0:b.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=b==null?void 0:b.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=b==null?void 0:b.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(h=b==null?void 0:b.signInWithEthereum)===null||h===void 0?void 0:h.resources};p=Zk(D),g=await _.request({method:"personal_sign",params:[Jk(p),I]})}try{const{data:w,error:x}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:rs});if(x)throw x;if(!w||!w.session||!w.user){const y=new hu;return this._returnResult({data:{user:null,session:null},error:y})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:x})}catch(w){if(ce(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var t,n,s,i,a,o,l,c,h,d,f,p;let g,w;if("message"in e)g=e.message,w=e.signature;else{const{chain:x,wallet:y,statement:b,options:_}=e;let C;if(fr())if(typeof y=="object")C=y;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))C=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=y}const R=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const I=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),b?{statement:b}:null));let O;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")O=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)O=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)g=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),w=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${R.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((d=(h=_==null?void 0:_.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",..._.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const I=await C.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=I}}try{const{data:x,error:y}=await we(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Ho(w)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:rs});if(y)throw y;if(!x||!x.session||!x.user){const b=new hu;return this._returnResult({data:{user:null,session:null},error:b})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:y})}catch(x){if(ce(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const t=await ko(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:a}=await we(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:rs});if(await ca(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const o=new hu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(ce(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:a}=e,o=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:rs}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const h=new hu;return this._returnResult({data:{user:null,session:null},error:h})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await du(this.storage,this.storageKey));const{error:d}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await we(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h})}throw new Jf("You must provide either an email or phone number.")}catch(o){if(ce(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await we(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:rs});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,a=null;this.flowType==="pkce"&&([i,a]=await du(this.storage,this.storageKey));const o=await we(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:qk});return this._returnResult(o)}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new ts;const{error:s}=await we(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(ce(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:a}=await we(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:a,error:o}=await we(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new Jf("You must provide either an email or phone number and a type")}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ko(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<_g:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await ko(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Eg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=jk(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:wa}):await this._useSession(async t=>{var n,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ts}:await we(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:wa})})}catch(t){if(ce(t))return yk(t)&&(await this._removeSession(),await ca(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new ts;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await du(this.storage,this.storageKey));const{data:c,error:h}=await we(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:wa});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(ce(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ts;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:a}=Ag(e.access_token);if(a.exp&&(n=a.exp,s=n<=t),s){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(ce(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new ts;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!fr())throw new Zf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Zf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new D5("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zf("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new D5("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new Zf("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(o);let f=h+d;l&&(f=parseInt(l));const p=f-h;p*1e3<=yu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const g=f-d;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,h);const{data:w,error:x}=await this._getUser(i);if(x)throw x;const y={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:f,refresh_token:a,token_type:c,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(n){if(ce(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ko(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return this._returnResult({error:i});const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(vk(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await ca(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=kk(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await du(this.storage,this.storageKey,!0));try{return await we(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,l,c,h;const{data:d,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await we(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return fr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ce(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:i}}=t;if(s)throw s;const{options:a,provider:o,token:l,access_token:c,nonce:h}=e,d=await we(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:rs}),{data:f,error:p}=d;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new hu}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(s){if(ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:a}=t;if(a)throw a;return await we(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Pk(async s=>(s>0&&await Rk(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await we(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:rs})),(s,i)=>{const a=200*Math.pow(2,s);return i&&xg(i)&&Date.now()+a-n<yu})}catch(n){if(this._debug(t,"error",n),ce(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),fr()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await ko(this.storage,this.storageKey);if(s&&this.userStorage){let a=await ko(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await wu(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Eg()}else if(s&&!s.user&&!s.user){const a=await ko(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await ca(this.storage,this.storageKey+"-user"),await wu(this.storage,this.storageKey,s)):s.user=Eg()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<_g;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${_g}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),xg(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new C1;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ts;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),ce(i)){const a={data:null,error:i};return xg(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await wu(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=$5(s);await wu(this.storage,this.storageKey,i)}else{const s=$5(t);await wu(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ca(this.storage,this.storageKey),await ca(this.storage,this.storageKey+"-code-verifier"),await ca(this.storage,this.storageKey+"-user"),this.userStorage&&await ca(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),yu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/yu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${yu}ms, refresh threshold is ${Jv} ticks`),s<=Jv&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof A8)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await du(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?this._returnResult({data:null,error:i}):await we(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await we(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?aT(e.webauthn.credential_response):oT(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await we(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=await we(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:sT(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:iT(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Ag(n.access_token);let a=null;i.aal&&(a=i.aal);let o=a;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(o="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?await we(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ts})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new ts});const a=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&fr()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new ts});const a=await we(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&fr()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+mk>s)return n;const{data:i,error:a}=await we(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=Ag(n);t!=null&&t.allowExpired||Fk(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:a},error:null}}const h=zk(s.alg),d=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,a,Ak(`${o}.${l}`)))throw new t4("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}}N0.nextInstanceID={};const gT=N0;class vT extends gT{constructor(e){super(e)}}class yT{constructor(e,t,n){var s,i,a;this.supabaseUrl=e,this.supabaseKey=t;const o=ck(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:rk,realtime:sk,auth:Object.assign(Object.assign({},nk),{storageKey:l}),global:tk},h=uk(n??{},c);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=ok(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new hE(new URL("rest/v1",o).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new JE(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new lE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:a,flowType:o,lock:l,debug:c,throwOnError:h},d,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vT({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:i,flowType:o,lock:l,debug:c,throwOnError:h,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new CE(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wT=(r,e,t)=>new yT(r,e,t);function bT(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}bT()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ST="https://adyyulsqzuccexwulyyb.supabase.co",_T="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkeXl1bHNxenVjY2V4d3VseXliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzMDI2NjAsImV4cCI6MjA2OTg3ODY2MH0.pDPf_BiUxVtotMQhsELVCvY8sBBgxPuFDaPj46eESfI",Th=wT(ST,_T);var K5;(function(r){r.STRING="string",r.NUMBER="number",r.INTEGER="integer",r.BOOLEAN="boolean",r.ARRAY="array",r.OBJECT="object"})(K5||(K5={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var X5;(function(r){r.LANGUAGE_UNSPECIFIED="language_unspecified",r.PYTHON="python"})(X5||(X5={}));var Y5;(function(r){r.OUTCOME_UNSPECIFIED="outcome_unspecified",r.OUTCOME_OK="outcome_ok",r.OUTCOME_FAILED="outcome_failed",r.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Y5||(Y5={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=["user","model","function","system"];var J5;(function(r){r.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",r.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",r.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",r.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",r.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(J5||(J5={}));var Z5;(function(r){r.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",r.BLOCK_NONE="BLOCK_NONE"})(Z5||(Z5={}));var ew;(function(r){r.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",r.NEGLIGIBLE="NEGLIGIBLE",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH"})(ew||(ew={}));var tw;(function(r){r.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",r.SAFETY="SAFETY",r.OTHER="OTHER"})(tw||(tw={}));var h0;(function(r){r.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",r.STOP="STOP",r.MAX_TOKENS="MAX_TOKENS",r.SAFETY="SAFETY",r.RECITATION="RECITATION",r.LANGUAGE="LANGUAGE",r.OTHER="OTHER"})(h0||(h0={}));var rw;(function(r){r.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",r.RETRIEVAL_QUERY="RETRIEVAL_QUERY",r.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",r.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",r.CLASSIFICATION="CLASSIFICATION",r.CLUSTERING="CLUSTERING"})(rw||(rw={}));var nw;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.AUTO="AUTO",r.ANY="ANY",r.NONE="NONE"})(nw||(nw={}));var sw;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.MODE_DYNAMIC="MODE_DYNAMIC"})(sw||(sw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class gu extends Qr{constructor(e,t){super(e),this.response=t}}class T8 extends Qr{constructor(e,t,n,s){super(e),this.status=t,this.statusText=n,this.errorDetails=s}}class lo extends Qr{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT="https://generativelanguage.googleapis.com",AT="v1beta",ET="0.21.0",kT="genai-js";var tu;(function(r){r.GENERATE_CONTENT="generateContent",r.STREAM_GENERATE_CONTENT="streamGenerateContent",r.COUNT_TOKENS="countTokens",r.EMBED_CONTENT="embedContent",r.BATCH_EMBED_CONTENTS="batchEmbedContents"})(tu||(tu={}));class TT{constructor(e,t,n,s,i){this.model=e,this.task=t,this.apiKey=n,this.stream=s,this.requestOptions=i}toString(){var e,t;const n=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||AT;let i=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||xT}/${n}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}function CT(r){const e=[];return r!=null&&r.apiClient&&e.push(r.apiClient),e.push(`${kT}/${ET}`),e.join(" ")}async function RT(r){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",CT(r.requestOptions)),t.append("x-goog-api-key",r.apiKey);let n=(e=r.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(s){throw new lo(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${s.message}`)}for(const[s,i]of n.entries()){if(s==="x-goog-api-key")throw new lo(`Cannot set reserved header name ${s}`);if(s==="x-goog-api-client")throw new lo(`Header name ${s} can only be set using the apiClient field`);t.append(s,i)}}return t}async function PT(r,e,t,n,s,i){const a=new TT(r,e,t,n,i);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},NT(i)),{method:"POST",headers:await RT(a),body:s})}}async function bf(r,e,t,n,s,i={},a=fetch){const{url:o,fetchOptions:l}=await PT(r,e,t,n,s,i);return MT(o,l,a)}async function MT(r,e,t=fetch){let n;try{n=await t(r,e)}catch(s){IT(s,r)}return n.ok||await OT(n,r),n}function IT(r,e){let t=r;throw r instanceof T8||r instanceof lo||(t=new Qr(`Error fetching from ${e.toString()}: ${r.message}`),t.stack=r.stack),t}async function OT(r,e){let t="",n;try{const s=await r.json();t=s.error.message,s.error.details&&(t+=` ${JSON.stringify(s.error.details)}`,n=s.error.details)}catch{}throw new T8(`Error fetching from ${e.toString()}: [${r.status} ${r.statusText}] ${t}`,r.status,r.statusText,n)}function NT(r){const e={};if((r==null?void 0:r.signal)!==void 0||(r==null?void 0:r.timeout)>=0){const t=new AbortController;(r==null?void 0:r.timeout)>=0&&setTimeout(()=>t.abort(),r.timeout),r!=null&&r.signal&&r.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(r){return r.text=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Ep(r.candidates[0]))throw new gu(`${ga(r)}`,r);return LT(r)}else if(r.promptFeedback)throw new gu(`Text not available. ${ga(r)}`,r);return""},r.functionCall=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Ep(r.candidates[0]))throw new gu(`${ga(r)}`,r);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),iw(r)[0]}else if(r.promptFeedback)throw new gu(`Function call not available. ${ga(r)}`,r)},r.functionCalls=()=>{if(r.candidates&&r.candidates.length>0){if(r.candidates.length>1&&console.warn(`This response had ${r.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Ep(r.candidates[0]))throw new gu(`${ga(r)}`,r);return iw(r)}else if(r.promptFeedback)throw new gu(`Function call not available. ${ga(r)}`,r)},r}function LT(r){var e,t,n,s;const i=[];if(!((t=(e=r.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(s=(n=r.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)a.text&&i.push(a.text),a.executableCode&&i.push("\n```"+a.executableCode.language+`
`+a.executableCode.code+"\n```\n"),a.codeExecutionResult&&i.push("\n```\n"+a.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}function iw(r){var e,t,n,s;const i=[];if(!((t=(e=r.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const a of(s=(n=r.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)a.functionCall&&i.push(a.functionCall);if(i.length>0)return i}const DT=[h0.RECITATION,h0.SAFETY,h0.LANGUAGE];function Ep(r){return!!r.finishReason&&DT.includes(r.finishReason)}function ga(r){var e,t,n;let s="";if((!r.candidates||r.candidates.length===0)&&r.promptFeedback)s+="Response was blocked",!((e=r.promptFeedback)===null||e===void 0)&&e.blockReason&&(s+=` due to ${r.promptFeedback.blockReason}`),!((t=r.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(s+=`: ${r.promptFeedback.blockReasonMessage}`);else if(!((n=r.candidates)===null||n===void 0)&&n[0]){const i=r.candidates[0];Ep(i)&&(s+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(s+=`: ${i.finishMessage}`))}return s}function L0(r){return this instanceof L0?(this.v=r,this):new L0(r)}function FT(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s;function a(f){n[f]&&(s[f]=function(p){return new Promise(function(g,w){i.push([f,p,g,w])>1||o(f,p)})})}function o(f,p){try{l(n[f](p))}catch(g){d(i[0][3],g)}}function l(f){f.value instanceof L0?Promise.resolve(f.value.v).then(c,h):d(i[0][2],f)}function c(f){o("next",f)}function h(f){o("throw",f)}function d(f,p){f(p),i.shift(),i.length&&o(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function zT(r){const e=r.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=$T(e),[n,s]=t.tee();return{stream:jT(n),response:BT(s)}}async function BT(r){const e=[],t=r.getReader();for(;;){const{done:n,value:s}=await t.read();if(n)return C2(UT(e));e.push(s)}}function jT(r){return FT(this,arguments,function*(){const t=r.getReader();for(;;){const{value:n,done:s}=yield L0(t.read());if(s)break;yield yield L0(C2(n))}})}function $T(r){const e=r.getReader();return new ReadableStream({start(n){let s="";return i();function i(){return e.read().then(({value:a,done:o})=>{if(o){if(s.trim()){n.error(new Qr("Failed to parse stream"));return}n.close();return}s+=a;let l=s.match(aw),c;for(;l;){try{c=JSON.parse(l[1])}catch{n.error(new Qr(`Error parsing JSON response: "${l[1]}"`));return}n.enqueue(c),s=s.substring(l[0].length),l=s.match(aw)}return i()})}}})}function UT(r){const e=r[r.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const n of r){if(n.candidates)for(const s of n.candidates){const i=s.index;if(t.candidates||(t.candidates=[]),t.candidates[i]||(t.candidates[i]={index:s.index}),t.candidates[i].citationMetadata=s.citationMetadata,t.candidates[i].groundingMetadata=s.groundingMetadata,t.candidates[i].finishReason=s.finishReason,t.candidates[i].finishMessage=s.finishMessage,t.candidates[i].safetyRatings=s.safetyRatings,s.content&&s.content.parts){t.candidates[i].content||(t.candidates[i].content={role:s.content.role||"user",parts:[]});const a={};for(const o of s.content.parts)o.text&&(a.text=o.text),o.functionCall&&(a.functionCall=o.functionCall),o.executableCode&&(a.executableCode=o.executableCode),o.codeExecutionResult&&(a.codeExecutionResult=o.codeExecutionResult),Object.keys(a).length===0&&(a.text=""),t.candidates[i].content.parts.push(a)}}n.usageMetadata&&(t.usageMetadata=n.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C8(r,e,t,n){const s=await bf(e,tu.STREAM_GENERATE_CONTENT,r,!0,JSON.stringify(t),n);return zT(s)}async function R8(r,e,t,n){const i=await(await bf(e,tu.GENERATE_CONTENT,r,!1,JSON.stringify(t),n)).json();return{response:C2(i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P8(r){if(r!=null){if(typeof r=="string")return{role:"system",parts:[{text:r}]};if(r.text)return{role:"system",parts:[r]};if(r.parts)return r.role?r:{role:"system",parts:r.parts}}}function D0(r){let e=[];if(typeof r=="string")e=[{text:r}];else for(const t of r)typeof t=="string"?e.push({text:t}):e.push(t);return HT(e)}function HT(r){const e={role:"user",parts:[]},t={role:"function",parts:[]};let n=!1,s=!1;for(const i of r)"functionResponse"in i?(t.parts.push(i),s=!0):(e.parts.push(i),n=!0);if(n&&s)throw new Qr("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!s)throw new Qr("No content is provided for sending chat message.");return n?e:t}function qT(r,e){var t;let n={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const s=r.generateContentRequest!=null;if(r.contents){if(s)throw new lo("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=r.contents}else if(s)n=Object.assign(Object.assign({},n),r.generateContentRequest);else{const i=D0(r);n.contents=[i]}return{generateContentRequest:n}}function ow(r){let e;return r.contents?e=r:e={contents:[D0(r)]},r.systemInstruction&&(e.systemInstruction=P8(r.systemInstruction)),e}function VT(r){return typeof r=="string"||Array.isArray(r)?{content:D0(r)}:r}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],GT={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function WT(r){let e=!1;for(const t of r){const{role:n,parts:s}=t;if(!e&&n!=="user")throw new Qr(`First content should be with role 'user', got ${n}`);if(!Q5.includes(n))throw new Qr(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(Q5)}`);if(!Array.isArray(s))throw new Qr("Content should have 'parts' property with an array of Parts");if(s.length===0)throw new Qr("Each Content should have at least one part");const i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const o of s)for(const l of lw)l in o&&(i[l]+=1);const a=GT[n];for(const o of lw)if(!a.includes(o)&&i[o]>0)throw new Qr(`Content with role '${n}' can't contain '${o}' part`);e=!0}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw="SILENT_ERROR";class KT{constructor(e,t,n,s={}){this.model=t,this.params=n,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,n!=null&&n.history&&(WT(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var n,s,i,a,o,l;await this._sendPromise;const c=D0(e),h={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},d=Object.assign(Object.assign({},this._requestOptions),t);let f;return this._sendPromise=this._sendPromise.then(()=>R8(this._apiKey,this.model,h,d)).then(p=>{var g;if(p.response.candidates&&p.response.candidates.length>0){this._history.push(c);const w=Object.assign({parts:[],role:"model"},(g=p.response.candidates)===null||g===void 0?void 0:g[0].content);this._history.push(w)}else{const w=ga(p.response);w&&console.warn(`sendMessage() was unsuccessful. ${w}. Inspect response object for details.`)}f=p}),await this._sendPromise,f}async sendMessageStream(e,t={}){var n,s,i,a,o,l;await this._sendPromise;const c=D0(e),h={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},d=Object.assign(Object.assign({},this._requestOptions),t),f=C8(this._apiKey,this.model,h,d);return this._sendPromise=this._sendPromise.then(()=>f).catch(p=>{throw new Error(uw)}).then(p=>p.response).then(p=>{if(p.candidates&&p.candidates.length>0){this._history.push(c);const g=Object.assign({},p.candidates[0].content);g.role||(g.role="model"),this._history.push(g)}else{const g=ga(p);g&&console.warn(`sendMessageStream() was unsuccessful. ${g}. Inspect response object for details.`)}}).catch(p=>{p.message!==uw&&console.error(p)}),f}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XT(r,e,t,n){return(await bf(e,tu.COUNT_TOKENS,r,!1,JSON.stringify(t),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YT(r,e,t,n){return(await bf(e,tu.EMBED_CONTENT,r,!1,JSON.stringify(t),n)).json()}async function QT(r,e,t,n){const s=t.requests.map(a=>Object.assign(Object.assign({},a),{model:e}));return(await bf(e,tu.BATCH_EMBED_CONTENTS,r,!1,JSON.stringify({requests:s}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t,n={}){this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=P8(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var n;const s=ow(e),i=Object.assign(Object.assign({},this._requestOptions),t);return R8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),i)}async generateContentStream(e,t={}){var n;const s=ow(e),i=Object.assign(Object.assign({},this._requestOptions),t);return C8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),i)}startChat(e){var t;return new KT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const n=qT(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),t);return XT(this.apiKey,this.model,n,s)}async embedContent(e,t={}){const n=VT(e),s=Object.assign(Object.assign({},this._requestOptions),t);return YT(this.apiKey,this.model,n,s)}async batchEmbedContents(e,t={}){const n=Object.assign(Object.assign({},this._requestOptions),t);return QT(this.apiKey,this.model,e,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Qr("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new cw(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new lo("Cached content must contain a `name` field.");if(!e.model)throw new lo("Cached content must contain a `model` field.");const s=["model","systemInstruction"];for(const a of s)if(t!=null&&t[a]&&e[a]&&(t==null?void 0:t[a])!==e[a]){if(a==="model"){const o=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(o===l)continue}throw new lo(`Different value for "${a}" specified in modelParams (${t[a]}) and cachedContent (${e[a]})`)}const i=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new cw(this.apiKey,i,n)}}class ZT{constructor(e){he(this,"apiKeys");he(this,"currentIndex",0);he(this,"clients");this.apiKeys=e.filter(t=>t.trim()!==""),this.clients=this.apiKeys.map(t=>new JT(t))}getNextClient(){if(this.clients.length===0)throw new Error("No valid API keys provided");const e=this.clients[this.currentIndex];return this.currentIndex=(this.currentIndex+1)%this.clients.length,e}async analyzeImage(e,t,n=3){let s=null;for(let i=0;i<n&&i<this.clients.length;i++)try{const h=(await(await this.getNextClient().getGenerativeModel({model:"gemini-2.5-flash"}).generateContent([t,{inlineData:{data:e,mimeType:"image/png"}}])).response).text();if(!h||h.trim().length===0)throw new Error("Empty response from Gemini");return h}catch(a){s=a,console.error(`API key ${i+1} failed:`,a),i<n-1&&await new Promise(o=>setTimeout(o,1e3+Math.random()*2e3))}throw s||new Error("All API keys failed")}async verifyExtraction(e,t){try{const s=this.getNextClient().getGenerativeModel({model:"gemini-2.0-flash"}),i=`You are an expert verifier checking if question extraction is PERFECT.

Compare the original image with the extracted JSON below:

${t}

VERIFICATION CRITERIA (all must be met for 95+):
1. Question text is word-for-word accurate
2. ALL mathematical expressions are in proper KaTeX format ($$...$$)
3. ALL tables MUST use KaTeX array format: $$\\begin{array}{|c|l|}\\hline...\\end{array}$$
4. ALL matrices MUST use KaTeX: $$\\begin{bmatrix}...\\end{bmatrix}$$
5. ALL diagrams/visual elements are accurately represented in SVG
6. ALL options are complete and accurate (if MCQ/MSQ)
7. Question structure is complete (no missing parts)
8. NO plain text tables with || or similar - ONLY KaTeX arrays

SCORING GUIDE:
- 99-100: PERFECT extraction, indistinguishable from original
- 85-94: Minor formatting issues (small KaTeX errors, slightly inaccurate SVG)
- 75-84: Missing elements or noticeable errors (incomplete options, wrong math)
- Below 75: Major problems (missing questions, wrong content, plain text tables)

CRITICAL: Be strict. If you see plain text tables (||) instead of KaTeX arrays, score below 99.

Return ONLY this JSON format (no explanation):
{"score": 99, "feedback": "Tables should use KaTeX array format instead of plain text"}

The feedback should be specific about what needs fixing to reach 99+ score.`,l=(await(await s.generateContent([i,{inlineData:{data:e,mimeType:"image/png"}}])).response).text().trim();console.log("Verification response:",l);const c=l.match(/\{\s*"score"\s*:\s*(\d+)\s*,\s*"feedback"\s*:\s*"([^"]+)"\s*\}/);if(c){const f=parseInt(c[1])||0,p=c[2]||"";return console.log("Parsed verification score:",f,"Feedback:",p),{score:f,feedback:p}}const h=l.match(/\{\s*"score"\s*:\s*(\d+)\s*\}/);if(h){const f=parseInt(h[1])||0;return console.log("Parsed verification score:",f),{score:f,feedback:"Needs improvement"}}const d=l.match(/score["\s:]*(\d+)/);if(d){const f=parseInt(d[1]);return console.log("Extracted score from text:",f),{score:f,feedback:"Needs improvement"}}return console.log("No score found in verification response"),{score:0,feedback:"Verification failed"}}catch(n){return console.error("Verification failed:",n),{score:0,feedback:"Verification error"}}}async fixExtraction(e,t,n){try{const i=this.getNextClient().getGenerativeModel({model:"gemini-2.0-flash"}),a=`You previously extracted questions from an image, but the extraction needs improvement.

PREVIOUS EXTRACTION:
${t}

VERIFICATION FEEDBACK:
${n}

CRITICAL FORMATTING RULES:

1. TABLES (matching questions, data tables, etc.):
   WRONG: Using || or plain text
   RIGHT: $$\\begin{array}{|c|l|c|l|}\\hline\\textbf{Column-I} & & \\textbf{Column-II} & \\\\\\hline P. & \\text{Statement} & 1. & \\text{Response}\\\\\\hline\\end{array}$$

2. MATRICES:
   WRONG: Plain text or brackets
   RIGHT: $$\\begin{bmatrix}1 & 2\\\\3 & 4\\end{bmatrix}$$

3. MATH EXPRESSIONS:
   WRONG: x^2 or plain text
   RIGHT: $x^2$ (inline) or $$\\int_0^1 f(x)dx$$ (display)

4. DIAGRAMS:
   Use complete SVG with proper viewBox, labels, and styling

5. OPTIONS:
   Use KaTeX for math in options: ["$P = 6$; $Q = 5$; $R = 3$"]

Fix ONLY the issues mentioned in the feedback. Return the COMPLETE corrected JSON with ALL questions.

Return ONLY valid JSON (no markdown):
[{"question_type":"MCQ","question_statement":"...","options":[...]}]`,c=(await(await i.generateContent([a,{inlineData:{data:e,mimeType:"image/png"}}])).response).text();if(!c||c.trim().length===0)throw new Error("Empty response from Gemini fix");return c}catch(s){throw console.error("Fix extraction failed:",s),s}}}var d0={};d0.d=(r,e)=>{for(var t in e)d0.o(e,t)&&!d0.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})};d0.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var be=globalThis.pdfjsLib={};d0.d(be,{AbortException:()=>fo,AnnotationEditorLayer:()=>cy,AnnotationEditorParamsType:()=>Me,AnnotationEditorType:()=>xe,AnnotationEditorUIManager:()=>nu,AnnotationLayer:()=>KR,AnnotationMode:()=>ba,ColorPicker:()=>zm,DOMSVGFactory:()=>F2,DrawLayer:()=>fy,FeatureTest:()=>Nr,GlobalWorkerOptions:()=>qi,ImageKind:()=>kp,InvalidPDFException:()=>n4,MissingPDFException:()=>F0,OPS:()=>as,OutputScale:()=>i4,PDFDataRangeTransport:()=>IS,PDFDateString:()=>O2,PDFWorker:()=>Xu,PasswordResponses:()=>nC,PermissionFlag:()=>rC,PixelsPerInch:()=>po,RenderingCancelledException:()=>M2,TextLayer:()=>z0,TouchManager:()=>Dm,UnexpectedResponseException:()=>Om,Util:()=>ue,VerbosityLevel:()=>R1,XfaLayer:()=>NS,build:()=>CR,createValidAbsoluteUrl:()=>oC,fetchData:()=>O1,getDocument:()=>wR,getFilenameFromUrl:()=>gC,getPdfFilenameFromUrl:()=>vC,getXfaPageViewport:()=>yC,isDataScheme:()=>N1,isPdfFile:()=>I2,noContextMenu:()=>ks,normalizeUnicode:()=>fC,setLayerDimensions:()=>ru,shadow:()=>Ce,stopEvent:()=>_n,version:()=>TR});const Sr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),M8=[1,0,0,1,0,0],r4=[.001,0,0,.001,0,0],eC=1e7,Tg=1.35,vn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ba={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},tC="pdfjs_internal_editor_",xe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Me={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},rC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},hr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},kp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Lt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Ch={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},R1={ERRORS:0,WARNINGS:1,INFOS:5},as={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},nC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let P1=R1.WARNINGS;function sC(r){Number.isInteger(r)&&(P1=r)}function iC(){return P1}function M1(r){P1>=R1.INFOS&&console.log(`Info: ${r}`)}function Ae(r){P1>=R1.WARNINGS&&console.log(`Warning: ${r}`)}function Ke(r){throw new Error(r)}function It(r,e){r||Ke(e)}function aC(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function oC(r,e=null,t=null){if(!r)return null;try{if(t&&typeof r=="string"){if(t.addDefaultProtocol&&r.startsWith("www.")){const s=r.match(/\./g);(s==null?void 0:s.length)>=2&&(r=`http://${r}`)}if(t.tryConvertEncoding)try{r=dC(r)}catch{}}const n=e?new URL(r,e):new URL(r);if(aC(n))return n}catch{}return null}function Ce(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const xo=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class hw extends xo{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Cg extends xo{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class n4 extends xo{constructor(e){super(e,"InvalidPDFException")}}class F0 extends xo{constructor(e){super(e,"MissingPDFException")}}class Om extends xo{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class lC extends xo{constructor(e){super(e,"FormatError")}}class fo extends xo{constructor(e){super(e,"AbortException")}}function I8(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&Ke("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let s=0;s<e;s+=t){const i=Math.min(s+t,e),a=r.subarray(s,i);n.push(String.fromCharCode.apply(null,a))}return n.join("")}function I1(r){typeof r!="string"&&Ke("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function uC(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function R2(r){const e=Object.create(null);for(const[t,n]of r)e[t]=n;return e}function cC(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function hC(){try{return new Function(""),!0}catch{return!1}}class Nr{static get isLittleEndian(){return Ce(this,"isLittleEndian",cC())}static get isEvalSupported(){return Ce(this,"isEvalSupported",hC())}static get isOffscreenCanvasSupported(){return Ce(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ce(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Ce(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Ce(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return Ce(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Rg=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var Yi,Tp,s4;class ue{static makeHexColor(e,t,n){return`#${Rg[e]}${Rg[t]}${Rg[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[n,s]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,i=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[s,i]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],s[0],i[0],a[0]),Math.min(n[1],s[1],i[1],a[1]),Math.max(n[0],s[0],i[0],a[0]),Math.max(n[1],s[1],i[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(n+a)/2,l=Math.sqrt((n+a)**2-4*(n*a-i*s))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[n,i,s,a]}static bezierBoundingBox(e,t,n,s,i,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],k(this,Yi,s4).call(this,e,n,i,o,t,s,a,l,3*(-e+3*(n-i)+o),6*(e-2*n+i),3*(n-e),c),k(this,Yi,s4).call(this,e,n,i,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c),c}}Yi=new WeakSet,Tp=function(e,t,n,s,i,a,o,l,c,h){if(c<=0||c>=1)return;const d=1-c,f=c*c,p=f*c,g=d*(d*(d*e+3*c*t)+3*f*n)+p*s,w=d*(d*(d*i+3*c*a)+3*f*o)+p*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],w),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],w)},s4=function(e,t,n,s,i,a,o,l,c,h,d,f){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&k(this,Yi,Tp).call(this,e,t,n,s,i,a,o,l,-d/h,f);return}const p=h**2-4*d*c;if(p<0)return;const g=Math.sqrt(p),w=2*c;k(this,Yi,Tp).call(this,e,t,n,s,i,a,o,l,(-h+g)/w,f),k(this,Yi,Tp).call(this,e,t,n,s,i,a,o,l,(-h-g)/w,f)},E(ue,Yi);function dC(r){return decodeURIComponent(escape(r))}let Pg=null,dw=null;function fC(r){return Pg||(Pg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,dw=new Map([["","t"]])),r.replaceAll(Pg,(e,t,n)=>t?t.normalize("NFKC"):dw.get(n))}function pC(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),I8(r)}const P2="pdfjs_internal_id_";function mC(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(I8(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});const ci="http://www.w3.org/2000/svg",zo=class zo{};he(zo,"CSS",96),he(zo,"PDF",72),he(zo,"PDF_TO_CSS_UNITS",zo.CSS/zo.PDF);let po=zo;async function O1(r,e="text"){if(Fh(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Sf{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:i=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=i,this.offsetY=a,n*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let h,d,f,p;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,d=0,f=0,p=1;break;case 90:h=0,d=1,f=1,p=0;break;case 270:h=0,d=-1,f=-1,p=0;break;case 0:h=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let g,w,x,y;h===0?(g=Math.abs(c-e[1])*n+i,w=Math.abs(l-e[0])*n+a,x=(e[3]-e[1])*n,y=(e[2]-e[0])*n):(g=Math.abs(l-e[0])*n+i,w=Math.abs(c-e[1])*n+a,x=(e[2]-e[0])*n,y=(e[3]-e[1])*n),this.transform=[h*n,d*n,f*n,p*n,g-h*n*l-f*n*c,w-d*n*l-p*n*c],this.width=x,this.height=y}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(s=>s*e);return Ce(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}={}){return new Sf({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}convertToViewportPoint(e,t){return ue.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=ue.applyTransform([e[0],e[1]],this.transform),n=ue.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return ue.applyInverseTransform([e,t],this.transform)}}class M2 extends xo{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function N1(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function I2(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function gC(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function vC(r,e="document.pdf"){if(typeof r!="string")return e;if(N1(r))return Ae('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(r);let i=n.exec(s[1])||n.exec(s[2])||n.exec(s[3]);if(i&&(i=i[0],i.includes("%")))try{i=n.exec(decodeURIComponent(i))[0]}catch{}return i||e}class fw{constructor(){he(this,"started",Object.create(null));he(this,"times",[])}time(e){e in this.started&&Ae(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ae(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-s}ms
`);return e.join("")}}function Fh(r,e){try{const{protocol:t}=e?new URL(r,e):new URL(r);return t==="http:"||t==="https:"}catch{return!1}}function ks(r){r.preventDefault()}function _n(r){r.preventDefault(),r.stopPropagation()}var U0;class O2{static toDateObject(e){if(!e||typeof e!="string")return null;u(this,U0)||S(this,U0,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=u(this,U0).exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=h,o+=d):c==="+"&&(a-=h,o-=d),new Date(Date.UTC(n,s,i,a,o,l))}}U0=new WeakMap,E(O2,U0);function yC(r,{scale:e=1,rotation:t=0}){const{width:n,height:s}=r.attributes.style,i=[0,0,parseInt(n),parseInt(s)];return new Sf({viewBox:i,userUnit:1,scale:e,rotation:t})}function N2(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ae(`Not a valid color format: "${r}"`),[0,0,0])}function wC(r){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,N2(n))}e.remove()}function at(r){const{a:e,b:t,c:n,d:s,e:i,f:a}=r.getTransform();return[e,t,n,s,i,a]}function Ms(r){const{a:e,b:t,c:n,d:s,e:i,f:a}=r.getTransform().invertSelf();return[e,t,n,s,i,a]}function ru(r,e,t=!1,n=!0){if(e instanceof Sf){const{pageWidth:s,pageHeight:i}=e.rawDims,{style:a}=r,o=Nr.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${i}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}n&&r.setAttribute("data-main-rotation",e.rotation)}class i4{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Sa,qo,os,Vo,H0,q0,Gm,O8,Lr,N8,L8,Cp,D8,o4;const mi=class mi{constructor(e){E(this,Lr);E(this,Sa,null);E(this,qo,null);E(this,os);E(this,Vo,null);E(this,H0,null);S(this,os,e),u(mi,q0)||S(mi,q0,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=S(this,Sa,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=u(this,os)._uiManager._signal;e.addEventListener("contextmenu",ks,{signal:t}),e.addEventListener("pointerdown",k(mi,Gm,O8),{signal:t});const n=S(this,Vo,document.createElement("div"));n.className="buttons",e.append(n);const s=u(this,os).toolbarPosition;if(s){const{style:i}=e,a=u(this,os)._uiManager.direction==="ltr"?1-s[0]:s[0];i.insetInlineEnd=`${100*a}%`,i.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return k(this,Lr,D8).call(this),e}get div(){return u(this,Sa)}hide(){var e;u(this,Sa).classList.add("hidden"),(e=u(this,qo))==null||e.hideDropdown()}show(){var e;u(this,Sa).classList.remove("hidden"),(e=u(this,H0))==null||e.shown()}async addAltText(e){const t=await e.render();k(this,Lr,Cp).call(this,t),u(this,Vo).prepend(t,u(this,Lr,o4)),S(this,H0,e)}addColorPicker(e){S(this,qo,e);const t=e.renderButton();k(this,Lr,Cp).call(this,t),u(this,Vo).prepend(t,u(this,Lr,o4))}remove(){var e;u(this,Sa).remove(),(e=u(this,qo))==null||e.destroy(),S(this,qo,null)}};Sa=new WeakMap,qo=new WeakMap,os=new WeakMap,Vo=new WeakMap,H0=new WeakMap,q0=new WeakMap,Gm=new WeakSet,O8=function(e){e.stopPropagation()},Lr=new WeakSet,N8=function(e){u(this,os)._focusEventsAllowed=!1,_n(e)},L8=function(e){u(this,os)._focusEventsAllowed=!0,_n(e)},Cp=function(e){const t=u(this,os)._uiManager._signal;e.addEventListener("focusin",k(this,Lr,N8).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",k(this,Lr,L8).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ks,{signal:t})},D8=function(){const{editorType:e,_uiManager:t}=u(this,os),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",u(mi,q0)[e]),k(this,Lr,Cp).call(this,n),n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),u(this,Vo).append(n)},o4=function(){const e=document.createElement("div");return e.className="divider",e},E(mi,Gm),E(mi,q0,null);let a4=mi;var V0,Go,Wo,yo,F8,z8,B8;class bC{constructor(e){E(this,yo);E(this,V0,null);E(this,Go,null);E(this,Wo);S(this,Wo,e)}show(e,t,n){const[s,i]=k(this,yo,z8).call(this,t,n),{style:a}=u(this,Go)||S(this,Go,k(this,yo,F8).call(this));e.append(u(this,Go)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,Go).remove()}}V0=new WeakMap,Go=new WeakMap,Wo=new WeakMap,yo=new WeakSet,F8=function(){const e=S(this,Go,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ks,{signal:u(this,Wo)._signal});const t=S(this,V0,document.createElement("div"));return t.className="buttons",e.append(t),k(this,yo,B8).call(this),e},z8=function(e,t){let n=0,s=0;for(const i of e){const a=i.y+i.height;if(a<n)continue;const o=i.x+(t?i.width:0);if(a>n){s=o,n=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,n]},B8=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=u(this,Wo)._signal;e.addEventListener("contextmenu",ks,{signal:n}),e.addEventListener("click",()=>{u(this,Wo).highlightSelection("floating_button")},{signal:n}),u(this,V0).append(e)};function Nm(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}var Wm;class SC{constructor(){E(this,Wm,0)}get id(){return`${tC}${xr(this,Wm)._++}`}}Wm=new WeakMap;var Qu,G0,mr,Ju,Rp;const i3=class i3{constructor(){E(this,Ju);E(this,Qu,pC());E(this,G0,0);E(this,mr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const i=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ce(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:n,size:s,type:i}=e;return k(this,Ju,Rp).call(this,`${t}_${n}_${s}_${i}`,e)}async getFromUrl(e){return k(this,Ju,Rp).call(this,e,e)}async getFromBlob(e,t){const n=await t;return k(this,Ju,Rp).call(this,e,n)}async getFromId(e){u(this,mr)||S(this,mr,new Map);const t=u(this,mr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){u(this,mr)||S(this,mr,new Map);let n=u(this,mr).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${u(this,Qu)}_${xr(this,G0)._++}`,refCounter:1,isSvg:!1},u(this,mr).set(e,n),u(this,mr).set(n.id,n),n}getSvgUrl(e){const t=u(this,mr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;u(this,mr)||S(this,mr,new Map);const t=u(this,mr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}(s=n.close)==null||s.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${u(this,Qu)}_`)}};Qu=new WeakMap,G0=new WeakMap,mr=new WeakMap,Ju=new WeakSet,Rp=async function(e,t){u(this,mr)||S(this,mr,new Map);let n=u(this,mr).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${u(this,Qu)}_${xr(this,G0)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(n.url=t,s=await O1(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const i=i3._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{n.bitmap=o,n.isSvg=!0,c()},a.onload=async()=>{const d=n.svgUrl=a.result;o.src=await i?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Ae(s),n=null}return u(this,mr).set(e,n),n&&u(this,mr).set(n.id,n),n};let l4=i3;var xt,_a,W0,ct;class _C{constructor(e=128){E(this,xt,[]);E(this,_a,!1);E(this,W0);E(this,ct,-1);S(this,W0,e)}add({cmd:e,undo:t,post:n,mustExec:s,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),u(this,_a))return;const l={cmd:e,undo:t,post:n,type:i};if(u(this,ct)===-1){u(this,xt).length>0&&(u(this,xt).length=0),S(this,ct,0),u(this,xt).push(l);return}if(a&&u(this,xt)[u(this,ct)].type===i){o&&(l.undo=u(this,xt)[u(this,ct)].undo),u(this,xt)[u(this,ct)]=l;return}const c=u(this,ct)+1;c===u(this,W0)?u(this,xt).splice(0,1):(S(this,ct,c),c<u(this,xt).length&&u(this,xt).splice(c)),u(this,xt).push(l)}undo(){if(u(this,ct)===-1)return;S(this,_a,!0);const{undo:e,post:t}=u(this,xt)[u(this,ct)];e(),t==null||t(),S(this,_a,!1),S(this,ct,u(this,ct)-1)}redo(){if(u(this,ct)<u(this,xt).length-1){S(this,ct,u(this,ct)+1),S(this,_a,!0);const{cmd:e,post:t}=u(this,xt)[u(this,ct)];e(),t==null||t(),S(this,_a,!1)}}hasSomethingToUndo(){return u(this,ct)!==-1}hasSomethingToRedo(){return u(this,ct)<u(this,xt).length-1}cleanType(e){if(u(this,ct)!==-1){for(let t=u(this,ct);t>=0;t--)if(u(this,xt)[t].type!==e){u(this,xt).splice(t+1,u(this,ct)-t),S(this,ct,t);return}u(this,xt).length=0,S(this,ct,-1)}}destroy(){S(this,xt,null)}}xt=new WeakMap,_a=new WeakMap,W0=new WeakMap,ct=new WeakMap;var Km,j8;class _f{constructor(e){E(this,Km);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Nr.platform;for(const[n,s,i={}]of e)for(const a of n){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:i}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:i}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(k(this,Km,j8).call(this,t));if(!n)return;const{callback:s,options:{bubbles:i=!1,args:a=[],checker:o=null}}=n;o&&!o(e,t)||(s.bind(e,...a,t)(),i||_n(t))}}Km=new WeakSet,j8=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Xm=class Xm{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return wC(e),Ce(this,"_colors",e)}convert(e){const t=N2(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((i,a)=>i===t[a]))return Xm._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?ue.makeHexColor(...t):e}};he(Xm,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let u4=Xm;var Zu,sn,zt,Zt,ec,wi,tc,On,xa,Ko,rc,Xo,Ls,ls,Yo,K0,X0,nc,Y0,Ds,Aa,sc,Ea,Fs,Ym,ka,Q0,Ta,Qo,J0,Z0,Vt,Ue,bi,Jo,ed,td,Ca,zs,Si,rd,Nn,X,Pp,c4,$8,U8,Mp,H8,q8,V8,h4,G8,d4,f4,W8,Er,hi,K8,X8,p4,Y8,zh,m4;const Bu=class Bu{constructor(e,t,n,s,i,a,o,l,c,h,d,f,p){E(this,X);E(this,Zu,new AbortController);E(this,sn,null);E(this,zt,new Map);E(this,Zt,new Map);E(this,ec,null);E(this,wi,null);E(this,tc,null);E(this,On,new _C);E(this,xa,null);E(this,Ko,null);E(this,rc,0);E(this,Xo,new Set);E(this,Ls,null);E(this,ls,null);E(this,Yo,new Set);he(this,"_editorUndoBar",null);E(this,K0,!1);E(this,X0,!1);E(this,nc,!1);E(this,Y0,null);E(this,Ds,null);E(this,Aa,null);E(this,sc,null);E(this,Ea,!1);E(this,Fs,null);E(this,Ym,new SC);E(this,ka,!1);E(this,Q0,!1);E(this,Ta,null);E(this,Qo,null);E(this,J0,null);E(this,Z0,null);E(this,Vt,xe.NONE);E(this,Ue,new Set);E(this,bi,null);E(this,Jo,null);E(this,ed,null);E(this,td,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,Ca,[0,0]);E(this,zs,null);E(this,Si,null);E(this,rd,null);E(this,Nn,null);const g=this._signal=u(this,Zu).signal;S(this,Si,e),S(this,rd,t),S(this,ec,n),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:g}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),s._on("setpreference",this.onSetPreference.bind(this),{signal:g}),s._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:g}),k(this,X,H8).call(this),k(this,X,W8).call(this),k(this,X,h4).call(this),S(this,wi,i.annotationStorage),S(this,Y0,i.filterFactory),S(this,Jo,a),S(this,sc,o||null),S(this,K0,l),S(this,X0,c),S(this,nc,h),S(this,Z0,d||null),this.viewParameters={realScale:po.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const e=Bu.prototype,t=a=>u(a,Si).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),n=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return Ce(this,"_keyboardManager",new _f([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Si).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Si).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,n,s,i;(e=u(this,Nn))==null||e.resolve(),S(this,Nn,null),(t=u(this,Zu))==null||t.abort(),S(this,Zu,null),this._signal=null;for(const a of u(this,Zt).values())a.destroy();u(this,Zt).clear(),u(this,zt).clear(),u(this,Yo).clear(),S(this,sn,null),u(this,Ue).clear(),u(this,On).destroy(),(n=u(this,ec))==null||n.destroy(),(s=u(this,Fs))==null||s.hide(),S(this,Fs,null),u(this,Ds)&&(clearTimeout(u(this,Ds)),S(this,Ds,null)),u(this,zs)&&(clearTimeout(u(this,zs)),S(this,zs,null)),(i=this._editorUndoBar)==null||i.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return u(this,Z0)}get useNewAltTextFlow(){return u(this,X0)}get useNewAltTextWhenAddingImage(){return u(this,nc)}get hcmFilter(){return Ce(this,"hcmFilter",u(this,Jo)?u(this,Y0).addHCMFilter(u(this,Jo).foreground,u(this,Jo).background):"none")}get direction(){return Ce(this,"direction",getComputedStyle(u(this,Si)).direction)}get highlightColors(){return Ce(this,"highlightColors",u(this,sc)?new Map(u(this,sc).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Ce(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),S(this,Ko,e)}setMainHighlightColorPicker(e){S(this,J0,e)}editAltText(e,t=!1){var n;(n=u(this,ec))==null||n.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":S(this,nc,t);break}}onPageChanging({pageNumber:e}){S(this,rc,e-1)}focusMainContainer(){u(this,Si).focus()}findParent(e,t){for(const n of u(this,Zt).values()){const{x:s,y:i,width:a,height:o}=n.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=i&&t<=i+o)return n}return null}disableUserSelect(e=!1){u(this,rd).classList.toggle("noUserSelect",e)}addShouldRescale(e){u(this,Yo).add(e)}removeShouldRescale(e){u(this,Yo).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*po.PDF_TO_CSS_UNITS;for(const n of u(this,Yo))n.onScaleChanging();(t=u(this,Ko))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:i,focusOffset:a}=t,o=t.toString(),c=k(this,X,Pp).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const d=k(this,X,c4).call(this,c),f=u(this,Vt)===xe.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:n,anchorOffset:s,focusNode:i,focusOffset:a,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(xe.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&u(this,wi)&&!u(this,wi).has(e.id)&&u(this,wi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,u(this,Ea)&&(S(this,Ea,!1),k(this,X,Mp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of u(this,Ue))if(t.div.contains(e)){S(this,Qo,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!u(this,Qo))return;const[e,t]=u(this,Qo);S(this,Qo,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){k(this,X,h4).call(this),k(this,X,d4).call(this)}removeEditListeners(){k(this,X,G8).call(this),k(this,X,f4).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of u(this,ls))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of u(this,ls))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=u(this,sn))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of u(this,Ue)){const i=s.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const a of u(this,ls))if(a.isHandlingMimeForPasting(i.type)){a.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){Ae(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const i=[];for(const l of n){const c=await s.deserialize(l);if(!c)return;i.push(c)}const a=()=>{for(const l of i)k(this,X,p4).call(this,l);k(this,X,m4).call(this,i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(i){Ae(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,Vt)!==xe.NONE&&!this.isEditorHandlingKeyboard&&Bu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,Ea)&&(S(this,Ea,!1),k(this,X,Mp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(k(this,X,q8).call(this),k(this,X,d4).call(this),k(this,X,Er).call(this,{isEditing:u(this,Vt)!==xe.NONE,isEmpty:k(this,X,zh).call(this),hasSomethingToUndo:u(this,On).hasSomethingToUndo(),hasSomethingToRedo:u(this,On).hasSomethingToRedo(),hasSelectedEditor:!1})):(k(this,X,V8).call(this),k(this,X,f4).call(this),k(this,X,Er).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!u(this,ls)){S(this,ls,e);for(const t of u(this,ls))k(this,X,hi).call(this,t.defaultPropertiesToUpdate)}}getId(){return u(this,Ym).id}get currentLayer(){return u(this,Zt).get(u(this,rc))}getLayer(e){return u(this,Zt).get(e)}get currentPageIndex(){return u(this,rc)}addLayer(e){u(this,Zt).set(e.pageIndex,e),u(this,ka)?e.enable():e.disable()}removeLayer(e){u(this,Zt).delete(e.pageIndex)}async updateMode(e,t=null,n=!1){var s;if(u(this,Vt)!==e&&!(u(this,Nn)&&(await u(this,Nn).promise,!u(this,Nn)))){if(S(this,Nn,Promise.withResolvers()),S(this,Vt,e),e===xe.NONE){this.setEditingState(!1),k(this,X,X8).call(this),(s=this._editorUndoBar)==null||s.hide(),u(this,Nn).resolve();return}this.setEditingState(!0),await k(this,X,K8).call(this),this.unselectAll();for(const i of u(this,Zt).values())i.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),u(this,Nn).resolve();return}for(const i of u(this,zt).values())i.annotationElementId===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();u(this,Nn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==u(this,Vt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var n;if(u(this,ls)){switch(e){case Me.CREATE:this.currentLayer.addNewEditor();return;case Me.HIGHLIGHT_DEFAULT_COLOR:(n=u(this,J0))==null||n.updateColor(t);break;case Me.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,ed)||S(this,ed,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of u(this,Ue))s.updateParams(e,t);for(const s of u(this,ls))s.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var i;for(const a of u(this,zt).values())a.editorType===e&&a.show(t);(((i=u(this,ed))==null?void 0:i.get(Me.HIGHLIGHT_SHOW_ALL))??!0)!==t&&k(this,X,hi).call(this,[[Me.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(u(this,Q0)!==e){S(this,Q0,e);for(const t of u(this,Zt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of u(this,zt).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return u(this,zt).get(e)}addEditor(e){u(this,zt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(u(this,Ds)&&clearTimeout(u(this,Ds)),S(this,Ds,setTimeout(()=>{this.focusMainContainer(),S(this,Ds,null)},0))),u(this,zt).delete(e.id),this.unselect(e),(!e.annotationElementId||!u(this,Xo).has(e.annotationElementId))&&((t=u(this,wi))==null||t.remove(e.id))}addDeletedAnnotationElement(e){u(this,Xo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return u(this,Xo).has(e)}removeDeletedAnnotationElement(e){u(this,Xo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){u(this,sn)!==e&&(S(this,sn,e),e&&k(this,X,hi).call(this,e.propertiesToUpdate))}updateUI(e){u(this,X,Y8)===e&&k(this,X,hi).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){k(this,X,hi).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(u(this,Ue).has(e)){u(this,Ue).delete(e),e.unselect(),k(this,X,Er).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,Ue).add(e),e.select(),k(this,X,hi).call(this,e.propertiesToUpdate),k(this,X,Er).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=u(this,Ko))==null||t.commitOrRemove();for(const n of u(this,Ue))n!==e&&n.unselect();u(this,Ue).clear(),u(this,Ue).add(e),e.select(),k(this,X,hi).call(this,e.propertiesToUpdate),k(this,X,Er).call(this,{hasSelectedEditor:!0})}isSelected(e){return u(this,Ue).has(e)}get firstSelectedEditor(){return u(this,Ue).values().next().value}unselect(e){e.unselect(),u(this,Ue).delete(e),k(this,X,Er).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,Ue).size!==0}get isEnterHandled(){return u(this,Ue).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;u(this,On).undo(),k(this,X,Er).call(this,{hasSomethingToUndo:u(this,On).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:k(this,X,zh).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){u(this,On).redo(),k(this,X,Er).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,On).hasSomethingToRedo(),isEmpty:k(this,X,zh).call(this)})}addCommands(e){u(this,On).add(e),k(this,X,Er).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:k(this,X,zh).call(this)})}cleanUndoStack(e){u(this,On).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...u(this,Ue)],n=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)k(this,X,p4).call(this,a)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=u(this,sn))==null||e.commitOrRemove()}hasSomethingToControl(){return u(this,sn)||this.hasSelection}selectAll(){for(const e of u(this,Ue))e.commit();k(this,X,m4).call(this,u(this,zt).values())}unselectAll(){var e;if(!(u(this,sn)&&(u(this,sn).commitOrRemove(),u(this,Vt)!==xe.NONE))&&!((e=u(this,Ko))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear(),k(this,X,Er).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;u(this,Ca)[0]+=e,u(this,Ca)[1]+=t;const[s,i]=u(this,Ca),a=[...u(this,Ue)],o=1e3;u(this,zs)&&clearTimeout(u(this,zs)),S(this,zs,setTimeout(()=>{S(this,zs,null),u(this,Ca)[0]=u(this,Ca)[1]=0,this.addCommands({cmd:()=>{for(const l of a)u(this,zt).has(l.id)&&l.translateInPage(s,i)},undo:()=>{for(const l of a)u(this,zt).has(l.id)&&l.translateInPage(-s,-i)},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),S(this,Ls,new Map);for(const e of u(this,Ue))u(this,Ls).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,Ls))return!1;this.disableUserSelect(!1);const e=u(this,Ls);S(this,Ls,null);let t=!1;for(const[{x:s,y:i,pageIndex:a},o]of e)o.newX=s,o.newY=i,o.newPageIndex=a,t||(t=s!==o.savedX||i!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const n=(s,i,a,o)=>{if(u(this,zt).has(s.id)){const l=u(this,Zt).get(o);l?s._setParentAndPosition(l,i,a):(s.pageIndex=o,s.x=i,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:i,newY:a,newPageIndex:o}]of e)n(s,i,a,o)},undo:()=>{for(const[s,{savedX:i,savedY:a,savedPageIndex:o}]of e)n(s,i,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(u(this,Ls))for(const n of u(this,Ls).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||u(this,Ue).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return u(this,sn)===e}getActive(){return u(this,sn)}getMode(){return u(this,Vt)}get imageManager(){return Ce(this,"imageManager",new l4)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:n,y:s,width:i,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,d,f)=>({x:(h-s)/a,y:1-(c+d-n)/i,width:f/a,height:d/i});break;case"180":o=(c,h,d,f)=>({x:1-(c+d-n)/i,y:1-(h+f-s)/a,width:d/i,height:f/a});break;case"270":o=(c,h,d,f)=>({x:1-(h+f-s)/a,y:(c-n)/i,width:f/a,height:d/i});break;default:o=(c,h,d,f)=>({x:(c-n)/i,y:(h-s)/a,width:d/i,height:f/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const d=t.getRangeAt(c);if(!d.collapsed)for(const{x:f,y:p,width:g,height:w}of d.getClientRects())g===0||w===0||l.push(o(f,p,g,w))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(u(this,tc)||S(this,tc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=u(this,tc))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=u(this,tc))==null?void 0:s.get(e.data.id);if(!t)return;const n=u(this,wi).getRawValue(t);n&&(u(this,Vt)===xe.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}};Zu=new WeakMap,sn=new WeakMap,zt=new WeakMap,Zt=new WeakMap,ec=new WeakMap,wi=new WeakMap,tc=new WeakMap,On=new WeakMap,xa=new WeakMap,Ko=new WeakMap,rc=new WeakMap,Xo=new WeakMap,Ls=new WeakMap,ls=new WeakMap,Yo=new WeakMap,K0=new WeakMap,X0=new WeakMap,nc=new WeakMap,Y0=new WeakMap,Ds=new WeakMap,Aa=new WeakMap,sc=new WeakMap,Ea=new WeakMap,Fs=new WeakMap,Ym=new WeakMap,ka=new WeakMap,Q0=new WeakMap,Ta=new WeakMap,Qo=new WeakMap,J0=new WeakMap,Z0=new WeakMap,Vt=new WeakMap,Ue=new WeakMap,bi=new WeakMap,Jo=new WeakMap,ed=new WeakMap,td=new WeakMap,Ca=new WeakMap,zs=new WeakMap,Si=new WeakMap,rd=new WeakMap,Nn=new WeakMap,X=new WeakSet,Pp=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},c4=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of u(this,Zt).values())if(n.hasTextLayer(e))return n;return null},$8=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=k(this,X,Pp).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(u(this,Fs)||S(this,Fs,new bC(this)),u(this,Fs).show(n,s,this.direction==="ltr"))},U8=function(){var i,a,o;const e=document.getSelection();if(!e||e.isCollapsed){u(this,bi)&&((i=u(this,Fs))==null||i.hide(),S(this,bi,null),k(this,X,Er).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===u(this,bi))return;const s=k(this,X,Pp).call(this,e).closest(".textLayer");if(!s){u(this,bi)&&((a=u(this,Fs))==null||a.hide(),S(this,bi,null),k(this,X,Er).call(this,{hasSelectedText:!1}));return}if((o=u(this,Fs))==null||o.hide(),S(this,bi,t),k(this,X,Er).call(this,{hasSelectedText:!0}),!(u(this,Vt)!==xe.HIGHLIGHT&&u(this,Vt)!==xe.NONE)&&(u(this,Vt)===xe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),S(this,Ea,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=u(this,Vt)===xe.HIGHLIGHT?k(this,X,c4).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),f.type==="pointerup"&&k(this,X,Mp).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},Mp=function(e=""){u(this,Vt)===xe.HIGHLIGHT?this.highlightSelection(e):u(this,K0)&&k(this,X,$8).call(this)},H8=function(){document.addEventListener("selectionchange",k(this,X,U8).bind(this),{signal:this._signal})},q8=function(){if(u(this,Aa))return;S(this,Aa,new AbortController);const e=this.combinedSignal(u(this,Aa));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},V8=function(){var e;(e=u(this,Aa))==null||e.abort(),S(this,Aa,null)},h4=function(){if(u(this,Ta))return;S(this,Ta,new AbortController);const e=this.combinedSignal(u(this,Ta));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},G8=function(){var e;(e=u(this,Ta))==null||e.abort(),S(this,Ta,null)},d4=function(){if(u(this,xa))return;S(this,xa,new AbortController);const e=this.combinedSignal(u(this,xa));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},f4=function(){var e;(e=u(this,xa))==null||e.abort(),S(this,xa,null)},W8=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Er=function(e){Object.entries(e).some(([n,s])=>u(this,td)[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,td),e)}),u(this,Vt)===xe.HIGHLIGHT&&e.hasSelectedEditor===!1&&k(this,X,hi).call(this,[[Me.HIGHLIGHT_FREE,!0]]))},hi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},K8=async function(){if(!u(this,ka)){S(this,ka,!0);const e=[];for(const t of u(this,Zt).values())e.push(t.enable());await Promise.all(e);for(const t of u(this,zt).values())t.enable()}},X8=function(){if(this.unselectAll(),u(this,ka)){S(this,ka,!1);for(const e of u(this,Zt).values())e.disable();for(const e of u(this,zt).values())e.disable()}},p4=function(e){const t=u(this,Zt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Y8=function(){let e=null;for(e of u(this,Ue));return e},zh=function(){if(u(this,zt).size===0)return!0;if(u(this,zt).size===1)for(const e of u(this,zt).values())return e.isEmpty();return!1},m4=function(e){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear();for(const t of e)t.isEmpty()||(u(this,Ue).add(t),t.select());k(this,X,Er).call(this,{hasSelectedEditor:this.hasSelection})},he(Bu,"TRANSLATE_SMALL",1),he(Bu,"TRANSLATE_BIG",10);let nu=Bu;var Gt,Bs,us,ic,js,an,ac,$s,qr,_i,Zo,Us,Ra,_s,Bh,Ip;const kr=class kr{constructor(e){E(this,_s);E(this,Gt,null);E(this,Bs,!1);E(this,us,null);E(this,ic,null);E(this,js,null);E(this,an,null);E(this,ac,!1);E(this,$s,null);E(this,qr,null);E(this,_i,null);E(this,Zo,null);E(this,Us,!1);S(this,qr,e),S(this,Us,e._uiManager.useNewAltTextFlow),u(kr,Ra)||S(kr,Ra,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){kr._l10n??(kr._l10n=e)}async render(){const e=S(this,us,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=S(this,ic,document.createElement("span"));e.append(t),u(this,Us)?(e.classList.add("new"),e.setAttribute("data-l10n-id",u(kr,Ra).missing),t.setAttribute("data-l10n-id",u(kr,Ra)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=u(this,qr)._uiManager._signal;e.addEventListener("contextmenu",ks,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const s=i=>{i.preventDefault(),u(this,qr)._uiManager.editAltText(u(this,qr)),u(this,Us)&&u(this,qr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,_s,Bh)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(S(this,ac,!0),s(i))},{signal:n}),await k(this,_s,Ip).call(this),e}finish(){u(this,us)&&(u(this,us).focus({focusVisible:u(this,ac)}),S(this,ac,!1))}isEmpty(){return u(this,Us)?u(this,Gt)===null:!u(this,Gt)&&!u(this,Bs)}hasData(){return u(this,Us)?u(this,Gt)!==null||!!u(this,_i):this.isEmpty()}get guessedText(){return u(this,_i)}async setGuessedText(e){u(this,Gt)===null&&(S(this,_i,e),S(this,Zo,await kr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),k(this,_s,Ip).call(this))}toggleAltTextBadge(e=!1){var t;if(!u(this,Us)||u(this,Gt)){(t=u(this,$s))==null||t.remove(),S(this,$s,null);return}if(!u(this,$s)){const n=S(this,$s,document.createElement("div"));n.className="noAltTextBadge",u(this,qr).div.append(n)}u(this,$s).classList.toggle("hidden",!e)}serialize(e){let t=u(this,Gt);return!e&&u(this,_i)===t&&(t=u(this,Zo)),{altText:t,decorative:u(this,Bs),guessedText:u(this,_i),textWithDisclaimer:u(this,Zo)}}get data(){return{altText:u(this,Gt),decorative:u(this,Bs)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:i=!1}){n&&(S(this,_i,n),S(this,Zo,s)),!(u(this,Gt)===e&&u(this,Bs)===t)&&(i||(S(this,Gt,e),S(this,Bs,t)),k(this,_s,Ip).call(this))}toggle(e=!1){u(this,us)&&(!e&&u(this,an)&&(clearTimeout(u(this,an)),S(this,an,null)),u(this,us).disabled=!e)}shown(){u(this,qr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,_s,Bh)}})}destroy(){var e,t;(e=u(this,us))==null||e.remove(),S(this,us,null),S(this,ic,null),S(this,js,null),(t=u(this,$s))==null||t.remove(),S(this,$s,null)}};Gt=new WeakMap,Bs=new WeakMap,us=new WeakMap,ic=new WeakMap,js=new WeakMap,an=new WeakMap,ac=new WeakMap,$s=new WeakMap,qr=new WeakMap,_i=new WeakMap,Zo=new WeakMap,Us=new WeakMap,Ra=new WeakMap,_s=new WeakSet,Bh=function(){return u(this,Gt)&&"added"||u(this,Gt)===null&&this.guessedText&&"review"||"missing"},Ip=async function(){var s,i,a;const e=u(this,us);if(!e)return;if(u(this,Us)){if(e.classList.toggle("done",!!u(this,Gt)),e.setAttribute("data-l10n-id",u(kr,Ra)[u(this,_s,Bh)]),(s=u(this,ic))==null||s.setAttribute("data-l10n-id",u(kr,Ra)[`${u(this,_s,Bh)}-label`]),!u(this,Gt)){(i=u(this,js))==null||i.remove();return}}else{if(!u(this,Gt)&&!u(this,Bs)){e.classList.remove("done"),(a=u(this,js))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=u(this,js);if(!t){S(this,js,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${u(this,qr).id}`;const o=100,l=u(this,qr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(u(this,an)),S(this,an,null)},{once:!0}),e.addEventListener("mouseenter",()=>{S(this,an,setTimeout(()=>{S(this,an,null),u(this,js).classList.add("show"),u(this,qr)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;u(this,an)&&(clearTimeout(u(this,an)),S(this,an,null)),(c=u(this,js))==null||c.classList.remove("show")},{signal:l})}u(this,Bs)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=u(this,Gt)),t.parentNode||e.append(t);const n=u(this,qr).getImageForAltText();n==null||n.setAttribute("aria-describedby",t.id)},E(kr,Ra,null),he(kr,"_l10n",null);let Lm=kr;var nd,el,sd,id,ad,od,ld,oc,xi,tl,Pa,ia,Q8,J8,g4;const a3=class a3{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:i=null,onPinchEnd:a=null,signal:o}){E(this,ia);E(this,nd);E(this,el,!1);E(this,sd,null);E(this,id);E(this,ad);E(this,od);E(this,ld);E(this,oc);E(this,xi,null);E(this,tl);E(this,Pa,null);S(this,nd,e),S(this,sd,n),S(this,id,t),S(this,ad,s),S(this,od,i),S(this,ld,a),S(this,tl,new AbortController),S(this,oc,AbortSignal.any([o,u(this,tl).signal])),e.addEventListener("touchstart",k(this,ia,Q8).bind(this),{passive:!1,signal:u(this,oc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ce(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=u(this,tl))==null||e.abort(),S(this,tl,null)}};nd=new WeakMap,el=new WeakMap,sd=new WeakMap,id=new WeakMap,ad=new WeakMap,od=new WeakMap,ld=new WeakMap,oc=new WeakMap,xi=new WeakMap,tl=new WeakMap,Pa=new WeakMap,ia=new WeakSet,Q8=function(e){var s,i,a;if((s=u(this,id))!=null&&s.call(this)||e.touches.length<2)return;if(!u(this,Pa)){S(this,Pa,new AbortController);const o=AbortSignal.any([u(this,oc),u(this,Pa).signal]),l=u(this,nd),c={signal:o,passive:!1};l.addEventListener("touchmove",k(this,ia,J8).bind(this),c),l.addEventListener("touchend",k(this,ia,g4).bind(this),c),l.addEventListener("touchcancel",k(this,ia,g4).bind(this),c),(i=u(this,ad))==null||i.call(this)}if(_n(e),e.touches.length!==2||(a=u(this,sd))!=null&&a.call(this)){S(this,xi,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),S(this,xi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},J8=function(e){var C;if(!u(this,xi)||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:i}=t,{screenX:a,screenY:o}=n,l=u(this,xi),{touch0X:c,touch0Y:h,touch1X:d,touch1Y:f}=l,p=d-c,g=f-h,w=a-s,x=o-i,y=Math.hypot(w,x)||1,b=Math.hypot(p,g)||1;if(!u(this,el)&&Math.abs(b-y)<=a3.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=i,l.touch1X=a,l.touch1Y=o,e.preventDefault(),!u(this,el)){S(this,el,!0);return}const _=[(s+a)/2,(i+o)/2];(C=u(this,od))==null||C.call(this,_,b,y)},g4=function(e){var t;u(this,Pa).abort(),S(this,Pa,null),(t=u(this,ld))==null||t.call(this),u(this,xi)&&(e.preventDefault(),S(this,xi,null),S(this,el,!1))};let Dm=a3;var rl,cs,rt,lc,Ma,ud,nl,er,sl,Ai,Ia,cd,il,on,hd,al,Ei,Hs,uc,cc,Ln,ol,dd,Qm,me,v4,fd,y4,Op,Z8,eS,w4,Np,b4,tS,rS,nS,S4,sS,_4,iS,aS,oS,x4,jh;const ke=class ke{constructor(e){E(this,me);E(this,rl,null);E(this,cs,null);E(this,rt,null);E(this,lc,!1);E(this,Ma,null);E(this,ud,"");E(this,nl,!1);E(this,er,null);E(this,sl,null);E(this,Ai,null);E(this,Ia,null);E(this,cd,"");E(this,il,!1);E(this,on,null);E(this,hd,!1);E(this,al,!1);E(this,Ei,!1);E(this,Hs,null);E(this,uc,0);E(this,cc,0);E(this,Ln,null);E(this,ol,null);he(this,"_editToolbar",null);he(this,"_initialOptions",Object.create(null));he(this,"_initialData",null);he(this,"_isVisible",!0);he(this,"_uiManager",null);he(this,"_focusEventsAllowed",!0);E(this,dd,!1);E(this,Qm,ke._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[i,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ke.prototype._resizeWithKeyboard,t=nu.TRANSLATE_SMALL,n=nu.TRANSLATE_BIG;return Ce(this,"_resizerKeyboardManager",new _f([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],ke.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ce(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new xC({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ke._l10n??(ke._l10n=e),ke._l10nResizer||(ke._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ke._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);ke._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ke("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,dd)}set _isDraggable(e){var t;S(this,dd,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,Qm)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):k(this,me,jh).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(u(this,il)?S(this,il,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[i,a]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/i,this.y=(t+s)/a,this.fixAndSetPosition()}translate(e,t){k(this,me,v4).call(this,this.parentDimensions,e,t)}translateInPage(e,t){u(this,on)||S(this,on,[this.x,this.y,this.width,this.height]),k(this,me,v4).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){u(this,on)||S(this,on,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,i]}=this;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=n;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!u(this,on)&&(u(this,on)[0]!==this.x||u(this,on)[1]!==this.y)}get _hasBeenResized(){return!!u(this,on)&&(u(this,on)[2]!==this.width||u(this,on)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=ke,s=n/e,i=n/t;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:i,y:a,width:o,height:l}=this;if(o*=n,l*=s,i*=n,a*=s,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(n-o,i)),a=Math.max(0,Math.min(s-l,a));break;case 90:i=Math.max(0,Math.min(n-l,i)),a=Math.min(s,Math.max(o,a));break;case 180:i=Math.min(n,Math.max(o,i)),a=Math.min(s,Math.max(l,a));break;case 270:i=Math.min(n,Math.max(l,i)),a=Math.max(0,Math.min(s-o,a));break}this.x=i/=n,this.y=a/=s;const[c,h]=this.getBaseTranslation();i+=c,a+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return k(n=ke,fd,y4).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return k(n=ke,fd,y4).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,s]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/n).toFixed(2)}%`,u(this,nl)||(i.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,s=n.endsWith("%"),i=!u(this,nl)&&t.endsWith("%");if(s&&i)return;const[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(n)/a).toFixed(2)}%`),!u(this,nl)&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=u(this,rt))==null||e.finish()}async addEditToolbar(){return this._editToolbar||u(this,al)?this._editToolbar:(this._editToolbar=new a4(this),this.div.append(this._editToolbar.render()),u(this,rt)&&await this._editToolbar.addAltText(u(this,rt)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=u(this,rt))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){u(this,rt)||(Lm.initialize(ke._l10n),S(this,rt,new Lm(this)),u(this,rl)&&(u(this,rt).data=u(this,rl),S(this,rl,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=u(this,rt))==null?void 0:e.data}set altTextData(e){u(this,rt)&&(u(this,rt).data=e)}get guessedAltText(){var e;return(e=u(this,rt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=u(this,rt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=u(this,rt))==null?void 0:t.serialize(e)}hasAltText(){return!!u(this,rt)&&!u(this,rt).isEmpty()}hasAltTextData(){var e;return((e=u(this,rt))==null?void 0:e.hasData())??!1}render(){var i;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=u(this,lc)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),k(this,me,_4).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,s]=this.getInitialTranslation();return this.translate(n,s),Nm(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(u(this,ol)||S(this,ol,new Dm({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:k(this,me,tS).bind(this),onPinching:k(this,me,rS).bind(this),onPinchEnd:k(this,me,nS).bind(this),signal:this._uiManager._signal}))),(i=this._uiManager._editorUndoBar)==null||i.hide(),this.div}pointerdown(e){const{isMac:t}=Nr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(S(this,il,!0),this._isDraggable){k(this,me,sS).call(this,e);return}k(this,me,S4).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,Hs)&&clearTimeout(u(this,Hs)),S(this,Hs,setTimeout(()=>{var e;S(this,Hs,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[i,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/s,h=t/s,d=this.x*i,f=this.y*a,p=this.width*i,g=this.height*a;switch(n){case 0:return[d+c+o,a-f-h-g+l,d+c+p+o,a-f-h+l];case 90:return[d+h+o,a-f+c+l,d+h+g+o,a-f+c+p+l];case 180:return[d-c-p+o,a-f+h+l,d-c+o,a-f+h+g+l];case 270:return[d-h-g+o,a-f-c-p+l,d-h+o,a-f-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,i,a]=e,o=i-n,l=a-s;switch(this.rotation){case 0:return[n,t-a,o,l];case 90:return[n,t-s,l,o];case 180:return[i,t-s,o,l];case 270:return[i,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){S(this,al,!0)}disableEditMode(){S(this,al,!1)}isInEditMode(){return u(this,al)}shouldGetKeyboardEvents(){return u(this,Ei)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&s>0&&e<i&&n>0}rebuild(){k(this,me,_4).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Ke("An editor must be serializable")}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});s.rotation=e.rotation,S(s,rl,e.accessibilityData);const[i,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/i,s.y=l/a,s.width=c/i,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=u(this,Ia))==null||e.abort(),S(this,Ia,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),u(this,Hs)&&(clearTimeout(u(this,Hs)),S(this,Hs,null)),k(this,me,jh).call(this),this.removeEditToolbar(),u(this,Ln)){for(const n of u(this,Ln).values())clearTimeout(n);S(this,Ln,null)}this.parent=null,(t=u(this,ol))==null||t.destroy(),S(this,ol,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(k(this,me,Z8).call(this),u(this,er).classList.remove("hidden"),Nm(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),S(this,Ai,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=u(this,er).children;if(!u(this,cs)){S(this,cs,Array.from(t));const a=k(this,me,iS).bind(this),o=k(this,me,aS).bind(this),l=this._uiManager._signal;for(const c of u(this,cs)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",k(this,me,oS).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",ke._l10nResizer[h])}}const n=u(this,cs)[0];let s=0;for(const a of t){if(a===n)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(u(this,cs).length/4);if(i!==s){if(i<s)for(let o=0;o<s-i;o++)u(this,er).append(u(this,er).firstChild);else if(i>s)for(let o=0;o<i-s;o++)u(this,er).firstChild.before(u(this,er).lastChild);let a=0;for(const o of t){const c=u(this,cs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ke._l10nResizer[c])}}k(this,me,x4).call(this,0),S(this,Ei,!0),u(this,er).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){u(this,Ei)&&k(this,me,b4).call(this,u(this,cd),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){k(this,me,jh).call(this),this.div.focus()}select(){var e,t,n;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,i;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(n=u(this,rt))==null||n.toggleAltTextBadge(!1)}unselect(){var e,t,n,s,i;(e=u(this,er))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(i=u(this,rt))==null||i.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return u(this,hd)}set isEditing(e){S(this,hd,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){S(this,nl,!0);const n=e/t,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){u(this,Ln)||S(this,Ln,new Map);const{action:n}=e;let s=u(this,Ln).get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),u(this,Ln).delete(n),u(this,Ln).size===0&&S(this,Ln,null)},ke._telemetryTimeout),u(this,Ln).set(n,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),S(this,lc,!1)}disable(){this.div&&(this.div.tabIndex=-1),S(this,lc,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};rl=new WeakMap,cs=new WeakMap,rt=new WeakMap,lc=new WeakMap,Ma=new WeakMap,ud=new WeakMap,nl=new WeakMap,er=new WeakMap,sl=new WeakMap,Ai=new WeakMap,Ia=new WeakMap,cd=new WeakMap,il=new WeakMap,on=new WeakMap,hd=new WeakMap,al=new WeakMap,Ei=new WeakMap,Hs=new WeakMap,uc=new WeakMap,cc=new WeakMap,Ln=new WeakMap,ol=new WeakMap,dd=new WeakMap,Qm=new WeakMap,me=new WeakSet,v4=function([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},fd=new WeakSet,y4=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Op=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},Z8=function(){if(u(this,er))return;S(this,er,document.createElement("div")),u(this,er).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");u(this,er).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",k(this,me,eS).bind(this,n),{signal:t}),s.addEventListener("contextmenu",ks,{signal:t}),s.tabIndex=-1}this.div.prepend(u(this,er))},eS=function(e,t){var h;t.preventDefault();const{isMac:n}=Nr.platform;if(t.button!==0||t.ctrlKey&&n)return;(h=u(this,rt))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,S(this,sl,[t.screenX,t.screenY]);const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",k(this,me,b4).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",_n,{passive:!1,signal:a}),window.addEventListener("contextmenu",ks,{signal:a}),S(this,Ai,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var d;i.abort(),this.parent.togglePointerEvents(!0),(d=u(this,rt))==null||d.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,k(this,me,Np).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},w4=function(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t;const[i,a]=this.parentDimensions;this.setDims(i*n,a*s),this.fixAndSetPosition(),this._onResized()},Np=function(){if(!u(this,Ai))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=u(this,Ai);S(this,Ai,null);const i=this.x,a=this.y,o=this.width,l=this.height;i===e&&a===t&&o===n&&l===s||this.addCommands({cmd:k(this,me,w4).bind(this,i,a,o,l),undo:k(this,me,w4).bind(this,e,t,n,s),mustExec:!0})},b4=function(e,t){const[n,s]=this.parentDimensions,i=this.x,a=this.y,o=this.width,l=this.height,c=ke.MIN_SIZE/n,h=ke.MIN_SIZE/s,d=k(this,me,Op).call(this,this.rotation),f=(W,ne)=>[d[0]*W+d[2]*ne,d[1]*W+d[3]*ne],p=k(this,me,Op).call(this,360-this.rotation),g=(W,ne)=>[p[0]*W+p[2]*ne,p[1]*W+p[3]*ne];let w,x,y=!1,b=!1;switch(e){case"topLeft":y=!0,w=(W,ne)=>[0,0],x=(W,ne)=>[W,ne];break;case"topMiddle":w=(W,ne)=>[W/2,0],x=(W,ne)=>[W/2,ne];break;case"topRight":y=!0,w=(W,ne)=>[W,0],x=(W,ne)=>[0,ne];break;case"middleRight":b=!0,w=(W,ne)=>[W,ne/2],x=(W,ne)=>[0,ne/2];break;case"bottomRight":y=!0,w=(W,ne)=>[W,ne],x=(W,ne)=>[0,0];break;case"bottomMiddle":w=(W,ne)=>[W/2,ne],x=(W,ne)=>[W/2,0];break;case"bottomLeft":y=!0,w=(W,ne)=>[0,ne],x=(W,ne)=>[W,0];break;case"middleLeft":b=!0,w=(W,ne)=>[0,ne/2],x=(W,ne)=>[W,ne/2];break}const _=w(o,l),C=x(o,l);let R=f(...C);const I=ke._round(i+R[0]),O=ke._round(a+R[1]);let D=1,B=1,q,K;if(t.fromKeyboard)({deltaX:q,deltaY:K}=t);else{const{screenX:W,screenY:ne}=t,[V,le]=u(this,sl);[q,K]=this.screenToPageTranslation(W-V,ne-le),u(this,sl)[0]=W,u(this,sl)[1]=ne}if([q,K]=g(q/n,K/s),y){const W=Math.hypot(o,l);D=B=Math.max(Math.min(Math.hypot(C[0]-_[0]-q,C[1]-_[1]-K)/W,1/o,1/l),c/o,h/l)}else b?D=Math.max(c,Math.min(1,Math.abs(C[0]-_[0]-q)))/o:B=Math.max(h,Math.min(1,Math.abs(C[1]-_[1]-K)))/l;const de=ke._round(o*D),Re=ke._round(l*B);R=f(...x(de,Re));const ge=I-R[0],Be=O-R[1];u(this,on)||S(this,on,[this.x,this.y,this.width,this.height]),this.width=de,this.height=Re,this.x=ge,this.y=Be,this.setDims(n*de,s*Re),this.fixAndSetPosition(),this._onResizing()},tS=function(){var e;S(this,Ai,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=u(this,rt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},rS=function(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const a=k(this,me,Op).call(this,this.rotation),o=(I,O)=>[a[0]*I+a[2]*O,a[1]*I+a[3]*O],[l,c]=this.parentDimensions,h=this.x,d=this.y,f=this.width,p=this.height,g=ke.MIN_SIZE/l,w=ke.MIN_SIZE/c;i=Math.max(Math.min(i,1/f,1/p),g/f,w/p);const x=ke._round(f*i),y=ke._round(p*i);if(x===f&&y===p)return;u(this,on)||S(this,on,[h,d,f,p]);const b=o(f/2,p/2),_=ke._round(h+b[0]),C=ke._round(d+b[1]),R=o(x/2,y/2);this.x=_-R[0],this.y=C-R[1],this.width=x,this.height=y,this.setDims(l*x,c*y),this.fixAndSetPosition(),this._onResizing()},nS=function(){var e;(e=u(this,rt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),k(this,me,Np).call(this)},S4=function(e){const{isMac:t}=Nr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},sS=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:i},o=c=>{s.abort(),S(this,Ma,null),S(this,il,!1),this._uiManager.endDragSession()||k(this,me,S4).call(this,c),n&&this._onStopDragging()};t&&(S(this,uc,e.clientX),S(this,cc,e.clientY),S(this,Ma,e.pointerId),S(this,ud,e.pointerType),window.addEventListener("pointermove",c=>{n||(n=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=c;if(f!==u(this,Ma)){_n(c);return}const[p,g]=this.screenToPageTranslation(h-u(this,uc),d-u(this,cc));S(this,uc,h),S(this,cc,d),this._uiManager.dragSelectedEditors(p,g)},a),window.addEventListener("touchmove",_n,a),window.addEventListener("pointerdown",c=>{c.pointerType===u(this,ud)&&(u(this,ol)||c.isPrimary)&&o(c),_n(c)},a));const l=c=>{if(!u(this,Ma)||u(this,Ma)===c.pointerId){o(c);return}_n(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},_4=function(){if(u(this,Ia)||!this.div)return;S(this,Ia,new AbortController);const e=this._uiManager.combinedSignal(u(this,Ia));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},iS=function(e){ke._resizerKeyboardManager.exec(this,e)},aS=function(e){var t;u(this,Ei)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==u(this,er)&&k(this,me,jh).call(this)},oS=function(e){S(this,cd,u(this,Ei)?e:"")},x4=function(e){if(u(this,cs))for(const t of u(this,cs))t.tabIndex=e},jh=function(){S(this,Ei,!1),k(this,me,x4).call(this,-1),k(this,me,Np).call(this)},E(ke,fd),he(ke,"_l10n",null),he(ke,"_l10nResizer",null),he(ke,"_borderLineWidth",-1),he(ke,"_colorManager",new u4),he(ke,"_zIndex",1),he(ke,"_telemetryTimeout",1e3);let gt=ke;class xC extends gt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const pw=3285377520,In=4294901760,Is=65535;class lS{constructor(e){this.h1=e?e&4294967295:pw,this.h2=e?e&4294967295:pw}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let w=0,x=e.length;w<x;w++){const y=e.charCodeAt(w);y<=255?t[n++]=y:(t[n++]=y>>>8,t[n++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,i=n-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const d=3432918353,f=461845907,p=d&Is,g=f&Is;for(let w=0;w<s;w++)w&1?(o=a[w],o=o*d&In|o*p&Is,o=o<<15|o>>>17,o=o*f&In|o*g&Is,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[w],l=l*d&In|l*p&Is,l=l<<15|l>>>17,l=l*f&In|l*g&Is,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*d&In|o*p&Is,o=o<<15|o>>>17,o=o*f&In|o*g&Is,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&In|e*36045&Is,t=t*4283543511&In|((t<<16|e>>>16)*2950163797&In)>>>16,e^=t>>>1,e=e*444984403&In|e*60499&Is,t=t*3301882366&In|((t<<16|e>>>16)*3120437893&In)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const A4=Object.freeze({map:null,hash:"",transfer:void 0});var ll,ul,Wt,Jm,uS;class L2{constructor(){E(this,Jm);E(this,ll,!1);E(this,ul,null);E(this,Wt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=u(this,Wt).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return u(this,Wt).get(e)}remove(e){if(u(this,Wt).delete(e),u(this,Wt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of u(this,Wt).values())if(t instanceof gt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=u(this,Wt).get(e);let s=!1;if(n!==void 0)for(const[i,a]of Object.entries(t))n[i]!==a&&(s=!0,n[i]=a);else s=!0,u(this,Wt).set(e,t);s&&k(this,Jm,uS).call(this),t instanceof gt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return u(this,Wt).has(e)}getAll(){return u(this,Wt).size>0?R2(u(this,Wt)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return u(this,Wt).size}resetModified(){u(this,ll)&&(S(this,ll,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new cS(this)}get serializable(){if(u(this,Wt).size===0)return A4;const e=new Map,t=new lS,n=[],s=Object.create(null);let i=!1;for(const[a,o]of u(this,Wt)){const l=o instanceof gt?o.serialize(!1,s):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:A4}get editorStats(){let e=null;const t=new Map;for(const n of u(this,Wt).values()){if(!(n instanceof gt))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:i}=s;t.has(i)||t.set(i,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const a=e[i]||(e[i]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[n,s]of t)e[n]=s.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){S(this,ul,null)}get modifiedIds(){if(u(this,ul))return u(this,ul);const e=[];for(const t of u(this,Wt).values())!(t instanceof gt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return S(this,ul,{ids:new Set(e),hash:e.join(",")})}}ll=new WeakMap,ul=new WeakMap,Wt=new WeakMap,Jm=new WeakSet,uS=function(){u(this,ll)||(S(this,ll,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var pd;class cS extends L2{constructor(t){super();E(this,pd);const{map:n,hash:s,transfer:i}=t.serializable,a=structuredClone(n,i?{transfer:i}:null);S(this,pd,{map:a,hash:s,transfer:i})}get print(){Ke("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,pd)}get modifiedIds(){return Ce(this,"modifiedIds",{ids:new Set,hash:""})}}pd=new WeakMap;var hc;class AC{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){E(this,hc,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),u(this,hc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||u(this,hc).has(e.loadedName))){if(It(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:s,style:i}=e,a=new FontFace(n,s,i);this.addNativeFontFace(a);try{await a.load(),u(this,hc).add(n),t==null||t(e)}catch{Ae(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ke("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Ae(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ce(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Sr||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ce(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(It(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ce(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(C,R){return C.charCodeAt(R)<<24|C.charCodeAt(R+1)<<16|C.charCodeAt(R+2)<<8|C.charCodeAt(R+3)&255}function s(C,R,I,O){const D=C.substring(0,R),B=C.substring(R+I);return D+O+B}let i,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(C,R){if(++c>30){Ae("Load test font never loaded."),R();return}if(l.font="30px "+C,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(h.bind(null,C,R))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=s(f,976,d.length,d);const g=16,w=1482184792;let x=n(f,g);for(i=0,a=d.length-3;i<a;i+=4)x=x-w+n(d,i)|0;i<d.length&&(x=x-w+n(d+"XXX",i)|0),f=s(f,g,4,uC(x));const y=`url(data:font/opentype;base64,${btoa(f)});`,b=`@font-face {font-family:"${d}";src:${y}}`;this.insertRule(b);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const C of[e.loadedName,d]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=C,_.append(R)}this._document.body.append(_),h(d,()=>{_.remove(),t.complete()})}}hc=new WeakMap;class EC{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${mC(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(a){Ae(`getPathGenerator - ignoring character: "${a}".`)}const i=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}}const ep={DATA:1,ERROR:2},Rt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function mw(){}function Ur(r){if(r instanceof fo||r instanceof n4||r instanceof F0||r instanceof hw||r instanceof Om||r instanceof Cg)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Ke('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new fo(r.message);case"InvalidPDFException":return new n4(r.message);case"MissingPDFException":return new F0(r.message);case"PasswordException":return new hw(r.message,r.code);case"UnexpectedResponseException":return new Om(r.message,r.status);case"UnknownErrorException":return new Cg(r.message,r.details)}return new Cg(r.message,r.toString())}var dc,Kn,hS,dS,fS,Lp;class $h{constructor(e,t,n){E(this,Kn);E(this,dc,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",k(this,Kn,hS).bind(this),{signal:u(this,dc).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,n,s){const i=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Rt.PULL,streamId:i,desiredSize:c.desiredSize}),h.promise},cancel:c=>{It(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Rt.CANCEL,streamId:i,reason:Ur(c)}),h.promise}},n)}destroy(){var e;(e=u(this,dc))==null||e.abort(),S(this,dc,null)}}dc=new WeakMap,Kn=new WeakSet,hS=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){k(this,Kn,fS).call(this,e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===ep.DATA)s.resolve(e.data);else if(e.callback===ep.ERROR)s.reject(Ur(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(a){i.postMessage({sourceName:n,targetName:s,callback:ep.DATA,callbackId:e.callbackId,data:a})},function(a){i.postMessage({sourceName:n,targetName:s,callback:ep.ERROR,callbackId:e.callbackId,reason:Ur(a)})});return}if(e.streamId){k(this,Kn,dS).call(this,e);return}t(e.data)},dS=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:s,stream:Rt.ENQUEUE,streamId:t,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:Rt.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){It(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:Rt.ERROR,streamId:t,reason:Ur(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:n,targetName:s,stream:Rt.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:s,stream:Rt.START_COMPLETE,streamId:t,reason:Ur(c)})})},fS=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Rt.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Ur(e.reason));break;case Rt.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Ur(e.reason));break;case Rt.PULL:if(!o){i.postMessage({sourceName:n,targetName:s,stream:Rt.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||mw).then(function(){i.postMessage({sourceName:n,targetName:s,stream:Rt.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:s,stream:Rt.PULL_COMPLETE,streamId:t,reason:Ur(c)})});break;case Rt.ENQUEUE:if(It(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Rt.CLOSE:if(It(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),k(this,Kn,Lp).call(this,a,t);break;case Rt.ERROR:It(a,"error should have stream controller"),a.controller.error(Ur(e.reason)),k(this,Kn,Lp).call(this,a,t);break;case Rt.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Ur(e.reason)),k(this,Kn,Lp).call(this,a,t);break;case Rt.CANCEL:if(!o)break;const l=Ur(e.reason);Promise.try(o.onCancel||mw,l).then(function(){i.postMessage({sourceName:n,targetName:s,stream:Rt.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:s,stream:Rt.CANCEL_COMPLETE,streamId:t,reason:Ur(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Lp=async function(e,t){var n,s,i;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(s=e.pullCall)==null?void 0:s.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var md;class pS{constructor({enableHWA:e=!1}){E(this,md,!1);S(this,md,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!u(this,md)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ke("Abstract method `_createCanvas` called.")}}md=new WeakMap;class kC extends pS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class mS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ke("Abstract method `_fetch` called.")}}class gS extends mS{async _fetch(e){const t=await O1(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):I1(t)}}class vS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,i){return"none"}destroy(e=!1){}}var cl,fc,ki,Ti,gr,hl,dl,J,dr,Uh,bu,Dp,Su,yS,E4,_u,Hh,qh,k4,Vh;class TC extends vS{constructor({docId:t,ownerDocument:n=globalThis.document}){super();E(this,J);E(this,cl);E(this,fc);E(this,ki);E(this,Ti);E(this,gr);E(this,hl);E(this,dl,0);S(this,Ti,t),S(this,gr,n)}addFilter(t){if(!t)return"none";let n=u(this,J,dr).get(t);if(n)return n;const[s,i,a]=k(this,J,Dp).call(this,t),o=t.length===1?s:`${s}${i}${a}`;if(n=u(this,J,dr).get(o),n)return u(this,J,dr).set(t,n),n;const l=`g_${u(this,Ti)}_transfer_map_${xr(this,dl)._++}`,c=k(this,J,Su).call(this,l);u(this,J,dr).set(t,c),u(this,J,dr).set(o,c);const h=k(this,J,_u).call(this,l);return k(this,J,qh).call(this,s,i,a,h),c}addHCMFilter(t,n){var g;const s=`${t}-${n}`,i="base";let a=u(this,J,Uh).get(i);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},u(this,J,Uh).set(i,a)),!t||!n))return a.url;const o=k(this,J,Vh).call(this,t);t=ue.makeHexColor(...o);const l=k(this,J,Vh).call(this,n);if(n=ue.makeHexColor(...l),u(this,J,bu).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return a.url;const c=new Array(256);for(let w=0;w<=255;w++){const x=w/255;c[w]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const h=c.join(","),d=`g_${u(this,Ti)}_hcm_filter`,f=a.filter=k(this,J,_u).call(this,d);k(this,J,qh).call(this,h,h,h,f),k(this,J,E4).call(this,f);const p=(w,x)=>{const y=o[w]/255,b=l[w]/255,_=new Array(x+1);for(let C=0;C<=x;C++)_[C]=y+C/x*(b-y);return _.join(",")};return k(this,J,qh).call(this,p(0,5),p(1,5),p(2,5),f),a.url=k(this,J,Su).call(this,d),a.url}addAlphaFilter(t){let n=u(this,J,dr).get(t);if(n)return n;const[s]=k(this,J,Dp).call(this,[t]),i=`alpha_${s}`;if(n=u(this,J,dr).get(i),n)return u(this,J,dr).set(t,n),n;const a=`g_${u(this,Ti)}_alpha_map_${xr(this,dl)._++}`,o=k(this,J,Su).call(this,a);u(this,J,dr).set(t,o),u(this,J,dr).set(i,o);const l=k(this,J,_u).call(this,a);return k(this,J,k4).call(this,s,l),o}addLuminosityFilter(t){let n=u(this,J,dr).get(t||"luminosity");if(n)return n;let s,i;if(t?([s]=k(this,J,Dp).call(this,[t]),i=`luminosity_${s}`):i="luminosity",n=u(this,J,dr).get(i),n)return u(this,J,dr).set(t,n),n;const a=`g_${u(this,Ti)}_luminosity_map_${xr(this,dl)._++}`,o=k(this,J,Su).call(this,a);u(this,J,dr).set(t,o),u(this,J,dr).set(i,o);const l=k(this,J,_u).call(this,a);return k(this,J,yS).call(this,l),t&&k(this,J,k4).call(this,s,l),o}addHighlightHCMFilter(t,n,s,i,a){var b;const o=`${n}-${s}-${i}-${a}`;let l=u(this,J,Uh).get(t);if((l==null?void 0:l.key)===o||(l?((b=l.filter)==null||b.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},u(this,J,Uh).set(t,l)),!n||!s))return l.url;const[c,h]=[n,s].map(k(this,J,Vh).bind(this));let d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,g]=[i,a].map(k(this,J,Vh).bind(this));f<d&&([d,f,p,g]=[f,d,g,p]),u(this,J,bu).style.color="";const w=(_,C,R)=>{const I=new Array(256),O=(f-d)/R,D=_/255,B=(C-_)/(255*R);let q=0;for(let K=0;K<=R;K++){const de=Math.round(d+K*O),Re=D+K*B;for(let ge=q;ge<=de;ge++)I[ge]=Re;q=de+1}for(let K=q;K<256;K++)I[K]=I[q-1];return I.join(",")},x=`g_${u(this,Ti)}_hcm_${t}_filter`,y=l.filter=k(this,J,_u).call(this,x);return k(this,J,E4).call(this,y),k(this,J,qh).call(this,w(p[0],g[0],5),w(p[1],g[1],5),w(p[2],g[2],5),y),l.url=k(this,J,Su).call(this,x),l.url}destroy(t=!1){var n,s,i,a;t&&((n=u(this,hl))!=null&&n.size)||((s=u(this,ki))==null||s.parentNode.parentNode.remove(),S(this,ki,null),(i=u(this,fc))==null||i.clear(),S(this,fc,null),(a=u(this,hl))==null||a.clear(),S(this,hl,null),S(this,dl,0))}}cl=new WeakMap,fc=new WeakMap,ki=new WeakMap,Ti=new WeakMap,gr=new WeakMap,hl=new WeakMap,dl=new WeakMap,J=new WeakSet,dr=function(){return u(this,fc)||S(this,fc,new Map)},Uh=function(){return u(this,hl)||S(this,hl,new Map)},bu=function(){if(!u(this,ki)){const t=u(this,gr).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=u(this,gr).createElementNS(ci,"svg");s.setAttribute("width",0),s.setAttribute("height",0),S(this,ki,u(this,gr).createElementNS(ci,"defs")),t.append(s),s.append(u(this,ki)),u(this,gr).body.append(t)}return u(this,ki)},Dp=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=c[f]/255;const d=h.join(",");return[d,d,d]}const[n,s,i]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=n[c]/255,o[c]=s[c]/255,l[c]=i[c]/255;return[a.join(","),o.join(","),l.join(",")]},Su=function(t){if(u(this,cl)===void 0){S(this,cl,"");const n=u(this,gr).URL;n!==u(this,gr).baseURI&&(N1(n)?Ae('#createUrl: ignore "data:"-URL for performance reasons.'):S(this,cl,n.split("#",1)[0]))}return`url(${u(this,cl)}#${t})`},yS=function(t){const n=u(this,gr).createElementNS(ci,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},E4=function(t){const n=u(this,gr).createElementNS(ci,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},_u=function(t){const n=u(this,gr).createElementNS(ci,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),u(this,J,bu).append(n),n},Hh=function(t,n,s){const i=u(this,gr).createElementNS(ci,n);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),t.append(i)},qh=function(t,n,s,i){const a=u(this,gr).createElementNS(ci,"feComponentTransfer");i.append(a),k(this,J,Hh).call(this,a,"feFuncR",t),k(this,J,Hh).call(this,a,"feFuncG",n),k(this,J,Hh).call(this,a,"feFuncB",s)},k4=function(t,n){const s=u(this,gr).createElementNS(ci,"feComponentTransfer");n.append(s),k(this,J,Hh).call(this,s,"feFuncA",t)},Vh=function(t){return u(this,J,bu).style.color=t,N2(getComputedStyle(u(this,J,bu)).getPropertyValue("color"))};class wS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ke("Abstract method `_fetch` called.")}}class bS extends wS{async _fetch(e){const t=await O1(e,"arraybuffer");return new Uint8Array(t)}}Sr&&Ae("Please use the `legacy` build in Node.js environments.");async function SS(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class CC extends vS{}class RC extends pS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class PC extends mS{async _fetch(e){return SS(e)}}class MC extends wS{async _fetch(e){return SS(e)}}const wr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function T4(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),r.clip(s)}class D2{getPattern(){Ke("Abstract method `getPattern` called.")}}class IC extends D2{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let i;if(s===wr.STROKE||s===wr.FILL){const a=t.current.getClippedPathBoundingBox(s,at(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),n=ue.transform(n,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),T4(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(n);i.setTransform(d)}else T4(e,this._bbox),i=this._createGradient(e);return i}}function Mg(r,e,t,n,s,i,a,o){const l=e.coords,c=e.colors,h=r.data,d=r.width*4;let f;l[t+1]>l[n+1]&&(f=t,t=n,n=f,f=i,i=a,a=f),l[n+1]>l[s+1]&&(f=n,n=s,s=f,f=a,a=o,o=f),l[t+1]>l[n+1]&&(f=t,t=n,n=f,f=i,i=a,a=f);const p=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,w=(l[n]+e.offsetX)*e.scaleX,x=(l[n+1]+e.offsetY)*e.scaleY,y=(l[s]+e.offsetX)*e.scaleX,b=(l[s+1]+e.offsetY)*e.scaleY;if(g>=b)return;const _=c[i],C=c[i+1],R=c[i+2],I=c[a],O=c[a+1],D=c[a+2],B=c[o],q=c[o+1],K=c[o+2],de=Math.round(g),Re=Math.round(b);let ge,Be,W,ne,V,le,re,Se;for(let ve=de;ve<=Re;ve++){if(ve<x){const F=ve<g?0:(g-ve)/(g-x);ge=p-(p-w)*F,Be=_-(_-I)*F,W=C-(C-O)*F,ne=R-(R-D)*F}else{let F;ve>b?F=1:x===b?F=0:F=(x-ve)/(x-b),ge=w-(w-y)*F,Be=I-(I-B)*F,W=O-(O-q)*F,ne=D-(D-K)*F}let De;ve<g?De=0:ve>b?De=1:De=(g-ve)/(g-b),V=p-(p-y)*De,le=_-(_-B)*De,re=C-(C-q)*De,Se=R-(R-K)*De;const Ct=Math.round(Math.min(ge,V)),qt=Math.round(Math.max(ge,V));let Ve=d*ve+Ct*4;for(let F=Ct;F<=qt;F++)De=(ge-F)/(ge-V),De<0?De=0:De>1&&(De=1),h[Ve++]=Be-(Be-le)*De|0,h[Ve++]=W-(W-re)*De|0,h[Ve++]=ne-(ne-Se)*De|0,h[Ve++]=255}}function OC(r,e,t){const n=e.coords,s=e.colors;let i,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,c=o-1;for(i=0;i<l;i++){let h=i*o;for(let d=0;d<c;d++,h++)Mg(r,t,n[h],n[h+1],n[h+o],s[h],s[h+1],s[h+o]),Mg(r,t,n[h+o+1],n[h+1],n[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(i=0,a=n.length;i<a;i+=3)Mg(r,t,n[i],n[i+1],n[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}class NC extends D2{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),p=c/d,g=h/f,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/g},x=d+2*2,y=f+2*2,b=n.getCanvas("mesh",x,y),_=b.context,C=_.createImageData(d,f);if(t){const I=C.data;for(let O=0,D=I.length;O<D;O+=4)I[O]=t[0],I[O+1]=t[1],I[O+2]=t[2],I[O+3]=255}for(const I of this._figures)OC(C,I,w);return _.putImageData(C,2,2),{canvas:b.canvas,offsetX:o-2*p,offsetY:l-2*g,scaleX:p,scaleY:g}}getPattern(e,t,n,s){T4(e,this._bbox);let i;if(s===wr.SHADING)i=ue.singularValueDecompose2dScale(at(e));else if(i=ue.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=ue.singularValueDecompose2dScale(this.matrix);i=[i[0]*o[0],i[1]*o[1]]}const a=this._createMeshCanvas(i,s===wr.SHADING?null:this._background,t.cachedCanvases);return s!==wr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class LC extends D2{getPattern(){return"hotpink"}}function DC(r){switch(r[0]){case"RadialAxial":return new IC(r);case"Mesh":return new NC(r);case"Dummy":return new LC}throw new Error(`Unknown IR type: ${r[0]}`)}const gw={COLORED:1,UNCOLORED:2},Zm=class Zm{constructor(e,t,n,s,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:s,tilingType:i,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),M1("TilingType: "+i);const h=t[0],d=t[1],f=t[2],p=t[3],g=f-h,w=p-d,x=ue.singularValueDecompose2dScale(this.matrix),y=ue.singularValueDecompose2dScale(this.baseTransform),b=x[0]*y[0],_=x[1]*y[1];let C=g,R=w,I=!1,O=!1;const D=Math.ceil(l*b),B=Math.ceil(c*_),q=Math.ceil(g*b),K=Math.ceil(w*_);D>=q?C=l:I=!0,B>=K?R=c:O=!0;const de=this.getSizeAndScale(C,this.ctx.canvas.width,b),Re=this.getSizeAndScale(R,this.ctx.canvas.height,_),ge=e.cachedCanvases.getCanvas("pattern",de.size,Re.size),Be=ge.context,W=o.createCanvasGraphics(Be);if(W.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(W,s,a),Be.translate(-de.scale*h,-Re.scale*d),W.transform(de.scale,0,0,Re.scale,0,0),Be.save(),this.clipBbox(W,h,d,f,p),W.baseTransform=at(W.ctx),W.executeOperatorList(n),W.endDrawing(),Be.restore(),I||O){const ne=ge.canvas;I&&(C=l),O&&(R=c);const V=this.getSizeAndScale(C,this.ctx.canvas.width,b),le=this.getSizeAndScale(R,this.ctx.canvas.height,_),re=V.size,Se=le.size,ve=e.cachedCanvases.getCanvas("pattern-workaround",re,Se),De=ve.context,Ct=I?Math.floor(g/l):0,qt=O?Math.floor(w/c):0;for(let Ve=0;Ve<=Ct;Ve++)for(let F=0;F<=qt;F++)De.drawImage(ne,re*Ve,Se*F,re,Se,0,0,re,Se);return{canvas:ve.canvas,scaleX:V.scale,scaleY:le.scale,offsetX:h,offsetY:d}}return{canvas:ge.canvas,scaleX:de.scale,scaleY:Re.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,n){const s=Math.max(Zm.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=s?i=s:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,s,i){const a=s-t,o=i-n;e.ctx.rect(t,n,a,o),e.current.updateRectMinMax(at(e.ctx),[t,n,s,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,i=e.current;switch(t){case gw.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,i.fillColor=a.fillStyle,i.strokeColor=a.strokeStyle;break;case gw.UNCOLORED:const o=ue.makeHexColor(n[0],n[1],n[2]);s.fillStyle=o,s.strokeStyle=o,i.fillColor=o,i.strokeColor=o;break;default:throw new lC(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,s){let i=n;s!==wr.SHADING&&(i=ue.transform(i,t.baseTransform),this.matrix&&(i=ue.transform(i,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};he(Zm,"MAX_PATTERN_SIZE",3e3);let C4=Zm;function FC({src:r,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const o=Nr.isLittleEndian?4278190080:255,[l,c]=a?[i,o]:[o,i],h=n>>3,d=n&7,f=r.length;t=new Uint32Array(t.buffer);let p=0;for(let g=0;g<s;g++){for(const x=e+h;e<x;e++){const y=e<f?r[e]:255;t[p++]=y&128?c:l,t[p++]=y&64?c:l,t[p++]=y&32?c:l,t[p++]=y&16?c:l,t[p++]=y&8?c:l,t[p++]=y&4?c:l,t[p++]=y&2?c:l,t[p++]=y&1?c:l}if(d===0)continue;const w=e<f?r[e++]:255;for(let x=0;x<d;x++)t[p++]=w&1<<7-x?c:l}return{srcPos:e,destPos:p}}const vw=16,yw=100,zC=15,ww=10,bw=1e3,Kr=16;function BC(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(n,s){e.translate(n,s),this.__originalTranslate(n,s)},r.scale=function(n,s){e.scale(n,s),this.__originalScale(n,s)},r.transform=function(n,s,i,a,o,l){e.transform(n,s,i,a,o,l),this.__originalTransform(n,s,i,a,o,l)},r.setTransform=function(n,s,i,a,o,l){e.setTransform(n,s,i,a,o,l),this.__originalSetTransform(n,s,i,a,o,l)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(n){e.rotate(n),this.__originalRotate(n)},r.clip=function(n){e.clip(n),this.__originalClip(n)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,s,i,a,o){e.bezierCurveTo(t,n,s,i,a,o),this.__originalBezierCurveTo(t,n,s,i,a,o)},r.rect=function(t,n,s,i){e.rect(t,n,s,i),this.__originalRect(t,n,s,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class jC{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function tp(r,e,t,n,s,i,a,o,l,c){const[h,d,f,p,g,w]=at(r);if(d===0&&f===0){const b=a*h+g,_=Math.round(b),C=o*p+w,R=Math.round(C),I=(a+l)*h+g,O=Math.abs(Math.round(I)-_)||1,D=(o+c)*p+w,B=Math.abs(Math.round(D)-R)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(p),_,R),r.drawImage(e,t,n,s,i,0,0,O,B),r.setTransform(h,d,f,p,g,w),[O,B]}if(h===0&&p===0){const b=o*f+g,_=Math.round(b),C=a*d+w,R=Math.round(C),I=(o+c)*f+g,O=Math.abs(Math.round(I)-_)||1,D=(a+l)*d+w,B=Math.abs(Math.round(D)-R)||1;return r.setTransform(0,Math.sign(d),Math.sign(f),0,_,R),r.drawImage(e,t,n,s,i,0,0,B,O),r.setTransform(h,d,f,p,g,w),[B,O]}r.drawImage(e,t,n,s,i,a,o,l,c);const x=Math.hypot(h,d),y=Math.hypot(f,p);return[x*l,y*c]}function $C(r){const{width:e,height:t}=r;if(e>bw||t>bw)return null;const n=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let a=new Uint8Array(i*(t+1)),o,l,c;const h=e+7&-8;let d=new Uint8Array(h*t),f=0;for(const y of r.data){let b=128;for(;b>0;)d[f++]=y&b?0:255,b>>=1}let p=0;for(f=0,d[f]!==0&&(a[0]=1,++p),l=1;l<e;l++)d[f]!==d[f+1]&&(a[l]=d[f]?2:1,++p),f++;for(d[f]!==0&&(a[l]=2,++p),o=1;o<t;o++){f=o*h,c=o*i,d[f-h]!==d[f]&&(a[c]=d[f]?1:8,++p);let y=(d[f]?4:0)+(d[f-h]?8:0);for(l=1;l<e;l++)y=(y>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),s[y]&&(a[c+l]=s[y],++p),f++;if(d[f-h]!==d[f]&&(a[c+l]=d[f]?2:4,++p),p>n)return null}for(f=h*(t-1),c=o*i,d[f]!==0&&(a[c]=8,++p),l=1;l<e;l++)d[f]!==d[f+1]&&(a[c+l]=d[f]?4:8,++p),f++;if(d[f]!==0&&(a[c+l]=4,++p),p>n)return null;const g=new Int32Array([0,i,-1,0,-i,0,0,0,1]),w=new Path2D;for(o=0;p&&o<=t;o++){let y=o*i;const b=y+e;for(;y<b&&!a[y];)y++;if(y===b)continue;w.moveTo(y%i,o);const _=y;let C=a[y];do{const R=g[C];do y+=R;while(!a[y]);const I=a[y];I!==5&&I!==10?(C=I,a[y]=0):(C=I&51*C>>4,a[y]&=C>>2|C<<2),w.lineTo(y%i,y/i|0),a[y]||--p}while(_!==y);--o}return d=null,a=null,function(y){y.save(),y.scale(1/e,-1/t),y.translate(0,-t),y.fill(w),y.beginPath(),y.restore()}}class Sw{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=M8,this.textMatrixScale=1,this.fontMatrix=r4,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=hr.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=ue.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=ue.applyTransform(t,e),s=ue.applyTransform(t.slice(2),e),i=ue.applyTransform([t[0],t[3]],e),a=ue.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],s[0],i[0],a[0]),this.minY=Math.min(this.minY,n[1],s[1],i[1],a[1]),this.maxX=Math.max(this.maxX,n[0],s[0],i[0],a[0]),this.maxY=Math.max(this.maxY,n[1],s[1],i[1],a[1])}updateScalingPathMinMax(e,t){ue.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,s,i,a,o,l,c,h){const d=ue.bezierBoundingBox(t,n,s,i,a,o,l,c,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=wr.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===wr.STROKE){t||Ke("Stroke bounding box must include transform.");const s=ue.singularValueDecompose2dScale(t),i=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const e=ue.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=wr.FILL,t=null){return ue.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function _w(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%Kr,i=(t-s)/Kr,a=s===0?i:i+1,o=r.createImageData(n,Kr);let l=0,c;const h=e.data,d=o.data;let f,p,g,w;if(e.kind===kp.GRAYSCALE_1BPP){const x=h.byteLength,y=new Uint32Array(d.buffer,0,d.byteLength>>2),b=y.length,_=n+7>>3,C=4294967295,R=Nr.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(g=f<i?Kr:s,c=0,p=0;p<g;p++){const I=x-l;let O=0;const D=I>_?n:I*8-7,B=D&-8;let q=0,K=0;for(;O<B;O+=8)K=h[l++],y[c++]=K&128?C:R,y[c++]=K&64?C:R,y[c++]=K&32?C:R,y[c++]=K&16?C:R,y[c++]=K&8?C:R,y[c++]=K&4?C:R,y[c++]=K&2?C:R,y[c++]=K&1?C:R;for(;O<D;O++)q===0&&(K=h[l++],q=128),y[c++]=K&q?C:R,q>>=1}for(;c<b;)y[c++]=0;r.putImageData(o,0,f*Kr)}}else if(e.kind===kp.RGBA_32BPP){for(p=0,w=n*Kr*4,f=0;f<i;f++)d.set(h.subarray(l,l+w)),l+=w,r.putImageData(o,0,p),p+=Kr;f<a&&(w=n*s*4,d.set(h.subarray(l,l+w)),r.putImageData(o,0,p))}else if(e.kind===kp.RGB_24BPP)for(g=Kr,w=n*g,f=0;f<a;f++){for(f>=i&&(g=s,w=n*g),c=0,p=w;p--;)d[c++]=h[l++],d[c++]=h[l++],d[c++]=h[l++],d[c++]=255;r.putImageData(o,0,f*Kr)}else throw new Error(`bad image kind: ${e.kind}`)}function xw(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%Kr,i=(t-s)/Kr,a=s===0?i:i+1,o=r.createImageData(n,Kr);let l=0;const c=e.data,h=o.data;for(let d=0;d<a;d++){const f=d<i?Kr:s;({srcPos:l}=FC({src:c,srcPos:l,dest:h,width:n,height:f,nonBlackColor:0})),r.putImageData(o,0,d*Kr)}}function Rh(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function rp(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!Sr){const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}}function Aw(r,e){if(e)return!0;const t=ue.singularValueDecompose2dScale(r);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*po.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const UC=["butt","round","square"],HC=["miter","round","bevel"],qC={},Ew={};var Ts,R4,P4,M4;const o3=class o3{constructor(e,t,n,s,i,{optionalContentConfig:a,markedContentStack:o=null},l,c){E(this,Ts);this.ctx=e,this.current=new Sw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new jC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,n){const l=this.cachedCanvases.getCanvas("transparent",i,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...at(this.compositeCtx))}this.ctx.save(),rp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=at(this.ctx)}executeOperatorList(e,t,n,s){const i=e.argsArray,a=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const c=l-o>ww&&typeof n=="function",h=c?Date.now()+zC:0;let d=0;const f=this.commonObjs,p=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,n),o;if(g=a[o],g!==as.dependency)this[g].apply(this,i[o]);else for(const w of i[o]){const x=w.startsWith("g_")?f:p;if(!x.has(w))return x.get(w,n),o}if(o++,o===l)return o;if(c&&++d>ww){if(Date.now()>h)return n(),o;d=0}}}endDrawing(){k(this,Ts,R4).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),k(this,Ts,P4).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=n,l=s,c="prescale1",h,d;for(;i>2&&o>1||a>2&&l>1;){let f=o,p=l;i>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/f),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),h=this.cachedCanvases.getCanvas(c,f,p),d=h.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,o,l,0,0,f,p),e=h.canvas,o=f,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,i=this.current.fillColor,a=this.current.patternFill,o=at(t);let l,c,h,d;if((e.bitmap||e.data)&&e.count>1){const D=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),i]),l=this._cachedBitmapsMap.get(D),l||(l=new Map,this._cachedBitmapsMap.set(D,l));const B=l.get(c);if(B&&!a){const q=Math.round(Math.min(o[0],o[2])+o[4]),K=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:B,offsetX:q,offsetY:K}}h=B}h||(d=this.cachedCanvases.getCanvas("maskCanvas",n,s),xw(d.context,e));let f=ue.transform(o,[1/n,0,0,-1/s,0,0]);f=ue.transform(f,[1,0,0,1,0,-s]);const[p,g,w,x]=ue.getAxialAlignedBoundingBox([0,0,n,s],f),y=Math.round(w-p)||1,b=Math.round(x-g)||1,_=this.cachedCanvases.getCanvas("fillCanvas",y,b),C=_.context,R=p,I=g;C.translate(-R,-I),C.transform(...f),h||(h=this._scaleImage(d.canvas,Ms(C)),h=h.img,l&&a&&l.set(c,h)),C.imageSmoothingEnabled=Aw(at(C),e.interpolate),tp(C,h,0,0,h.width,h.height,0,0,n,s),C.globalCompositeOperation="source-in";const O=ue.transform(Ms(C),[1,0,0,1,-R,-I]);return C.fillStyle=a?i.getPattern(t,this,O,wr.FILL):i,C.fillRect(0,0,n,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,_.canvas)),{canvas:_.canvas,offsetX:Math.round(R),offsetY:Math.round(I)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=UC[e]}setLineJoin(e){this.ctx.lineJoin=HC[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const i=this.ctx;i.setTransform(...at(this.suspendedCtx)),Rh(this.suspendedCtx,i),BC(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const i=s[0],a=s[1],o=s[2]-i,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,n,o,l,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,i,a,o,l,c,h,d){let f=e.canvas,p=l-h,g=c-d;if(a){const x=ue.makeHexColor(...a);if(p<0||g<0||p+n>f.width||g+s>f.height){const y=this.cachedCanvases.getCanvas("maskExtension",n,s),b=y.context;b.drawImage(f,-p,-g),b.globalCompositeOperation="destination-atop",b.fillStyle=x,b.fillRect(0,0,n,s),b.globalCompositeOperation="source-over",f=y.canvas,p=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(p,g,n,s),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=x,e.fillRect(p,g,n,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(l,c,n,s),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(f,p,g,n,s,l,c,n,s),t.restore()}save(){this.inSMaskMode?(Rh(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rh(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,s,i,a){this.ctx.transform(e,t,n,s,i,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const s=this.ctx,i=this.current;let a=i.x,o=i.y,l,c;const h=at(s),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?n.slice(0):null;for(let p=0,g=0,w=e.length;p<w;p++)switch(e[p]|0){case as.rectangle:a=t[g++],o=t[g++];const x=t[g++],y=t[g++],b=a+x,_=o+y;s.moveTo(a,o),x===0||y===0?s.lineTo(b,_):(s.lineTo(b,o),s.lineTo(b,_),s.lineTo(a,_)),d||i.updateRectMinMax(h,[a,o,b,_]),s.closePath();break;case as.moveTo:a=t[g++],o=t[g++],s.moveTo(a,o),d||i.updatePathMinMax(h,a,o);break;case as.lineTo:a=t[g++],o=t[g++],s.lineTo(a,o),d||i.updatePathMinMax(h,a,o);break;case as.curveTo:l=a,c=o,a=t[g+4],o=t[g+5],s.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],a,o),i.updateCurvePathMinMax(h,l,c,t[g],t[g+1],t[g+2],t[g+3],a,o,f),g+=6;break;case as.curveTo2:l=a,c=o,s.bezierCurveTo(a,o,t[g],t[g+1],t[g+2],t[g+3]),i.updateCurvePathMinMax(h,l,c,a,o,t[g],t[g+1],t[g+2],t[g+3],f),a=t[g+2],o=t[g+3],g+=4;break;case as.curveTo3:l=a,c=o,a=t[g+2],o=t[g+3],s.bezierCurveTo(t[g],t[g+1],a,o,a,o),i.updateCurvePathMinMax(h,l,c,t[g],t[g+1],a,o,a,o,f),g+=4;break;case as.closePath:s.closePath();break}d&&i.updateScalingPathMinMax(h,f),i.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(t.save(),t.strokeStyle=n.getPattern(t,this,Ms(t),wr.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;let i=!1;s&&(t.save(),t.fillStyle=n.getPattern(t,this,Ms(t),wr.FILL),i=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=qC}eoClip(){this.pendingClip=Ew}beginText(){this.current.textMatrix=M8,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,s=t.getTransform().invertSelf();for(const{transform:i,x:a,y:o,fontSize:l,path:c}of e)n.addPath(c,new DOMMatrix(i).preMultiplySelf(s).translate(a,o).scale(l,-l));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||r4,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ae("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",a=((h=n.systemFontInfo)==null?void 0:h.css)||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const l=n.italic?"italic":"normal";let c=t;t<vw?c=vw:t>yw&&(c=yw),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,s,i,a){this.current.textMatrix=[e,t,n,s,i,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,s,i){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=c&hr.FILL_STROKE_MASK,f=!!(c&hr.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let w;if((l.disableFontFace||f||p||g)&&(w=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p||g){if(a.save(),a.translate(t,n),a.scale(h,-h),d===hr.FILL||d===hr.FILL_STROKE)if(s){const x=a.getTransform();a.setTransform(...s),a.fill(k(this,Ts,M4).call(this,w,x,s))}else a.fill(w);if(d===hr.STROKE||d===hr.FILL_STROKE)if(i){const x=a.getTransform();a.setTransform(...i),a.stroke(k(this,Ts,M4).call(this,w,x,i))}else a.lineWidth/=h,a.stroke(w);a.restore()}else(d===hr.FILL||d===hr.FILL_STROKE)&&a.fillText(e,t,n),(d===hr.STROKE||d===hr.FILL_STROKE)&&a.strokeText(e,t,n);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:at(a),x:t,y:n,fontSize:h,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ce(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const i=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,d=e.length,f=n.vertical,p=f?1:-1,g=n.defaultVMetrics,w=s*t.fontMatrix[0],x=t.textRenderingMode===hr.FILL&&!n.disableFontFace&&!t.patternFill;i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),c>0?i.scale(h,-1):i.scale(h,1);let y,b;if(t.patternFill){i.save();const O=t.fillColor.getPattern(i,this,Ms(i),wr.FILL);y=at(i),i.restore(),i.fillStyle=O}if(t.patternStroke){i.save();const O=t.strokeColor.getPattern(i,this,Ms(i),wr.STROKE);b=at(i),i.restore(),i.strokeStyle=O}let _=t.lineWidth;const C=t.textMatrixScale;if(C===0||_===0){const O=t.textRenderingMode&hr.FILL_STROKE_MASK;(O===hr.STROKE||O===hr.FILL_STROKE)&&(_=this.getSinglePixelWidth())}else _/=C;if(a!==1&&(i.scale(a,a),_/=a),i.lineWidth=_,n.isInvalidPDFjsFont){const O=[];let D=0;for(const B of e)O.push(B.unicode),D+=B.width;i.fillText(O.join(""),0,0),t.x+=D*w*h,i.restore(),this.compose();return}let R=0,I;for(I=0;I<d;++I){const O=e[I];if(typeof O=="number"){R+=p*O*s/1e3;continue}let D=!1;const B=(O.isSpace?l:0)+o,q=O.fontChar,K=O.accent;let de,Re,ge=O.width;if(f){const W=O.vmetric||g,ne=-(O.vmetric?W[1]:ge*.5)*w,V=W[2]*w;ge=W?-W[0]:ge,de=ne/a,Re=(R+V)/a}else de=R/a,Re=0;if(n.remeasure&&ge>0){const W=i.measureText(q).width*1e3/s*a;if(ge<W&&this.isFontSubpixelAAEnabled){const ne=ge/W;D=!0,i.save(),i.scale(ne,1),de/=ne}else ge!==W&&(de+=(ge-W)/2e3*s/a)}if(this.contentVisible&&(O.isInFont||n.missingFile)){if(x&&!K)i.fillText(q,de,Re);else if(this.paintChar(q,de,Re,y,b),K){const W=de+s*K.offset.x/a,ne=Re-s*K.offset.y/a;this.paintChar(K.fontChar,W,ne,y,b)}}const Be=f?ge*w-B*c:ge*w+B*c;R+=Be,D&&i.restore()}f?t.y-=R:t.x+=R*h,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,s=n.font,i=n.fontSize,a=n.fontDirection,o=s.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,h=n.textHScale*a,d=n.fontMatrix||r4,f=e.length,p=n.textRenderingMode===hr.INVISIBLE;let g,w,x,y;if(!(p||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(h,a),g=0;g<f;++g){if(w=e[g],typeof w=="number"){y=o*w*i/1e3,this.ctx.translate(y,0),n.x+=y*h;continue}const b=(w.isSpace?c:0)+l,_=s.charProcOperatorList[w.operatorListId];if(!_){Ae(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(i,i),t.transform(...d),this.executeOperatorList(_),this.restore()),x=ue.applyTransform([w.width,0],d)[0]*i+b,t.translate(x,0),n.x+=x*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,s,i,a){this.ctx.rect(n,s,i-n,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],s=this.baseTransform||at(this.ctx),i={createCanvasGraphics:a=>new o3(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new C4(e,n,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=ue.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=ue.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=DC(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Ms(t),wr.SHADING);const s=Ms(t);if(s){const{width:i,height:a}=t.canvas,[o,l,c,h]=ue.getAxialAlignedBoundingBox([0,0,i,a],s);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ke("Should not call beginInlineImage")}beginImageData(){Ke("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=at(this.ctx),t)){const n=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],n,s),this.current.updateRectMinMax(at(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||M1("TODO: Support non-isolated groups."),e.knockout&&Ae("Knockout groups not supported.");const n=at(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=ue.getAxialAlignedBoundingBox(e.bbox,at(t));const i=[0,0,t.canvas.width,t.canvas.height];s=ue.intersect(s,i)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,c),f=d.context;f.translate(-a,-o),f.transform(...n),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Rh(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=at(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const i=ue.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,n,s,i){if(k(this,Ts,R4).call(this),rp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=ue.singularValueDecompose2dScale(at(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),f=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),rp(this.ctx)}else rp(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Sw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),k(this,Ts,P4).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=$C(e)),s.compiled)){s.compiled(n);return}const i=this._createMaskCanvas(e),a=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,i,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=at(o);o.transform(t,n,s,i,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const f=ue.transform(l,[t,n,s,i,a[h],a[h+1]]),[p,g]=ue.applyTransform([0,0],f);o.drawImage(c.canvas,p,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const i of e){const{data:a,width:o,height:l,transform:c}=i,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const f=this.getObject(a,i);xw(d,f),d.globalCompositeOperation="source-in",d.fillStyle=s?n.getPattern(d,this,Ms(t),wr.FILL):n,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...c),t.scale(1,-1),tp(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ae("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,s){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){Ae("Dependent image isn't ready yet");return}const a=i.width,o=i.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[t,0,0,n,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,s),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;if(this.save(),!Sr){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/t,-1/n);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;_w(l,e),i=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(i,Ms(s));s.imageSmoothingEnabled=Aw(at(s),e.interpolate),tp(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const i=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,a).context;_w(l,e),s=this.applyTransferMapsToCanvas(l)}for(const i of t)n.save(),n.transform(...i.transform),n.scale(1,-1),tp(n,s,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===Ew?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=at(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:i}=this.ctx.getTransform();let a,o;if(n===0&&s===0){const l=Math.abs(t),c=Math.abs(i);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,d=c*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(t*i-n*s),c=Math.hypot(t,n),h=Math.hypot(s,i);if(e===0)a=h/l,o=c/l;else{const d=e*l;a=h>d?h/d:1,o=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[s,i]=this.getScaleForStroking();if(t.lineWidth=n||1,s===1&&i===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(s,i),a.length>0){const o=Math.max(s,i);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ts=new WeakSet,R4=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},P4=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},M4=function(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s};let Ku=o3;for(const r in as)Ku.prototype[r]!==void 0&&(Ku.prototype[as[r]]=Ku.prototype[r]);var gd,vd;class qi{static get workerPort(){return u(this,gd)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");S(this,gd,e)}static get workerSrc(){return u(this,vd)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");S(this,vd,e)}}gd=new WeakMap,vd=new WeakMap,E(qi,gd,null),E(qi,vd,"");var fl,yd;class VC{constructor({parsedData:e,rawData:t}){E(this,fl);E(this,yd);S(this,fl,e),S(this,yd,t)}getRaw(){return u(this,yd)}get(e){return u(this,fl).get(e)??null}getAll(){return R2(u(this,fl))}has(e){return u(this,fl).has(e)}}fl=new WeakMap,yd=new WeakMap;const xu=Symbol("INTERNAL");var wd,bd,Sd,pc;class GC{constructor(e,{name:t,intent:n,usage:s,rbGroups:i}){E(this,wd,!1);E(this,bd,!1);E(this,Sd,!1);E(this,pc,!0);S(this,wd,!!(e&vn.DISPLAY)),S(this,bd,!!(e&vn.PRINT)),this.name=t,this.intent=n,this.usage=s,this.rbGroups=i}get visible(){if(u(this,Sd))return u(this,pc);if(!u(this,pc))return!1;const{print:e,view:t}=this.usage;return u(this,wd)?(t==null?void 0:t.viewState)!=="OFF":u(this,bd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==xu&&Ke("Internal method `_setVisible` called."),S(this,Sd,n),S(this,pc,t)}}wd=new WeakMap,bd=new WeakMap,Sd=new WeakMap,pc=new WeakMap;var Oa,He,mc,gc,_d,I4;class WC{constructor(e,t=vn.DISPLAY){E(this,_d);E(this,Oa,null);E(this,He,new Map);E(this,mc,null);E(this,gc,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,S(this,gc,e.order);for(const n of e.groups)u(this,He).set(n.id,new GC(t,n));if(e.baseState==="OFF")for(const n of u(this,He).values())n._setVisible(xu,!1);for(const n of e.on)u(this,He).get(n)._setVisible(xu,!0);for(const n of e.off)u(this,He).get(n)._setVisible(xu,!1);S(this,mc,this.getHash())}}isVisible(e){if(u(this,He).size===0)return!0;if(!e)return M1("Optional content group not defined."),!0;if(e.type==="OCG")return u(this,He).has(e.id)?u(this,He).get(e.id).visible:(Ae(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return k(this,_d,I4).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!u(this,He).has(t))return Ae(`Optional content group not found: ${t}`),!0;if(u(this,He).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!u(this,He).has(t))return Ae(`Optional content group not found: ${t}`),!0;if(!u(this,He).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!u(this,He).has(t))return Ae(`Optional content group not found: ${t}`),!0;if(!u(this,He).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!u(this,He).has(t))return Ae(`Optional content group not found: ${t}`),!0;if(u(this,He).get(t).visible)return!1}return!0}return Ae(`Unknown optional content policy ${e.policy}.`),!0}return Ae(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var i;const s=u(this,He).get(e);if(!s){Ae(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((i=u(this,He).get(o))==null||i._setVisible(xu,!1,!0));s._setVisible(xu,!!t,!0),S(this,Oa,null)}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const i=u(this,He).get(s);if(i)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!i.visible,t);break}}S(this,Oa,null)}get hasInitialVisibility(){return u(this,mc)===null||this.getHash()===u(this,mc)}getOrder(){return u(this,He).size?u(this,gc)?u(this,gc).slice():[...u(this,He).keys()]:null}getGroups(){return u(this,He).size>0?R2(u(this,He)):null}getGroup(e){return u(this,He).get(e)||null}getHash(){if(u(this,Oa)!==null)return u(this,Oa);const e=new lS;for(const[t,n]of u(this,He))e.update(`${t}:${n.visible}`);return S(this,Oa,e.hexdigest())}}Oa=new WeakMap,He=new WeakMap,mc=new WeakMap,gc=new WeakMap,_d=new WeakSet,I4=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const i=e[s];let a;if(Array.isArray(i))a=k(this,_d,I4).call(this,i);else if(u(this,He).has(i))a=u(this,He).get(i).visible;else return Ae(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return n==="And"};class KC{constructor(e,{disableRange:t=!1,disableStream:n=!1}){It(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(n),!0)});It(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,s,i;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(i=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||i.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){It(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new XC(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new YC(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class XC{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=I2(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class YC{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function QC(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),i(h)}if(t=a(r),t){const h=c(t);return i(h)}if(t=n("filename","i").exec(r),t){t=t[1];let h=o(t);return h=c(h),i(h)}function n(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function s(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),p=I1(d);d=f.decode(p),e=!1}catch{}}return d}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const d=[];let f;const p=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(h))!==null;){let[,w,x,y]=f;if(w=parseInt(w,10),w in d){if(w===0)break;continue}d[w]=[x,y]}const g=[];for(let w=0;w<d.length&&w in d;++w){let[x,y]=d[w];y=o(y),x&&(y=unescape(y),w===0&&(y=l(y))),g.push(y)}return g.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),g=h.slice(d+1).replace(/^[^']*'/,"");return s(f,g)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,g){if(p==="q"||p==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,x){return String.fromCharCode(parseInt(x,16))}),s(f,g);try{g=atob(g)}catch{}return s(f,g)})}return""}function _S(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function L1(r){try{return new URL(r).origin}catch{}return null}function xS({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(s.suggestedLength=i,i<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function AS(r){const e=r.get("Content-Disposition");if(e){let t=QC(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(I2(t))return t}return null}function D1(r,e){return r===404||r===0&&e.startsWith("file:")?new F0('Missing PDF "'+e+'".'):new Om(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r)}function ES(r){return r===200||r===206}function kS(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function TS(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Ae(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class kw{constructor(e){he(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=_S(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return It(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new JC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new ZC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class JC{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,kS(n,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=L1(i.url),!ES(i.status))throw D1(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const a=i.headers,{allowRangeRequests:o,suggestedLength:l}=xS({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=AS(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new fo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:TS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class ZC{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${n-1}`);const a=s.url;fetch(a,kS(i,this._withCredentials,this._abortController)).then(o=>{const l=L1(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!ES(o.status))throw D1(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:TS(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Ig=200,Og=206;function eR(r){const e=r.response;return typeof e!="string"?e:I1(e).buffer}class tR{constructor({url:e,httpHeaders:t,withCredentials:n}){he(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=_S(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Og):s.expectedStatus=Ig,t.responseType="arraybuffer",It(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var s;const n=this.pendingRequests[e];n&&((s=n.onProgress)==null||s.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const i=s.status||Ig;if(!(i===Ig&&n.expectedStatus===Og)&&i!==n.expectedStatus){n.onError(s.status);return}const o=eR(s);if(i===Og){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?n.onDone({begin:parseInt(c[1],10),chunk:o}):(Ae('Missing or invalid "Content-Range" header.'),n.onError(0))}else o?n.onDone({begin:0,chunk:o}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class rR{constructor(e){this._source=e,this._manager=new tR(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return It(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new nR(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new sR(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class nR{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=L1(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:a}=xS({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=AS(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=D1(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class sR{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=L1((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=D1(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const iR=/^[a-z][a-z0-9\-+.]+:/i;function aR(r){if(iR.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class oR{constructor(e){this.source=e,this.url=aR(e.url),It(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return It(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new lR(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new uR(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class lR{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new F0(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new fo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class uR{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const cR=1e5,$r=30,hR=.8;var c6,Na,Vr,xd,Ad,pl,Ci,Ed,kd,ml,vc,yc,La,wc,Td,bc,gl,Cd,Rd,vl,yl,Pd,Da,Sc,aa,CS,RS,O4,Tn,Fp,N4,PS,MS;const Ft=class Ft{constructor({textContentSource:e,container:t,viewport:n}){E(this,aa);E(this,Na,Promise.withResolvers());E(this,Vr,null);E(this,xd,!1);E(this,Ad,!!((c6=globalThis.FontInspector)!=null&&c6.enabled));E(this,pl,null);E(this,Ci,null);E(this,Ed,0);E(this,kd,0);E(this,ml,null);E(this,vc,null);E(this,yc,0);E(this,La,0);E(this,wc,Object.create(null));E(this,Td,[]);E(this,bc,null);E(this,gl,[]);E(this,Cd,new WeakMap);E(this,Rd,null);var l;if(e instanceof ReadableStream)S(this,bc,e);else if(typeof e=="object")S(this,bc,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');S(this,Vr,S(this,vc,t)),S(this,La,n.scale*(globalThis.devicePixelRatio||1)),S(this,yc,n.rotation),S(this,Ci,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:i,pageX:a,pageY:o}=n.rawDims;S(this,Rd,[1,0,0,-1,-a,o+i]),S(this,kd,s),S(this,Ed,i),k(l=Ft,Tn,PS).call(l),ru(t,n),u(this,Na).promise.finally(()=>{u(Ft,Sc).delete(this),S(this,Ci,null),S(this,wc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Nr.platform;return Ce(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{u(this,ml).read().then(({value:t,done:n})=>{if(n){u(this,Na).resolve();return}u(this,pl)??S(this,pl,t.lang),Object.assign(u(this,wc),t.styles),k(this,aa,CS).call(this,t.items),e()},u(this,Na).reject)};return S(this,ml,u(this,bc).getReader()),u(Ft,Sc).add(this),e(),u(this,Na).promise}update({viewport:e,onBefore:t=null}){var i;const n=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==u(this,yc)&&(t==null||t(),S(this,yc,s),ru(u(this,vc),{rotation:s})),n!==u(this,La)){t==null||t(),S(this,La,n);const a={div:null,properties:null,ctx:k(i=Ft,Tn,Fp).call(i,u(this,pl))};for(const o of u(this,gl))a.properties=u(this,Cd).get(o),a.div=o,k(this,aa,O4).call(this,a)}}cancel(){var t;const e=new fo("TextLayer task cancelled.");(t=u(this,ml))==null||t.cancel(e).catch(()=>{}),S(this,ml,null),u(this,Na).reject(e)}get textDivs(){return u(this,gl)}get textContentItemsStr(){return u(this,Td)}static cleanup(){if(!(u(this,Sc).size>0)){u(this,vl).clear();for(const{canvas:e}of u(this,yl).values())e.remove();u(this,yl).clear()}}};Na=new WeakMap,Vr=new WeakMap,xd=new WeakMap,Ad=new WeakMap,pl=new WeakMap,Ci=new WeakMap,Ed=new WeakMap,kd=new WeakMap,ml=new WeakMap,vc=new WeakMap,yc=new WeakMap,La=new WeakMap,wc=new WeakMap,Td=new WeakMap,bc=new WeakMap,gl=new WeakMap,Cd=new WeakMap,Rd=new WeakMap,vl=new WeakMap,yl=new WeakMap,Pd=new WeakMap,Da=new WeakMap,Sc=new WeakMap,aa=new WeakSet,CS=function(e){var s,i;if(u(this,xd))return;(i=u(this,Ci)).ctx??(i.ctx=k(s=Ft,Tn,Fp).call(s,u(this,pl)));const t=u(this,gl),n=u(this,Td);for(const a of e){if(t.length>cR){Ae("Ignoring additional textDivs for performance reasons."),S(this,xd,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=u(this,Vr);S(this,Vr,document.createElement("span")),u(this,Vr).classList.add("markedContent"),a.id!==null&&u(this,Vr).setAttribute("id",`${a.id}`),o.append(u(this,Vr))}else a.type==="endMarkedContent"&&S(this,Vr,u(this,Vr).parentNode);continue}n.push(a.str),k(this,aa,RS).call(this,a)}},RS=function(e){var w;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};u(this,gl).push(t);const s=ue.transform(u(this,Rd),e.transform);let i=Math.atan2(s[1],s[0]);const a=u(this,wc)[e.fontName];a.vertical&&(i+=Math.PI/2);let o=u(this,Ad)&&a.fontSubstitution||a.fontFamily;o=Ft.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*k(w=Ft,Tn,MS).call(w,o,u(this,pl));let h,d;i===0?(h=s[4],d=s[5]-c):(h=s[4]+c*Math.sin(i),d=s[5]-c*Math.cos(i));const f="calc(var(--scale-factor)*",p=t.style;u(this,Vr)===u(this,vc)?(p.left=`${(100*h/u(this,kd)).toFixed(2)}%`,p.top=`${(100*d/u(this,Ed)).toFixed(2)}%`):(p.left=`${f}${h.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(u(Ft,Da)*l).toFixed(2)}px)`,p.fontFamily=o,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,u(this,Ad)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);x!==y&&Math.max(x,y)/Math.min(x,y)>1.5&&(g=!0)}if(g&&(n.canvasWidth=a.vertical?e.height:e.width),u(this,Cd).set(t,n),u(this,Ci).div=t,u(this,Ci).properties=n,k(this,aa,O4).call(this,u(this,Ci)),n.hasText&&u(this,Vr).append(t),n.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),u(this,Vr).append(x)}},O4=function(e){var o;const{div:t,properties:n,ctx:s}=e,{style:i}=t;let a="";if(u(Ft,Da)>1&&(a=`scale(${1/u(Ft,Da)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:h}=n;k(o=Ft,Tn,N4).call(o,s,h*u(this,La),l);const{width:d}=s.measureText(t.textContent);d>0&&(a=`scaleX(${c*u(this,La)/d}) ${a}`)}n.angle!==0&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(i.transform=a)},Tn=new WeakSet,Fp=function(e=null){let t=u(this,yl).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,yl).set(e,t),u(this,Pd).set(t,{size:0,family:""})}return t},N4=function(e,t,n){const s=u(this,Pd).get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)},PS=function(){if(u(this,Da)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),S(this,Da,e.getBoundingClientRect().height),e.remove()},MS=function(e,t){const n=u(this,vl).get(e);if(n)return n;const s=k(this,Tn,Fp).call(this,t);s.canvas.width=s.canvas.height=$r,k(this,Tn,N4).call(this,s,$r,e);const i=s.measureText("");let a=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(a){const h=a/(a+o);return u(this,vl).set(e,h),s.canvas.width=s.canvas.height=0,h}s.strokeStyle="red",s.clearRect(0,0,$r,$r),s.strokeText("g",0,0);let l=s.getImageData(0,0,$r,$r).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/$r);break}s.clearRect(0,0,$r,$r),s.strokeText("A",0,$r),l=s.getImageData(0,0,$r,$r).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=$r-Math.floor(h/4/$r);break}s.canvas.width=s.canvas.height=0;const c=a?a/(a+o):hR;return u(this,vl).set(e,c),c},E(Ft,Tn),E(Ft,vl,new Map),E(Ft,yl,new Map),E(Ft,Pd,new WeakMap),E(Ft,Da,null),E(Ft,Sc,new Set);let z0=Ft;class B0{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(i){var l;if(!i)return;let a=null;const o=i.name;if(o==="#text")a=i.value;else if(B0.shouldBuildText(o))(l=i==null?void 0:i.attributes)!=null&&l.textContent?a=i.attributes.textContent:i.value&&(a=i.value);else return;if(a!==null&&t.push({str:a}),!!i.children)for(const c of i.children)s(c)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const dR=65536,fR=100,pR=5e3,mR=Sr?RC:kC,gR=Sr?PC:gS,vR=Sr?CC:TC,yR=Sr?MC:bS;function wR(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new L4,{docId:t}=e,n=r.url?bR(r.url):null,s=r.data?SR(r.data):null,i=r.httpHeaders||null,a=r.withCredentials===!0,o=r.password??null,l=r.range instanceof IS?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:dR;let h=r.worker instanceof Xu?r.worker:null;const d=r.verbosity,f=typeof r.docBaseUrl=="string"&&!N1(r.docBaseUrl)?r.docBaseUrl:null,p=typeof r.cMapUrl=="string"?r.cMapUrl:null,g=r.cMapPacked!==!1,w=r.CMapReaderFactory||gR,x=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,y=r.StandardFontDataFactory||yR,b=r.stopAtErrors!==!0,_=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,C=r.isEvalSupported!==!1,R=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Sr,I=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Sr&&(Nr.platform.isFirefox||!globalThis.chrome),O=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,D=typeof r.disableFontFace=="boolean"?r.disableFontFace:Sr,B=r.fontExtraProperties===!0,q=r.enableXfa===!0,K=r.ownerDocument||globalThis.document,de=r.disableRange===!0,Re=r.disableStream===!0,ge=r.disableAutoFetch===!0,Be=r.pdfBug===!0,W=r.CanvasFactory||mR,ne=r.FilterFactory||vR,V=r.enableHWA===!0,le=l?l.length:r.length??NaN,re=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Sr&&!D,Se=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:w===gS&&y===bS&&p&&x&&Fh(p,document.baseURI)&&Fh(x,document.baseURI),ve=null;sC(d);const De={canvasFactory:new W({ownerDocument:K,enableHWA:V}),filterFactory:new ne({docId:t,ownerDocument:K}),cMapReaderFactory:Se?null:new w({baseUrl:p,isCompressed:g}),standardFontDataFactory:Se?null:new y({baseUrl:x})};if(!h){const Ve={verbosity:d,port:qi.workerPort};h=Ve.port?Xu.fromPort(Ve):new Xu(Ve),e._worker=h}const Ct={docId:t,apiVersion:"4.10.38",data:s,password:o,disableAutoFetch:ge,rangeChunkSize:c,length:le,docBaseUrl:f,enableXfa:q,evaluatorOptions:{maxImageSize:_,disableFontFace:D,ignoreErrors:b,isEvalSupported:C,isOffscreenCanvasSupported:R,isImageDecoderSupported:I,canvasMaxAreaInBytes:O,fontExtraProperties:B,useSystemFonts:re,cMapUrl:Se?p:null,standardFontDataUrl:Se?x:null}},qt={disableFontFace:D,fontExtraProperties:B,ownerDocument:K,pdfBug:Be,styleElement:ve,loadingParams:{disableAutoFetch:ge,enableXfa:q}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ve=h.messageHandler.sendWithPromise("GetDocRequest",Ct,s?[s.buffer]:null);let F;if(l)F=new KC(l,{disableRange:de,disableStream:Re});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");let se;if(Sr)if(Fh(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");se=kw}else se=oR;else se=Fh(n)?kw:rR;F=new se({url:n,length:le,httpHeaders:i,withCredentials:a,rangeChunkSize:c,disableRange:de,disableStream:Re})}return Ve.then(se=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ae=new $h(t,se,h.port),Ie=new ER(ae,e,F,qt,De);e._transport=Ie,ae.send("Ready",null)})}).catch(e._capability.reject),e}function bR(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(Sr&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function SR(r){if(Sr&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return I1(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Tw(r){return typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0}var e1;const t1=class t1{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${xr(t1,e1)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,n,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};e1=new WeakMap,E(t1,e1,0);let L4=t1;class IS{constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ke("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class _R{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ce(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Fa,Ri,Hn,Au,zp;class xR{constructor(e,t,n,s=!1){E(this,Hn);E(this,Fa,null);E(this,Ri,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new fw:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new OS,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:i=!1}={}){return new Sf({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ce(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:s=ba.ENABLE,transform:i=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1}){var C,R;(C=this._stats)==null||C.time("Overall");const f=this._transport.getRenderingIntent(n,s,h,d),{renderingIntent:p,cacheKey:g}=f;S(this,Ri,!1),k(this,Hn,zp).call(this),o||(o=this._transport.getOptionalContentConfig(p));let w=this._intentStates.get(g);w||(w=Object.create(null),this._intentStates.set(g,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const x=!!(p&vn.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(R=this._stats)==null||R.time("Page Request"),this._pumpOperatorList(f));const y=I=>{var O;w.renderTasks.delete(b),(this._maybeCleanupAfterRender||x)&&S(this,Ri,!0),k(this,Hn,Au).call(this,!x),I?(b.capability.reject(I),this._abortOperatorList({intentState:w,reason:I instanceof Error?I:new Error(I)})):b.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(O=globalThis.Stats)!=null&&O.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},b=new F4({callback:y,params:{canvasContext:e,viewport:t,transform:i,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c});(w.renderTasks||(w.renderTasks=new Set)).add(b);const _=b.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([I,O])=>{var D;if(this.destroyed){y();return}if((D=this._stats)==null||D.time("Rendering"),!(O.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");b.initializeGraphics({transparency:I,optionalContentConfig:O}),b.operatorListChanged()}).catch(y),_}getOperatorList({intent:e="display",annotationMode:t=ba.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){var c;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,n,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>B0.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function i(){a.read().then(function({value:l,done:c}){if(c){n(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),S(this,Ri,!1),k(this,Hn,zp).call(this),Promise.all(e)}cleanup(e=!1){S(this,Ri,!0);const t=k(this,Hn,Au).call(this,!1);return e&&t&&this._stats&&(this._stats=new fw),t}_startRenderPage(e,t){var s,i;const n=this._intentStates.get(t);n&&((s=this._stats)==null||s.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&k(this,Hn,Au).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:i,transfer:a}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:s},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:d,done:f})=>{if(f){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),h())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const f of c.renderTasks)f.operatorListChanged();k(this,Hn,Au).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof M2){let s=fR;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new fo(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,i]of this._intentStates)if(i===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Fa=new WeakMap,Ri=new WeakMap,Hn=new WeakSet,Au=function(e=!1){if(k(this,Hn,zp).call(this),!u(this,Ri)||this.destroyed)return!1;if(e)return S(this,Fa,setTimeout(()=>{S(this,Fa,null),k(this,Hn,Au).call(this,!1)},pR)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),S(this,Ri,!1),!0},zp=function(){u(this,Fa)&&(clearTimeout(u(this,Fa)),S(this,Fa,null))};var Pi,r1;class AR{constructor(){E(this,Pi,new Map);E(this,r1,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};u(this,r1).then(()=>{for(const[s]of u(this,Pi))s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted){Ae("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}u(this,Pi).set(t,s)}removeEventListener(e,t){const n=u(this,Pi).get(t);n==null||n(),u(this,Pi).delete(t)}terminate(){for(const[,e]of u(this,Pi))e==null||e();u(this,Pi).clear()}}Pi=new WeakMap,r1=new WeakMap;var n1,wl,bl,_c,Bp,xc,jp;const it=class it{constructor({name:e=null,port:t=null,verbosity:n=iC()}={}){E(this,_c);var s;if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=u(it,bl))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(u(it,bl)||S(it,bl,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new $h("main","worker",e),this._messageHandler.on("ready",function(){}),k(this,_c,Bp).call(this)}_initialize(){if(u(it,wl)||u(it,xc,jp)){this._setupFakeWorker();return}let{workerSrc:e}=it;try{it._isSameOrigin(window.location.href,e)||(e=it._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new $h("main","worker",t),s=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:i.signal}),n.on("test",o=>{if(i.abort(),this.destroyed||!o){s();return}this._messageHandler=n,this._port=t,this._webWorker=t,k(this,_c,Bp).call(this)}),n.on("ready",o=>{if(i.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};a();return}catch{M1("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){u(it,wl)||(Ae("Setting up fake worker."),S(it,wl,!0)),it._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new AR;this._port=t;const n=`fake${xr(it,n1)._++}`,s=new $h(n+"_worker",n,t);e.setup(s,t),this._messageHandler=new $h(n,n+"_worker",t),k(this,_c,Bp).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,n;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=u(it,bl))==null||t.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(n=u(this,bl))==null?void 0:n.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new it(e)}static get workerSrc(){if(qi.workerSrc)return qi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ce(this,"_setupFakeWorkerGlobal",(async()=>u(this,xc,jp)?u(this,xc,jp):(await import(this.workerSrc)).WorkerMessageHandler)())}};n1=new WeakMap,wl=new WeakMap,bl=new WeakMap,_c=new WeakSet,Bp=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},xc=new WeakSet,jp=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},E(it,xc),E(it,n1,0),E(it,wl,!1),E(it,bl),Sr&&(S(it,wl,!0),qi.workerSrc||(qi.workerSrc="./pdf.worker.mjs")),it._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const s=new URL(t,n);return n.origin===s.origin},it._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Xu=it;var Mi,qs,Ac,Ec,Ii,Sl,Gh;class ER{constructor(e,t,n,s,i){E(this,Sl);E(this,Mi,new Map);E(this,qs,new Map);E(this,Ac,new Map);E(this,Ec,new Map);E(this,Ii,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new OS,this.fontLoader=new AC({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Ce(this,"annotationStorage",new L2)}getRenderingIntent(e,t=ba.ENABLE,n=null,s=!1,i=!1){let a=vn.DISPLAY,o=A4;switch(e){case"any":a=vn.ANY;break;case"display":break;case"print":a=vn.PRINT;break;default:Ae(`getRenderingIntent - invalid intent: ${e}`)}const l=a&vn.PRINT&&n instanceof cS?n:this.annotationStorage;switch(t){case ba.DISABLE:a+=vn.ANNOTATIONS_DISABLE;break;case ba.ENABLE:break;case ba.ENABLE_FORMS:a+=vn.ANNOTATIONS_FORMS;break;case ba.ENABLE_STORAGE:a+=vn.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Ae(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=vn.IS_EDITING),i&&(a+=vn.OPLIST);const{ids:c,hash:h}=l.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=u(this,Ii))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of u(this,qs).values())e.push(s._destroy());u(this,qs).clear(),u(this,Ac).clear(),u(this,Ec).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,i;this.commonObjs.clear(),this.fontLoader.clear(),u(this,Mi).clear(),this.filterFactory.destroy(),z0.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new fo("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{It(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},s.onPull=()=>{this._fullReader.read().then(function({value:i,done:a}){if(a){s.close();return}It(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{s.error(i)})},s.onCancel=i=>{this._fullReader.cancel(i),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async n=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:a}=this._fullReader;return(!s||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:a}}),e.on("GetRangeReader",(n,s)=>{It(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){s.close();return}s.onPull=()=>{i.read().then(function({value:a,done:o}){if(o){s.close();return}It(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{i.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new _R(n,this))}),e.on("DocException",n=>{t._capability.reject(Ur(n))}),e.on("PasswordRequest",n=>{S(this,Ii,Promise.withResolvers());try{if(!t.onPassword)throw Ur(n);const s=i=>{i instanceof Error?u(this,Ii).reject(i):u(this,Ii).resolve({password:i})};t.onPassword(s,n.code)}catch(s){u(this,Ii).reject(s)}return u(this,Ii).promise}),e.on("DataLoaded",n=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;u(this,qs).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,i])=>{var a;if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in i){const p=i.error;Ae(`Error during font loading: ${p}`),this.commonObjs.resolve(n,p);break}const h=c&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,d=new EC(i,{disableFontFace:o,fontExtraProperties:l,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!l&&d.data&&(d.data=null),this.commonObjs.resolve(n,d)});break;case"CopyLocalImage":const{imageRef:f}=i;It(f,"The imageRef must be defined.");for(const p of u(this,qs).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===f)return g.dataLen?(this.commonObjs.resolve(n,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,i,a])=>{var l;if(this.destroyed)return;const o=u(this,qs).get(s);if(!o.objs.has(n)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(i){case"Image":o.objs.resolve(n,a),(a==null?void 0:a.dataLen)>eC&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(n,a);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ae("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=u(this,Ac).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&u(this,Ec).set(i.refStr,e);const a=new xR(t,i,this,this._params.pdfBug);return u(this,qs).set(t,a),a});return u(this,Ac).set(t,s),s}getPageIndex(e){return Tw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return k(this,Sl,Gh).call(this,"GetFieldObjects")}hasJSActions(){return k(this,Sl,Gh).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return k(this,Sl,Gh).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return k(this,Sl,Gh).call(this,"GetOptionalContentConfig").then(t=>new WC(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=u(this,Mi).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>{var i,a;return{info:s[0],metadata:s[1]?new VC(s[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return u(this,Mi).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of u(this,qs).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),u(this,Mi).clear(),this.filterFactory.destroy(!0),z0.cleanup()}}cachedPageNumber(e){if(!Tw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return u(this,Ec).get(t)??null}}Mi=new WeakMap,qs=new WeakMap,Ac=new WeakMap,Ec=new WeakMap,Ii=new WeakMap,Sl=new WeakSet,Gh=function(e,t=null){const n=u(this,Mi).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return u(this,Mi).set(e,s),s};const Ph=Symbol("INITIAL_DATA");var ln,Md,D4;class OS{constructor(){E(this,Md);E(this,ln,Object.create(null))}get(e,t=null){if(t){const s=k(this,Md,D4).call(this,e);return s.promise.then(()=>t(s.data)),null}const n=u(this,ln)[e];if(!n||n.data===Ph)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=u(this,ln)[e];return!!t&&t.data!==Ph}delete(e){const t=u(this,ln)[e];return!t||t.data===Ph?!1:(delete u(this,ln)[e],!0)}resolve(e,t=null){const n=k(this,Md,D4).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in u(this,ln)){const{data:n}=u(this,ln)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}S(this,ln,Object.create(null))}*[Symbol.iterator](){for(const e in u(this,ln)){const{data:t}=u(this,ln)[e];t!==Ph&&(yield[e,t])}}}ln=new WeakMap,Md=new WeakSet,D4=function(e){var t;return(t=u(this,ln))[e]||(t[e]={...Promise.withResolvers(),data:Ph})};var za;class kR{constructor(e){E(this,za,null);S(this,za,e),this.onContinue=null}get promise(){return u(this,za).capability.promise}cancel(e=0){u(this,za).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=u(this,za).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=u(this,za);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}za=new WeakMap;var Ba,_l;const Bo=class Bo{constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){E(this,Ba,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new kR(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(u(Bo,_l).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(Bo,_l).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:s,transform:i,background:a}=this.params;this.gfx=new Ku(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),u(this,Ba)&&(window.cancelAnimationFrame(u(this,Ba)),S(this,Ba,null)),u(Bo,_l).delete(this._canvas),this.callback(e||new M2(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?S(this,Ba,window.requestAnimationFrame(()=>{S(this,Ba,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(Bo,_l).delete(this._canvas),this.callback())))}};Ba=new WeakMap,_l=new WeakMap,E(Bo,_l,new WeakSet);let F4=Bo;const TR="4.10.38",CR="f9bea397f";function Cw(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Mh(r){return Math.max(0,Math.min(255,255*r))}class Rw{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Mh(e),[e,e,e]}static G_HTML([e]){const t=Cw(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Mh)}static RGB_HTML(e){return`#${e.map(Cw).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[Mh(1-Math.min(1,e+s)),Mh(1-Math.min(1,n+s)),Mh(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,i=1-t,a=1-n,o=Math.min(s,i,a);return["CMYK",s,i,a,o]}}class RR{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ke("Abstract method `_createSVG` called.")}}class F2 extends RR{_createSVG(e){return document.createElementNS(ci,e)}}class NS{static setupStorage(e,t,n,s,i){const a=s.getValue(t,{value:null});switch(n.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),i==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(a.value===n.attributes.xfaOn?e.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),i==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of n.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:i}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&i.addLinkAttributes(e,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(e,a.dataId,t,n)}static render(e){var d,f;const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,i=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:i,linkService:n});const o=i!=="richText",l=e.div;if(l.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);a.append(p),o&&B0.shouldBuildText(s.name)&&c.push(p)}return{textDivs:c}}const h=[[s,-1,a]];for(;h.length>0;){const[p,g,w]=h.at(-1);if(g+1===p.children.length){h.pop();continue}const x=p.children[++h.at(-1)[1]];if(x===null)continue;const{name:y}=x;if(y==="#text"){const _=document.createTextNode(x.value);c.push(_),w.append(_);continue}const b=(d=x==null?void 0:x.attributes)!=null&&d.xmlns?document.createElementNS(x.attributes.xmlns,y):document.createElement(y);if(w.append(b),x.attributes&&this.setAttributes({html:b,element:x,storage:t,intent:i,linkService:n}),((f=x.children)==null?void 0:f.length)>0)h.push([x,-1,b]);else if(x.value){const _=document.createTextNode(x.value);o&&B0.shouldBuildText(y)&&c.push(_),b.append(_)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const xf=1e3,PR=9,su=new WeakSet;function uo(r){return{width:r[2]-r[0],height:r[3]-r[1]}}class MR{static create(e){switch(e.data.annotationType){case Lt.LINK:return new LS(e);case Lt.TEXT:return new IR(e);case Lt.WIDGET:switch(e.data.fieldType){case"Tx":return new OR(e);case"Btn":return e.data.radioButton?new zS(e):e.data.checkBox?new LR(e):new DR(e);case"Ch":return new FR(e);case"Sig":return new NR(e)}return new lu(e);case Lt.POPUP:return new B4(e);case Lt.FREETEXT:return new HS(e);case Lt.LINE:return new BR(e);case Lt.SQUARE:return new jR(e);case Lt.CIRCLE:return new $R(e);case Lt.POLYLINE:return new qS(e);case Lt.CARET:return new HR(e);case Lt.INK:return new z2(e);case Lt.POLYGON:return new UR(e);case Lt.HIGHLIGHT:return new VS(e);case Lt.UNDERLINE:return new qR(e);case Lt.SQUIGGLY:return new VR(e);case Lt.STRIKEOUT:return new GR(e);case Lt.STAMP:return new GS(e);case Lt.FILEATTACHMENT:return new WR(e);default:return new Tt(e)}}}var xl,kc,Tc,Id,z4;const l3=class l3{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){E(this,Id);E(this,xl,null);E(this,kc,!1);E(this,Tc,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e!=null&&e.str||t!=null&&t.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return l3._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;u(this,xl)||S(this,xl,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&k(this,Id,z4).call(this,t),(n=u(this,Tc))==null||n.popup.updateEdited(e)}resetEdited(){var e;u(this,xl)&&(k(this,Id,z4).call(this,u(this,xl).rect),(e=u(this,Tc))==null||e.popup.resetEdited(),S(this,xl,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof lu||(i.tabIndex=xf);const{style:a}=i;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof B4){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,i),i}const{width:o,height:l}=uo(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(w>0||x>0){const b=`calc(${w}px * var(--scale-factor)) / calc(${x}px * var(--scale-factor))`;a.borderRadius=b}else if(this instanceof zS){const b=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=b}switch(t.borderStyle.style){case Ch.SOLID:a.borderStyle="solid";break;case Ch.DASHED:a.borderStyle="dashed";break;case Ch.BEVELED:Ae("Unimplemented border style: beveled");break;case Ch.INSET:Ae("Unimplemented border style: inset");break;case Ch.UNDERLINE:a.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(S(this,kc,!0),a.borderColor=ue.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):a.borderWidth=0}const c=ue.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:p}=s.rawDims;a.left=`${100*(c[0]-f)/h}%`,a.top=`${100*(c[1]-p)/d}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(g,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims,{width:i,height:a}=uo(this.data.rect);let o,l;e%180===0?(o=100*i/n,l=100*a/s):(o=100*a/n,l=100*i/s),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const i=s.detail[t],a=i[0],o=i.slice(1);s.target.style[n]=Rw[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[n]:Rw[`${a}_rgb`](o)})};return Ce(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const i=e[s]||n[s];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,i]of Object.entries(t)){const a=n[s];if(a){const o={detail:{[s]:i},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,i]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,x,y,b]=e.subarray(2,6);if(s===w&&i===x&&t===y&&n===b)return}const{style:a}=this.container;let o;if(u(this,kc)){const{borderColor:w,borderWidth:x}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const l=s-t,c=i-n,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const p=h.createElement("clipPath"),g=`clippath_${this.data.id}`;p.setAttribute("id",g),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let w=2,x=e.length;w<x;w+=8){const y=e[w],b=e[w+1],_=e[w+2],C=e[w+3],R=h.createElement("rect"),I=(_-t)/l,O=(i-b)/c,D=(y-_)/l,B=(b-C)/c;R.setAttribute("x",I),R.setAttribute("y",O),R.setAttribute("width",D),R.setAttribute("height",B),p.append(R),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${O}" width="${D}" height="${B}"/>`)}u(this,kc)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=S(this,Tc,new B4({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Ke("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:i,id:a,exportValues:o}of s){if(i===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!su.has(c)){Ae(`_getElementsByName - element not allowed: ${a}`);continue}n.push({id:a,exportValue:l,domElement:c})}return n}for(const s of document.getElementsByName(e)){const{exportValue:i}=s,a=s.getAttribute("data-element-id");a!==t&&su.has(s)&&n.push({id:a,exportValue:i,domElement:s})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};xl=new WeakMap,kc=new WeakMap,Tc=new WeakMap,Id=new WeakSet,z4=function(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}}}=this;n==null||n.splice(0,4,...e);const{width:c,height:h}=uo(e);t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*c/i}%`,t.height=`${100*h/a}%`):this.setRotation(s)};let Tt=l3;var wn,Io,DS,FS;class LS extends Tt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});E(this,wn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let i=!1;return t.url?(n.addLinkAttributes(s,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(s,t.action),i=!0):t.attachment?(k(this,wn,DS).call(this,s,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(k(this,wn,FS).call(this,s,t.setOCGState),i=!0):t.dest?(this._bindLink(s,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),i=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&k(this,wn,Io).call(this)}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),k(this,wn,Io).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(n.actions)){const a=s.get(i);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),k(this,wn,Io).call(this)}_bindResetFormAction(t,n){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),k(this,wn,Io).call(this),!this._fieldObjects){Ae('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var d;s==null||s();const{fields:i,refs:a,include:o}=n,l=[];if(i.length!==0||a.length!==0){const f=new Set(a);for(const p of i){const g=this._fieldObjects[p]||[];for(const{id:w}of g)f.add(w)}for(const p of Object.values(this._fieldObjects))for(const g of p)f.has(g.id)===o&&l.push(g)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const c=this.annotationStorage,h=[];for(const f of l){const{id:p}=f;switch(h.push(p),f.type){case"text":{const w=f.defaultValue||"";c.setValue(p,{value:w});break}case"checkbox":case"radiobutton":{const w=f.defaultValue===f.exportValues;c.setValue(p,{value:w});break}case"combobox":case"listbox":{const w=f.defaultValue||"";c.setValue(p,{value:w});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!su.has(g)){Ae(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}wn=new WeakSet,Io=function(){this.container.setAttribute("data-internal-link","")},DS=function(t,n,s=null){t.href=this.linkService.getAnchorUrl(""),n.description&&(t.title=n.description),t.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(n.content,n.filename,s),!1},k(this,wn,Io).call(this)},FS=function(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),k(this,wn,Io).call(this)};class IR extends Tt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class lu extends Tt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Nr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,i){n.includes("mouse")?e.addEventListener(n,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(n,a=>{var o;if(n==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(a)}}))})}_setEventListeners(e,t,n,s){var i,a,o;for(const[l,c]of n)(c==="Action"||(i=this.data.actions)!=null&&i[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ue.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||PR,i=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(Tg*s))||1,d=c/h;a=Math.min(s,l(d/Tg))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/Tg))}i.fontSize=`calc(${a}px * var(--scale-factor))`,i.color=ue.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class OR extends lu{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),i.setValue(a.id,{[s]:n})}render(){var s,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),su.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=xf,this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(n,"value",f.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";n.value=h.userValue=p,h.formattedValue=null});let d=f=>{const{formattedValue:p}=h;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",p=>{var w;if(h.focused)return;const{target:g}=p;h.userValue&&(g.value=h.userValue),h.lastCommittedValue=g.value,h.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const g={value(w){h.userValue=w.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:x}=w.detail;h.formattedValue=x,x!=null&&w.target!==document.activeElement&&(w.target.value=x),e.setValue(t,{formattedValue:x})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var _;const{charLimit:x}=w.detail,{target:y}=w;if(x===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",x);let b=h.userValue;!b||b.length<=x||(b=b.slice(0,x),y.value=h.userValue=b,e.setValue(t,{value:b}),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(g,p)}),n.addEventListener("keydown",p=>{var x;h.commitKey=1;let g=-1;if(p.key==="Escape"?g=0:p.key==="Enter"&&!this.data.multiLine?g=2:p.key==="Tab"&&(h.commitKey=3),g===-1)return;const{value:w}=p.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:g,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=d;d=null,n.addEventListener("blur",p=>{var w,x;if(!h.focused||!p.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(h.focused=!1);const{value:g}=p.target;h.userValue=g,h.lastCommittedValue!==g&&((x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(i=this.data.actions)!=null&&i.Keystroke&&n.addEventListener("beforeinput",p=>{var R;h.lastCommittedValue=null;const{data:g,target:w}=p,{value:x,selectionStart:y,selectionEnd:b}=w;let _=y,C=b;switch(p.inputType){case"deleteWordBackward":{const I=x.substring(0,y).match(/\w*[^\w]*$/);I&&(_-=I[0].length);break}case"deleteWordForward":{const I=x.substring(y).match(/^[^\w]*\w*/);I&&(C+=I[0].length);break}case"deleteContentBackward":y===b&&(_-=1);break;case"deleteContentForward":y===b&&(C+=1);break}p.preventDefault(),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,change:g||"",willCommit:!1,selStart:_,selEnd:C}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&n.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class NR extends lu{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class LR extends lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return su.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=xf,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,n)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(n,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class zS extends lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,n))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(su.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=xf,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,n))e.setValue(c.id,{value:!1});e.setValue(n,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const f=h&&d.id===n;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class DR extends LS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class FR extends lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");su.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=xf;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of s.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,n.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),i=!1),s.append(d)}let a=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:f,multiple:p}=s;return p?Array.prototype.filter.call(f,g=>g.selected).map(g=>g[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let l=o(!1);const c=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const d={value(f){a==null||a();const p=f.detail.value,g=new Set(Array.isArray(p)?p:[p]);for(const w of s.options)w.selected=g.has(w.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){s.multiple=!0},remove(f){const p=s.options,g=f.detail.remove;p[g].selected=!1,s.remove(g),p.length>0&&Array.prototype.findIndex.call(p,x=>x.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},clear(f){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){const{index:p,displayValue:g,exportValue:w}=f.detail.insert,x=s.children[p],y=document.createElement("option");y.textContent=g,y.value=w,x?x.before(y):s.append(y),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},items(f){const{items:p}=f.detail;for(;s.length!==0;)s.remove(0);for(const g of p){const{displayValue:w,exportValue:x}=g,y=document.createElement("option");y.textContent=w,y.value=x,s.append(y)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(f)}),l=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const g of f.target.options)g.selected=p.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),s.addEventListener("input",h=>{var p;const d=o(!0),f=o(!1);e.setValue(t,{value:d}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class B4 extends Tt{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Tt._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new zR({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${P2}${n}`).join(",")),this.container}}var Cc,s1,i1,Rc,Al,St,Oi,Pc,Od,Nd,Mc,Ni,hs,Li,Ld,Di,Dd,El,kl,We,$p,j4,BS,jS,$S,US,Up,Hp,$4;class zR{constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:i,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:d}){E(this,We);E(this,Cc,k(this,We,$S).bind(this));E(this,s1,k(this,We,$4).bind(this));E(this,i1,k(this,We,Hp).bind(this));E(this,Rc,k(this,We,Up).bind(this));E(this,Al,null);E(this,St,null);E(this,Oi,null);E(this,Pc,null);E(this,Od,null);E(this,Nd,null);E(this,Mc,null);E(this,Ni,!1);E(this,hs,null);E(this,Li,null);E(this,Ld,null);E(this,Di,null);E(this,Dd,null);E(this,El,null);E(this,kl,!1);var f;S(this,St,e),S(this,Dd,s),S(this,Oi,a),S(this,Di,o),S(this,Nd,l),S(this,Al,t),S(this,Ld,c),S(this,Mc,h),S(this,Od,n),S(this,Pc,O2.toDateObject(i)),this.trigger=n.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",u(this,Rc)),p.addEventListener("mouseenter",u(this,i1)),p.addEventListener("mouseleave",u(this,s1)),p.classList.add("popupTriggerArea");for(const p of n)(f=p.container)==null||f.addEventListener("keydown",u(this,Cc));u(this,St).hidden=!0,d&&k(this,We,Up).call(this)}render(){if(u(this,hs))return;const e=S(this,hs,document.createElement("div"));if(e.className="popup",u(this,Al)){const i=e.style.outlineColor=ue.makeHexColor(...u(this,Al));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=ue.makeHexColor(...u(this,Al).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=u(this,Dd),e.append(t),u(this,Pc)){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,Pc).valueOf()})),t.append(i)}const s=u(this,We,$p);if(s)NS.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(u(this,Oi));e.append(i)}u(this,St).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let i=0,a=s.length;i<a;++i){const o=s[i];n.append(document.createTextNode(o)),i<a-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;u(this,El)||S(this,El,{contentsObj:u(this,Oi),richText:u(this,Di)}),e&&S(this,Li,null),t&&(S(this,Di,k(this,We,jS).call(this,t)),S(this,Oi,null)),(n=u(this,hs))==null||n.remove(),S(this,hs,null)}resetEdited(){var e;u(this,El)&&({contentsObj:xr(this,Oi)._,richText:xr(this,Di)._}=u(this,El),S(this,El,null),(e=u(this,hs))==null||e.remove(),S(this,hs,null),S(this,Li,null))}forceHide(){S(this,kl,this.isVisible),u(this,kl)&&(u(this,St).hidden=!0)}maybeShow(){u(this,kl)&&(u(this,hs)||k(this,We,Hp).call(this),S(this,kl,!1),u(this,St).hidden=!1)}get isVisible(){return u(this,St).hidden===!1}}Cc=new WeakMap,s1=new WeakMap,i1=new WeakMap,Rc=new WeakMap,Al=new WeakMap,St=new WeakMap,Oi=new WeakMap,Pc=new WeakMap,Od=new WeakMap,Nd=new WeakMap,Mc=new WeakMap,Ni=new WeakMap,hs=new WeakMap,Li=new WeakMap,Ld=new WeakMap,Di=new WeakMap,Dd=new WeakMap,El=new WeakMap,kl=new WeakMap,We=new WeakSet,$p=function(){const e=u(this,Di),t=u(this,Oi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&u(this,Di).html||null},j4=function(){var e,t,n;return((n=(t=(e=u(this,We,$p))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},BS=function(){var e,t,n;return((n=(t=(e=u(this,We,$p))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},jS=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:u(this,We,BS),fontSize:u(this,We,j4)?`calc(${u(this,We,j4)}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:s});return n},$S=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&u(this,Ni))&&k(this,We,Up).call(this)},US=function(){if(u(this,Li)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:i}}}=u(this,Nd);let a=!!u(this,Mc),o=a?u(this,Mc):u(this,Ld);for(const g of u(this,Od))if(!o||ue.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=ue.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,f=l[1];S(this,Li,[100*(d-s)/t,100*(f-i)/n]);const{style:p}=u(this,St);p.left=`${u(this,Li)[0]}%`,p.top=`${u(this,Li)[1]}%`},Up=function(){S(this,Ni,!u(this,Ni)),u(this,Ni)?(k(this,We,Hp).call(this),u(this,St).addEventListener("click",u(this,Rc)),u(this,St).addEventListener("keydown",u(this,Cc))):(k(this,We,$4).call(this),u(this,St).removeEventListener("click",u(this,Rc)),u(this,St).removeEventListener("keydown",u(this,Cc)))},Hp=function(){u(this,hs)||this.render(),this.isVisible?u(this,Ni)&&u(this,St).classList.add("focused"):(k(this,We,US).call(this),u(this,St).hidden=!1,u(this,St).style.zIndex=parseInt(u(this,St).style.zIndex)+1e3)},$4=function(){u(this,St).classList.remove("focused"),!(u(this,Ni)||!this.isVisible)&&(u(this,St).hidden=!0,u(this,St).style.zIndex=parseInt(u(this,St).style.zIndex)-1e3)};class HS extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=xe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Fd;class BR extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Fd,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:n,height:s}=uo(t.rect),i=this.svgFactory.create(n,s,!0),a=S(this,Fd,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Fd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fd=new WeakMap;var zd;class jR extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,zd,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:n,height:s}=uo(t.rect),i=this.svgFactory.create(n,s,!0),a=t.borderStyle.width,o=S(this,zd,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",n-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,zd)}addHighlightArea(){this.container.classList.add("highlightArea")}}zd=new WeakMap;var Bd;class $R extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Bd,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:n,height:s}=uo(t.rect),i=this.svgFactory.create(n,s,!0),a=t.borderStyle.width,o=S(this,Bd,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",n/2),o.setAttribute("cy",s/2),o.setAttribute("rx",n/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Bd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bd=new WeakMap;var jd;class qS extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,jd,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:s,popupRef:i}}=this;if(!n)return this.container;const{width:a,height:o}=uo(t),l=this.svgFactory.create(a,o,!0);let c=[];for(let d=0,f=n.length;d<f;d+=2){const p=n[d]-t[0],g=t[3]-n[d+1];c.push(`${p},${g}`)}c=c.join(" ");const h=S(this,jd,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,jd)}addHighlightArea(){this.container.classList.add("highlightArea")}}jd=new WeakMap;class UR extends qS{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class HR extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var $d,Tl,Ud,U4;class z2 extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Ud);E(this,$d,null);E(this,Tl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?xe.HIGHLIGHT:xe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:s,borderStyle:i,popupRef:a}}=this,{transform:o,width:l,height:c}=k(this,Ud,U4).call(this,n,t),h=this.svgFactory.create(l,c,!0),d=S(this,$d,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let f=0,p=s.length;f<p;f++){const g=this.svgFactory.createElement(this.svgElementName);u(this,Tl).push(g),g.setAttribute("points",s[f].join(",")),d.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:s,rect:i}=t,a=u(this,$d);if(n>=0&&a.setAttribute("stroke-width",n||1),s)for(let o=0,l=u(this,Tl).length;o<l;o++)u(this,Tl)[o].setAttribute("points",s[o].join(","));if(i){const{transform:o,width:l,height:c}=k(this,Ud,U4).call(this,this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return u(this,Tl)}addHighlightArea(){this.container.classList.add("highlightArea")}}$d=new WeakMap,Tl=new WeakMap,Ud=new WeakSet,U4=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class VS extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=xe.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class qR extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class VR extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class GR extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class GS extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=xe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Hd,qd,H4;class WR extends Tt{constructor(t){var s;super(t,{isRenderable:!0});E(this,qd);E(this,Hd,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",k(this,qd,H4).bind(this)),S(this,Hd,s);const{isMac:i}=Nr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&k(this,qd,H4).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return u(this,Hd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hd=new WeakMap,qd=new WeakSet,H4=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Vd,Cl,Rl,Gd,iu,WS,q4;class KR{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:i,viewport:a,structTreeLayer:o}){E(this,iu);E(this,Vd,null);E(this,Cl,null);E(this,Rl,new Map);E(this,Gd,null);this.div=e,S(this,Vd,t),S(this,Cl,n),S(this,Gd,o||null),this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return u(this,Rl).size>0}async render(e){var a;const{annotations:t}=e,n=this.div;ru(n,this.viewport);const s=new Map,i={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new F2,annotationStorage:e.annotationStorage||new L2,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===Lt.POPUP;if(l){const d=s.get(o.id);if(!d)continue;i.elements=d}else{const{width:d,height:f}=uo(o.rect);if(d<=0||f<=0)continue}i.data=o;const c=MR.create(i);if(!c.isRenderable)continue;if(!l&&o.popupRef){const d=s.get(o.popupRef);d?d.push(c):s.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),await k(this,iu,WS).call(this,h,o.id),c._isEditable&&(u(this,Rl).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}k(this,iu,q4).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,ru(t,{rotation:e.rotation}),k(this,iu,q4).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Rl).values())}getEditableAnnotation(e){return u(this,Rl).get(e)}}Vd=new WeakMap,Cl=new WeakMap,Rl=new WeakMap,Gd=new WeakMap,iu=new WeakSet,WS=async function(e,t){var a,o;const n=e.firstChild||e,s=n.id=`${P2}${t}`,i=await((a=u(this,Gd))==null?void 0:a.getAriaAttributes(s));if(i)for(const[l,c]of i)n.setAttribute(l,c);this.div.append(e),(o=u(this,Vd))==null||o.moveElementInDOM(this.div,e,n,!1)},q4=function(){if(!u(this,Cl))return;const e=this.div;for(const[t,n]of u(this,Cl)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:i}=s;i?i.nodeName==="CANVAS"?i.replaceWith(n):i.classList.contains("annotationContent")?i.after(n):i.before(n):s.append(n)}u(this,Cl).clear()};const np=/\r\n?|\n/g;var ds,un,Wd,Pl,cn,Ot,KS,XS,YS,qp,Qi,Vp,Gp,QS,G4,JS;const Je=class Je extends gt{constructor(t){super({...t,name:"freeTextEditor"});E(this,Ot);E(this,ds);E(this,un,"");E(this,Wd,`${this.id}-editor`);E(this,Pl,null);E(this,cn);S(this,ds,t.color||Je._defaultColor||gt._defaultLineColor),S(this,cn,t.fontSize||Je._defaultFontSize)}static get _keyboardManager(){const t=Je.prototype,n=a=>a.isEmpty(),s=nu.TRANSLATE_SMALL,i=nu.TRANSLATE_BIG;return Ce(this,"_keyboardManager",new _f([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}]]))}static initialize(t,n){gt.initialize(t,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Me.FREETEXT_SIZE:Je._defaultFontSize=n;break;case Me.FREETEXT_COLOR:Je._defaultColor=n;break}}updateParams(t,n){switch(t){case Me.FREETEXT_SIZE:k(this,Ot,KS).call(this,n);break;case Me.FREETEXT_COLOR:k(this,Ot,XS).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Me.FREETEXT_SIZE,Je._defaultFontSize],[Me.FREETEXT_COLOR,Je._defaultColor||gt._defaultLineColor]]}get propertiesToUpdate(){return[[Me.FREETEXT_SIZE,u(this,cn)],[Me.FREETEXT_COLOR,u(this,ds)]]}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Je._internalPadding*t,-(Je._internalPadding+u(this,cn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(xe.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),S(this,Pl,new AbortController);const t=this._uiManager.combinedSignal(u(this,Pl));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,Wd)),this._isDraggable=!0,(t=u(this,Pl))==null||t.abort(),S(this,Pl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,un),n=S(this,un,k(this,Ot,YS).call(this).trimEnd());if(t===n)return;const s=i=>{if(S(this,un,i),!i){this.remove();return}k(this,Ot,Gp).call(this),this._uiManager.rebuild(this),k(this,Ot,qp).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(t)},mustExec:!1}),k(this,Ot,qp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Je._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,n;this.width&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,Wd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${u(this,cn)}px * var(--scale-factor))`,s.color=u(this,ds),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Nm(this,this.div,["dblclick","keydown"]),this.width){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,d]=this.pageDimensions,[f,p]=this.pageTranslation;let g,w;switch(this.rotation){case 0:g=t+(o[0]-f)/h,w=n+this.height-(o[1]-p)/d;break;case 90:g=t+(o[0]-f)/h,w=n-(o[1]-p)/d,[l,c]=[c,-l];break;case 180:g=t-this.width+(o[0]-f)/h,w=n-(o[1]-p)/d,[l,c]=[-l,-c];break;case 270:g=t+(o[0]-f-this.height*d)/h,w=n+(o[1]-p-this.width*h)/d,[l,c]=[-c,l];break}this.setAt(g*i,w*a,l,c)}else this.setAt(t*i,n*a,this.width*i,this.height*a);k(this,Ot,Gp).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,w,x;const n=t.clipboardData||window.clipboardData,{types:s}=n;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const i=k(g=Je,Qi,G4).call(g,n.getData("text")||"").replaceAll(np,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],d=[];if(l.nodeType===Node.TEXT_NODE){const y=l.parentElement;if(d.push(l.nodeValue.slice(c).replaceAll(np,"")),y!==this.editorDiv){let b=h;for(const _ of this.editorDiv.childNodes){if(_===y){b=d;continue}b.push(k(w=Je,Qi,Vp).call(w,_))}}h.push(l.nodeValue.slice(0,c).replaceAll(np,""))}else if(l===this.editorDiv){let y=h,b=0;for(const _ of this.editorDiv.childNodes)b++===c&&(y=d),y.push(k(x=Je,Qi,Vp).call(x,_))}S(this,un,`${h.join(`
`)}${i}${d.join(`
`)}`),k(this,Ot,Gp).call(this);const f=new Range;let p=h.reduce((y,b)=>y+b.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const b=y.nodeValue.length;if(p<=b){f.setStart(y,p),f.setEnd(y,p);break}p-=b}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,s){var o;let i=null;if(t instanceof HS){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:d,id:f,popupRef:p},textContent:g,textPosition:w,parent:{page:{pageNumber:x}}}=t;if(!g||g.length===0)return null;i=t={annotationType:xe.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:w,pageIndex:x-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:p}}const a=await super.deserialize(t,n,s);return S(a,cn,t.fontSize),S(a,ds,ue.makeHexColor(...t.color)),S(a,un,k(o=Je,Qi,G4).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=i,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Je._internalPadding*this.parentScale,s=this.getRect(n,n),i=gt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,ds)),a={annotationType:xe.FREETEXT,color:i,fontSize:u(this,cn),value:k(this,Ot,QS).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!k(this,Ot,JS).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:s}=n;s.fontSize=`calc(${u(this,cn)}px * var(--scale-factor))`,s.color=u(this,ds),n.replaceChildren();for(const a of u(this,un).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),n.append(o)}const i=Je._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:u(this,un)}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ds=new WeakMap,un=new WeakMap,Wd=new WeakMap,Pl=new WeakMap,cn=new WeakMap,Ot=new WeakSet,KS=function(t){const n=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-u(this,cn))*this.parentScale),S(this,cn,i),k(this,Ot,qp).call(this)},s=u(this,cn);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Me.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},XS=function(t){const n=i=>{S(this,ds,this.editorDiv.style.color=i)},s=u(this,ds);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Me.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},YS=function(){var s;const t=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(k(s=Je,Qi,Vp).call(s,i)),n=i);return t.join(`
`)},qp=function(){const[t,n]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/n):(this.width=s.height/t,this.height=s.width/n),this.fixAndSetPosition()},Qi=new WeakSet,Vp=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(np,"")},Gp=function(){if(this.editorDiv.replaceChildren(),!!u(this,un))for(const t of u(this,un).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},QS=function(){return u(this,un).replaceAll(""," ")},G4=function(t){return t.replaceAll(" ","")},JS=function(t){const{value:n,fontSize:s,color:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==n||t.fontSize!==s||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==a},E(Je,Qi),he(Je,"_freeTextDefaultContent",""),he(Je,"_internalPadding",0),he(Je,"_defaultColor",null),he(Je,"_defaultFontSize",10),he(Je,"_type","freetext"),he(Je,"_editorType",xe.FREETEXT);let V4=Je;class Z{toSVGPath(){Ke("Abstract method `toSVGPath` must be implemented.")}get box(){Ke("Abstract getter `box` must be implemented.")}serialize(e,t){Ke("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=n+e[o+1]*i;return a}static _rescaleAndSwap(e,t,n,s,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=n+e[o]*i;return a}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let i=0,a=e.length;i<a;i+=2)s[i]=t+e[i],s[i+1]=n+e[i+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,i){switch(i){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,i,a){return[(e+5*n)/6,(t+5*s)/6,(5*n+i)/6,(5*s+a)/6,(n+i)/2,(s+a)/2]}}he(Z,"PRECISION",1e-4);var hn,fs,Ic,Oc,Vs,Te,Ml,Il,Kd,Xd,Nc,Lc,ja,Yd,a1,o1,Ut,Wh,ZS,e_,t_,r_,n_,s_;const gi=class gi{constructor({x:e,y:t},n,s,i,a,o=0){E(this,Ut);E(this,hn);E(this,fs,[]);E(this,Ic);E(this,Oc);E(this,Vs,[]);E(this,Te,new Float32Array(18));E(this,Ml);E(this,Il);E(this,Kd);E(this,Xd);E(this,Nc);E(this,Lc);E(this,ja,[]);S(this,hn,n),S(this,Lc,i*s),S(this,Oc,a),u(this,Te).set([NaN,NaN,NaN,NaN,e,t],6),S(this,Ic,o),S(this,Xd,u(gi,Yd)*s),S(this,Kd,u(gi,o1)*s),S(this,Nc,s),u(this,ja).push(e,t)}isEmpty(){return isNaN(u(this,Te)[8])}add({x:e,y:t}){var B;S(this,Ml,e),S(this,Il,t);const[n,s,i,a]=u(this,hn);let[o,l,c,h]=u(this,Te).subarray(8,12);const d=e-c,f=t-h,p=Math.hypot(d,f);if(p<u(this,Kd))return!1;const g=p-u(this,Xd),w=g/p,x=w*d,y=w*f;let b=o,_=l;o=c,l=h,c+=x,h+=y,(B=u(this,ja))==null||B.push(e,t);const C=-y/g,R=x/g,I=C*u(this,Lc),O=R*u(this,Lc);return u(this,Te).set(u(this,Te).subarray(2,8),0),u(this,Te).set([c+I,h+O],4),u(this,Te).set(u(this,Te).subarray(14,18),12),u(this,Te).set([c-I,h-O],16),isNaN(u(this,Te)[6])?(u(this,Vs).length===0&&(u(this,Te).set([o+I,l+O],2),u(this,Vs).push(NaN,NaN,NaN,NaN,(o+I-n)/i,(l+O-s)/a),u(this,Te).set([o-I,l-O],14),u(this,fs).push(NaN,NaN,NaN,NaN,(o-I-n)/i,(l-O-s)/a)),u(this,Te).set([b,_,o,l,c,h],6),!this.isEmpty()):(u(this,Te).set([b,_,o,l,c,h],6),Math.abs(Math.atan2(_-l,b-o)-Math.atan2(y,x))<Math.PI/2?([o,l,c,h]=u(this,Te).subarray(2,6),u(this,Vs).push(NaN,NaN,NaN,NaN,((o+c)/2-n)/i,((l+h)/2-s)/a),[o,l,b,_]=u(this,Te).subarray(14,18),u(this,fs).push(NaN,NaN,NaN,NaN,((b+o)/2-n)/i,((_+l)/2-s)/a),!0):([b,_,o,l,c,h]=u(this,Te).subarray(0,6),u(this,Vs).push(((b+5*o)/6-n)/i,((_+5*l)/6-s)/a,((5*o+c)/6-n)/i,((5*l+h)/6-s)/a,((o+c)/2-n)/i,((l+h)/2-s)/a),[c,h,o,l,b,_]=u(this,Te).subarray(12,18),u(this,fs).push(((b+5*o)/6-n)/i,((_+5*l)/6-s)/a,((5*o+c)/6-n)/i,((5*l+h)/6-s)/a,((o+c)/2-n)/i,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=u(this,Vs),t=u(this,fs);if(isNaN(u(this,Te)[6])&&!this.isEmpty())return k(this,Ut,ZS).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);k(this,Ut,t_).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return k(this,Ut,e_).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,i,a){return new i_(e,t,n,s,i,a)}getOutlines(){var d;const e=u(this,Vs),t=u(this,fs),n=u(this,Te),[s,i,a,o]=u(this,hn),l=new Float32Array((((d=u(this,ja))==null?void 0:d.length)??0)+2);for(let f=0,p=l.length-2;f<p;f+=2)l[f]=(u(this,ja)[f]-s)/a,l[f+1]=(u(this,ja)[f+1]-i)/o;if(l[l.length-2]=(u(this,Ml)-s)/a,l[l.length-1]=(u(this,Il)-i)/o,isNaN(n[6])&&!this.isEmpty())return k(this,Ut,r_).call(this,l);const c=new Float32Array(u(this,Vs).length+24+u(this,fs).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){c[f]=c[f+1]=NaN;continue}c[f]=e[f],c[f+1]=e[f+1]}h=k(this,Ut,s_).call(this,c,h);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[f+p],c[h+1]=t[f+p+1],h+=2}return k(this,Ut,n_).call(this,c,h),this.newFreeDrawOutline(c,l,u(this,hn),u(this,Nc),u(this,Ic),u(this,Oc))}};hn=new WeakMap,fs=new WeakMap,Ic=new WeakMap,Oc=new WeakMap,Vs=new WeakMap,Te=new WeakMap,Ml=new WeakMap,Il=new WeakMap,Kd=new WeakMap,Xd=new WeakMap,Nc=new WeakMap,Lc=new WeakMap,ja=new WeakMap,Yd=new WeakMap,a1=new WeakMap,o1=new WeakMap,Ut=new WeakSet,Wh=function(){const e=u(this,Te).subarray(4,6),t=u(this,Te).subarray(16,18),[n,s,i,a]=u(this,hn);return[(u(this,Ml)+(e[0]-t[0])/2-n)/i,(u(this,Il)+(e[1]-t[1])/2-s)/a,(u(this,Ml)+(t[0]-e[0])/2-n)/i,(u(this,Il)+(t[1]-e[1])/2-s)/a]},ZS=function(){const[e,t,n,s]=u(this,hn),[i,a,o,l]=k(this,Ut,Wh).call(this);return`M${(u(this,Te)[2]-e)/n} ${(u(this,Te)[3]-t)/s} L${(u(this,Te)[4]-e)/n} ${(u(this,Te)[5]-t)/s} L${i} ${a} L${o} ${l} L${(u(this,Te)[16]-e)/n} ${(u(this,Te)[17]-t)/s} L${(u(this,Te)[14]-e)/n} ${(u(this,Te)[15]-t)/s} Z`},e_=function(e){const t=u(this,fs);e.push(`L${t[4]} ${t[5]} Z`)},t_=function(e){const[t,n,s,i]=u(this,hn),a=u(this,Te).subarray(4,6),o=u(this,Te).subarray(16,18),[l,c,h,d]=k(this,Ut,Wh).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-n)/i} L${l} ${c} L${h} ${d} L${(o[0]-t)/s} ${(o[1]-n)/i}`)},r_=function(e){const t=u(this,Te),[n,s,i,a]=u(this,hn),[o,l,c,h]=k(this,Ut,Wh).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-s)/a],0),this.newFreeDrawOutline(d,e,u(this,hn),u(this,Nc),u(this,Ic),u(this,Oc))},n_=function(e,t){const n=u(this,fs);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},s_=function(e,t){const n=u(this,Te).subarray(4,6),s=u(this,Te).subarray(16,18),[i,a,o,l]=u(this,hn),[c,h,d,f]=k(this,Ut,Wh).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-a)/l],t),t+=24},E(gi,Yd,8),E(gi,a1,2),E(gi,o1,u(gi,Yd)+u(gi,a1));let Fm=gi;var Dc,Ol,Fi,Qd,dn,Jd,At,l1,a_;class i_ extends Z{constructor(t,n,s,i,a,o){super();E(this,l1);E(this,Dc);E(this,Ol,new Float32Array(4));E(this,Fi);E(this,Qd);E(this,dn);E(this,Jd);E(this,At);S(this,At,t),S(this,dn,n),S(this,Dc,s),S(this,Jd,i),S(this,Fi,a),S(this,Qd,o),this.lastPoint=[NaN,NaN],k(this,l1,a_).call(this,o);const[l,c,h,d]=u(this,Ol);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-l)/h,t[f+1]=(t[f+1]-c)/d;for(let f=0,p=n.length;f<p;f+=2)n[f]=(n[f]-l)/h,n[f+1]=(n[f+1]-c)/d}toSVGPath(){const t=[`M${u(this,At)[4]} ${u(this,At)[5]}`];for(let n=6,s=u(this,At).length;n<s;n+=6){if(isNaN(u(this,At)[n])){t.push(`L${u(this,At)[n+4]} ${u(this,At)[n+5]}`);continue}t.push(`C${u(this,At)[n]} ${u(this,At)[n+1]} ${u(this,At)[n+2]} ${u(this,At)[n+3]} ${u(this,At)[n+4]} ${u(this,At)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,s,i],a){const o=s-t,l=i-n;let c,h;switch(a){case 0:c=Z._rescale(u(this,At),t,i,o,-l),h=Z._rescale(u(this,dn),t,i,o,-l);break;case 90:c=Z._rescaleAndSwap(u(this,At),t,n,o,l),h=Z._rescaleAndSwap(u(this,dn),t,n,o,l);break;case 180:c=Z._rescale(u(this,At),s,n,-o,l),h=Z._rescale(u(this,dn),s,n,-o,l);break;case 270:c=Z._rescaleAndSwap(u(this,At),s,i,-o,-l),h=Z._rescaleAndSwap(u(this,dn),s,i,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return u(this,Ol)}newOutliner(t,n,s,i,a,o=0){return new Fm(t,n,s,i,a,o)}getNewOutline(t,n){const[s,i,a,o]=u(this,Ol),[l,c,h,d]=u(this,Dc),f=a*h,p=o*d,g=s*h+l,w=i*d+c,x=this.newOutliner({x:u(this,dn)[0]*f+g,y:u(this,dn)[1]*p+w},u(this,Dc),u(this,Jd),t,u(this,Qd),n??u(this,Fi));for(let y=2;y<u(this,dn).length;y+=2)x.add({x:u(this,dn)[y]*f+g,y:u(this,dn)[y+1]*p+w});return x.getOutlines()}}Dc=new WeakMap,Ol=new WeakMap,Fi=new WeakMap,Qd=new WeakMap,dn=new WeakMap,Jd=new WeakMap,At=new WeakMap,l1=new WeakSet,a_=function(t){const n=u(this,At);let s=n[4],i=n[5],a=s,o=i,l=s,c=i,h=s,d=i;const f=t?Math.max:Math.min;for(let g=6,w=n.length;g<w;g+=6){if(isNaN(n[g]))a=Math.min(a,n[g+4]),o=Math.min(o,n[g+5]),l=Math.max(l,n[g+4]),c=Math.max(c,n[g+5]),d<n[g+5]?(h=n[g+4],d=n[g+5]):d===n[g+5]&&(h=f(h,n[g+4]));else{const x=ue.bezierBoundingBox(s,i,...n.slice(g,g+6));a=Math.min(a,x[0]),o=Math.min(o,x[1]),l=Math.max(l,x[2]),c=Math.max(c,x[3]),d<x[3]?(h=x[2],d=x[3]):d===x[3]&&(h=f(h,x[2]))}s=n[g+4],i=n[g+5]}const p=u(this,Ol);p[0]=a-u(this,Fi),p[1]=o-u(this,Fi),p[2]=l-a+2*u(this,Fi),p[3]=c-o+2*u(this,Fi),this.lastPoint=[h,d]};var Zd,ef,$a,ps,Dr,o_,Wp,l_,u_,K4;class W4{constructor(e,t=0,n=0,s=!0){E(this,Dr);E(this,Zd);E(this,ef);E(this,$a,[]);E(this,ps,[]);let i=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x,y,width:b,height:_}of e){const C=Math.floor((x-t)/c)*c,R=Math.ceil((x+b+t)/c)*c,I=Math.floor((y-t)/c)*c,O=Math.ceil((y+_+t)/c)*c,D=[C,I,O,!0],B=[R,I,O,!1];u(this,$a).push(D,B),i=Math.min(i,C),a=Math.max(a,R),o=Math.min(o,I),l=Math.max(l,O)}const h=a-i+2*n,d=l-o+2*n,f=i-n,p=o-n,g=u(this,$a).at(s?-1:-2),w=[g[0],g[2]];for(const x of u(this,$a)){const[y,b,_]=x;x[0]=(y-f)/h,x[1]=(b-p)/d,x[2]=(_-p)/d}S(this,Zd,new Float32Array([f,p,h,d])),S(this,ef,w)}getOutlines(){u(this,$a).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of u(this,$a))t[3]?(e.push(...k(this,Dr,K4).call(this,t)),k(this,Dr,l_).call(this,t)):(k(this,Dr,u_).call(this,t),e.push(...k(this,Dr,K4).call(this,t)));return k(this,Dr,o_).call(this,e)}}Zd=new WeakMap,ef=new WeakMap,$a=new WeakMap,ps=new WeakMap,Dr=new WeakSet,o_=function(e){const t=[],n=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),n.add(l),n.add(c)}const s=[];let i;for(;n.size>0;){const a=n.values().next().value;let[o,l,c,h,d]=a;n.delete(a);let f=o,p=l;for(i=[o,c],s.push(i);;){let g;if(n.has(h))g=h;else if(n.has(d))g=d;else break;n.delete(g),[o,l,c,h,d]=g,f!==o&&(i.push(f,p,o,p===l?l:c),f=o),p=p===l?c:l}i.push(f,p)}return new XR(s,u(this,Zd),u(this,ef))},Wp=function(e){const t=u(this,ps);let n=0,s=t.length-1;for(;n<=s;){const i=n+s>>1,a=t[i][0];if(a===e)return i;a<e?n=i+1:s=i-1}return s+1},l_=function([,e,t]){const n=k(this,Dr,Wp).call(this,e);u(this,ps).splice(n,0,[e,t])},u_=function([,e,t]){const n=k(this,Dr,Wp).call(this,e);for(let s=n;s<u(this,ps).length;s++){const[i,a]=u(this,ps)[s];if(i!==e)break;if(i===e&&a===t){u(this,ps).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[i,a]=u(this,ps)[s];if(i!==e)break;if(i===e&&a===t){u(this,ps).splice(s,1);return}}},K4=function(e){const[t,n,s]=e,i=[[t,n,s]],a=k(this,Dr,Wp).call(this,s);for(let o=0;o<a;o++){const[l,c]=u(this,ps)[o];for(let h=0,d=i.length;h<d;h++){const[,f,p]=i[h];if(!(c<=f||p<=l)){if(f>=l){if(p>c)i[h][1]=c;else{if(d===1)return[];i.splice(h,1),h--,d--}continue}i[h][2]=l,p>c&&i.push([t,c,p])}}}return i};var tf,Fc;class XR extends Z{constructor(t,n,s){super();E(this,tf);E(this,Fc);S(this,Fc,t),S(this,tf,n),this.lastPoint=s}toSVGPath(){const t=[];for(const n of u(this,Fc)){let[s,i]=n;t.push(`M${s} ${i}`);for(let a=2;a<n.length;a+=2){const o=n[a],l=n[a+1];o===s?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,n,s,i],a){const o=[],l=s-t,c=i-n;for(const h of u(this,Fc)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*l,d[f+1]=i-h[f+1]*c;o.push(d)}return o}get box(){return u(this,tf)}get classNamesForOutlining(){return["highlightOutline"]}}tf=new WeakMap,Fc=new WeakMap;class X4 extends Fm{newFreeDrawOutline(e,t,n,s,i,a){return new YR(e,t,n,s,i,a)}}class YR extends i_{newOutliner(e,t,n,s,i,a=0){return new X4(e,t,n,s,i,a)}}var ms,Nl,zc,Bt,rf,Bc,nf,sf,Ua,gs,jc,af,Ge,Y4,Q4,J4,Oo,c_,fa;const Hr=class Hr{constructor({editor:e=null,uiManager:t=null}){E(this,Ge);E(this,ms,null);E(this,Nl,null);E(this,zc);E(this,Bt,null);E(this,rf,!1);E(this,Bc,!1);E(this,nf,null);E(this,sf);E(this,Ua,null);E(this,gs,null);E(this,jc);var n;e?(S(this,Bc,!1),S(this,jc,Me.HIGHLIGHT_COLOR),S(this,nf,e)):(S(this,Bc,!0),S(this,jc,Me.HIGHLIGHT_DEFAULT_COLOR)),S(this,gs,(e==null?void 0:e._uiManager)||t),S(this,sf,u(this,gs)._eventBus),S(this,zc,(e==null?void 0:e.color)||((n=u(this,gs))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),u(Hr,af)||S(Hr,af,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ce(this,"_keyboardManager",new _f([[["Escape","mac+Escape"],Hr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Hr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Hr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Hr.prototype._moveToPrevious],[["Home","mac+Home"],Hr.prototype._moveToBeginning],[["End","mac+End"],Hr.prototype._moveToEnd]]))}renderButton(){const e=S(this,ms,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=u(this,gs)._signal;e.addEventListener("click",k(this,Ge,Oo).bind(this),{signal:t}),e.addEventListener("keydown",k(this,Ge,J4).bind(this),{signal:t});const n=S(this,Nl,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=u(this,zc),e.append(n),e}renderMainDropdown(){const e=S(this,Bt,k(this,Ge,Y4).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===u(this,ms)){k(this,Ge,Oo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&k(this,Ge,Q4).call(this,t,e)}_moveToNext(e){var t,n;if(!u(this,Ge,fa)){k(this,Ge,Oo).call(this,e);return}if(e.target===u(this,ms)){(t=u(this,Bt).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=u(this,Bt))==null?void 0:t.firstChild)||e.target===u(this,ms)){u(this,Ge,fa)&&this._hideDropdownFromKeyboard();return}u(this,Ge,fa)||k(this,Ge,Oo).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!u(this,Ge,fa)){k(this,Ge,Oo).call(this,e);return}(t=u(this,Bt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!u(this,Ge,fa)){k(this,Ge,Oo).call(this,e);return}(t=u(this,Bt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=u(this,Bt))==null||e.classList.add("hidden"),(t=u(this,Ua))==null||t.abort(),S(this,Ua,null)}_hideDropdownFromKeyboard(){var e;if(!u(this,Bc)){if(!u(this,Ge,fa)){(e=u(this,nf))==null||e.unselect();return}this.hideDropdown(),u(this,ms).focus({preventScroll:!0,focusVisible:u(this,rf)})}}updateColor(e){if(u(this,Nl)&&(u(this,Nl).style.backgroundColor=e),!u(this,Bt))return;const t=u(this,gs).highlightColors.values();for(const n of u(this,Bt).children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=u(this,ms))==null||e.remove(),S(this,ms,null),S(this,Nl,null),(t=u(this,Bt))==null||t.remove(),S(this,Bt,null)}};ms=new WeakMap,Nl=new WeakMap,zc=new WeakMap,Bt=new WeakMap,rf=new WeakMap,Bc=new WeakMap,nf=new WeakMap,sf=new WeakMap,Ua=new WeakMap,gs=new WeakMap,jc=new WeakMap,af=new WeakMap,Ge=new WeakSet,Y4=function(){const e=document.createElement("div"),t=u(this,gs)._signal;e.addEventListener("contextmenu",ks,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,s]of u(this,gs).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=n,i.setAttribute("data-l10n-id",u(Hr,af)[n]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=s,i.setAttribute("aria-selected",s===u(this,zc)),i.addEventListener("click",k(this,Ge,Q4).bind(this,s),{signal:t}),e.append(i)}return e.addEventListener("keydown",k(this,Ge,J4).bind(this),{signal:t}),e},Q4=function(e,t){t.stopPropagation(),u(this,sf).dispatch("switchannotationeditorparams",{source:this,type:u(this,jc),value:e})},J4=function(e){Hr._keyboardManager.exec(this,e)},Oo=function(e){if(u(this,Ge,fa)){this.hideDropdown();return}if(S(this,rf,e.detail===0),u(this,Ua)||(S(this,Ua,new AbortController),window.addEventListener("pointerdown",k(this,Ge,c_).bind(this),{signal:u(this,gs).combinedSignal(u(this,Ua))})),u(this,Bt)){u(this,Bt).classList.remove("hidden");return}const t=S(this,Bt,k(this,Ge,Y4).call(this));u(this,ms).append(t)},c_=function(e){var t;(t=u(this,Bt))!=null&&t.contains(e.target)||this.hideDropdown()},fa=function(){return u(this,Bt)&&!u(this,Bt).classList.contains("hidden")},E(Hr,af,null);let zm=Hr;var $c,of,zi,Ll,Uc,Gr,lf,uf,Dl,Dn,fn,tr,Hc,Bi,vr,qc,Fn,cf,_e,Z4,Kp,h_,d_,f_,ey,No,qn,Eu,p_,Xp,Kh,m_,g_,v_,y_,w_;const $e=class $e extends gt{constructor(t){super({...t,name:"highlightEditor"});E(this,_e);E(this,$c,null);E(this,of,0);E(this,zi);E(this,Ll,null);E(this,Uc,null);E(this,Gr,null);E(this,lf,null);E(this,uf,0);E(this,Dl,null);E(this,Dn,null);E(this,fn,null);E(this,tr,!1);E(this,Hc,null);E(this,Bi);E(this,vr,null);E(this,qc,"");E(this,Fn);E(this,cf,"");this.color=t.color||$e._defaultColor,S(this,Fn,t.thickness||$e._defaultThickness),S(this,Bi,t.opacity||$e._defaultOpacity),S(this,zi,t.boxes||null),S(this,cf,t.methodOfCreation||""),S(this,qc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(S(this,tr,!0),k(this,_e,Kp).call(this,t),k(this,_e,No).call(this)):u(this,zi)&&(S(this,$c,t.anchorNode),S(this,of,t.anchorOffset),S(this,lf,t.focusNode),S(this,uf,t.focusOffset),k(this,_e,Z4).call(this),k(this,_e,No).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=$e.prototype;return Ce(this,"_keyboardManager",new _f([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,tr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:u(this,Fn),methodOfCreation:u(this,cf)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var s;gt.initialize(t,n),$e._defaultColor||($e._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Me.HIGHLIGHT_DEFAULT_COLOR:$e._defaultColor=n;break;case Me.HIGHLIGHT_THICKNESS:$e._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return u(this,Hc)}updateParams(t,n){switch(t){case Me.HIGHLIGHT_COLOR:k(this,_e,h_).call(this,n);break;case Me.HIGHLIGHT_THICKNESS:k(this,_e,d_).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Me.HIGHLIGHT_DEFAULT_COLOR,$e._defaultColor],[Me.HIGHLIGHT_THICKNESS,$e._defaultThickness]]}get propertiesToUpdate(){return[[Me.HIGHLIGHT_COLOR,this.color||$e._defaultColor],[Me.HIGHLIGHT_THICKNESS,u(this,Fn)||$e._defaultThickness],[Me.HIGHLIGHT_FREE,u(this,tr)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(S(this,Uc,new zm({editor:this})),t.addColorPicker(u(this,Uc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(k(this,_e,Kh).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,k(this,_e,Kh).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){k(this,_e,ey).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(k(this,_e,No).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?k(this,_e,ey).call(this):t&&(k(this,_e,No).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var i,a,o;const{drawLayer:n}=this.parent;let s;u(this,tr)?(t=(t-this.rotation+360)%360,s=k(i=$e,qn,Eu).call(i,u(this,Dn).box,t)):s=k(a=$e,qn,Eu).call(a,[this.x,this.y,this.width,this.height],t),n.updateProperties(u(this,fn),{bbox:s,root:{"data-main-rotation":t}}),n.updateProperties(u(this,vr),{bbox:k(o=$e,qn,Eu).call(o,u(this,Gr).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();u(this,qc)&&(t.setAttribute("aria-label",u(this,qc)),t.setAttribute("role","mark")),u(this,tr)?t.classList.add("free"):this.div.addEventListener("keydown",k(this,_e,p_).bind(this),{signal:this._uiManager._signal});const n=S(this,Dl,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=u(this,Ll);const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),Nm(this,u(this,Dl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,vr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,vr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:k(this,_e,Xp).call(this,!0);break;case 1:case 3:k(this,_e,Xp).call(this,!1);break}}select(){var t;super.select(),u(this,vr)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,vr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),u(this,vr)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,vr),{rootClass:{selected:!1}}),u(this,tr)||k(this,_e,Xp).call(this,!1))}get _mustFixPosition(){return!u(this,tr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(u(this,fn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(u(this,vr),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:s,x:i,y:a}){const{x:o,y:l,width:c,height:h}=s.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),p=g=>{d.abort(),k(this,qn,y_).call(this,t,g)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",_n,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",ks,{signal:f}),s.addEventListener("pointermove",k(this,qn,v_).bind(this,t),{signal:f}),this._freeHighlight=new X4({x:i,y:a},[o,l,c,h],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,s){var w,x,y,b;let i=null;if(t instanceof VS){const{data:{quadPoints:_,rect:C,rotation:R,id:I,color:O,opacity:D,popupRef:B},parent:{page:{pageNumber:q}}}=t;i=t={annotationType:xe.HIGHLIGHT,color:Array.from(O),opacity:D,quadPoints:_,boxes:null,pageIndex:q-1,rect:C.slice(0),rotation:R,id:I,deleted:!1,popupRef:B}}else if(t instanceof z2){const{data:{inkLists:_,rect:C,rotation:R,id:I,color:O,borderStyle:{rawWidth:D},popupRef:B},parent:{page:{pageNumber:q}}}=t;i=t={annotationType:xe.HIGHLIGHT,color:Array.from(O),thickness:D,inkLists:_,boxes:null,pageIndex:q-1,rect:C.slice(0),rotation:R,id:I,deleted:!1,popupRef:B}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,h=await super.deserialize(t,n,s);h.color=ue.makeHexColor(...a),S(h,Bi,c||1),l&&S(h,Fn,t.thickness),h.annotationElementId=t.id||null,h._initialData=i;const[d,f]=h.pageDimensions,[p,g]=h.pageTranslation;if(o){const _=S(h,zi,[]);for(let C=0;C<o.length;C+=8)_.push({x:(o[C]-p)/d,y:1-(o[C+1]-g)/f,width:(o[C+2]-o[C])/d,height:(o[C+1]-o[C+5])/f});k(w=h,_e,Z4).call(w),k(x=h,_e,No).call(x),h.rotate(h.rotation)}else if(l){S(h,tr,!0);const _=l[0],C={x:_[0]-p,y:f-(_[1]-g)},R=new X4(C,[0,0,d,f],1,u(h,Fn)/2,!0,.001);for(let D=0,B=_.length;D<B;D+=2)C.x=_[D]-p,C.y=f-(_[D+1]-g),R.add(C);const{id:I,clipPathId:O}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:R.toSVGPath()}},!0,!0);k(y=h,_e,Kp).call(y,{highlightOutlines:R.getOutlines(),highlightId:I,clipPathId:O}),k(b=h,_e,No).call(b)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),s=gt._colorManager.convert(this.color),i={annotationType:xe.HIGHLIGHT,color:s,opacity:u(this,Bi),thickness:u(this,Fn),quadPoints:k(this,_e,m_).call(this),outlines:k(this,_e,g_).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:k(this,_e,Kh).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!k(this,_e,w_).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};$c=new WeakMap,of=new WeakMap,zi=new WeakMap,Ll=new WeakMap,Uc=new WeakMap,Gr=new WeakMap,lf=new WeakMap,uf=new WeakMap,Dl=new WeakMap,Dn=new WeakMap,fn=new WeakMap,tr=new WeakMap,Hc=new WeakMap,Bi=new WeakMap,vr=new WeakMap,qc=new WeakMap,Fn=new WeakMap,cf=new WeakMap,_e=new WeakSet,Z4=function(){const t=new W4(u(this,zi),.001);S(this,Dn,t.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,Dn).box;const n=new W4(u(this,zi),.0025,.001,this._uiManager.direction==="ltr");S(this,Gr,n.getOutlines());const{lastPoint:s}=u(this,Gr);S(this,Hc,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},Kp=function({highlightOutlines:t,highlightId:n,clipPathId:s}){var d,f;if(S(this,Dn,t),S(this,Gr,t.getNewOutline(u(this,Fn)/2+1.5,.0025)),n>=0)S(this,fn,n),S(this,Ll,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),S(this,vr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,Gr).box,path:{d:u(this,Gr).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,fn),{bbox:k(d=$e,qn,Eu).call(d,u(this,Dn).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,vr),{bbox:k(f=$e,qn,Eu).call(f,u(this,Gr).box,p),path:{d:u(this,Gr).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[p,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/p,this.height=c*p/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[p,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/p,this.height=c*p/g;break}}const{lastPoint:h}=u(this,Gr);S(this,Hc,[(h[0]-a)/l,(h[1]-o)/c])},h_=function(t){const n=(a,o)=>{var l,c;this.color=a,S(this,Bi,o),(l=this.parent)==null||l.drawLayer.updateProperties(u(this,fn),{root:{fill:a,"fill-opacity":o}}),(c=u(this,Uc))==null||c.updateColor(a)},s=this.color,i=u(this,Bi);this.addCommands({cmd:n.bind(this,t,$e._defaultOpacity),undo:n.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Me.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},d_=function(t){const n=u(this,Fn),s=i=>{S(this,Fn,i),k(this,_e,f_).call(this,i)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Me.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},f_=function(t){if(!u(this,tr))return;k(this,_e,Kp).call(this,{highlightOutlines:u(this,Dn).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,s]=this.parentDimensions;this.setDims(this.width*n,this.height*s)},ey=function(){u(this,fn)===null||!this.parent||(this.parent.drawLayer.remove(u(this,fn)),S(this,fn,null),this.parent.drawLayer.remove(u(this,vr)),S(this,vr,null))},No=function(t=this.parent){u(this,fn)===null&&({id:xr(this,fn)._,clipPathId:xr(this,Ll)._}=t.drawLayer.draw({bbox:u(this,Dn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":u(this,Bi)},rootClass:{highlight:!0,free:u(this,tr)},path:{d:u(this,Dn).toSVGPath()}},!1,!0),S(this,vr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,tr)},bbox:u(this,Gr).box,path:{d:u(this,Gr).toSVGPath()}},u(this,tr))),u(this,Dl)&&(u(this,Dl).style.clipPath=u(this,Ll)))},qn=new WeakSet,Eu=function([t,n,s,i],a){switch(a){case 90:return[1-n-i,t,i,s];case 180:return[1-t-s,1-n-i,s,i];case 270:return[n,1-t-s,i,s]}return[t,n,s,i]},p_=function(t){$e._keyboardManager.exec(this,t)},Xp=function(t){if(!u(this,$c))return;const n=window.getSelection();t?n.setPosition(u(this,$c),u(this,of)):n.setPosition(u(this,lf),u(this,uf))},Kh=function(){return u(this,tr)?this.rotation:0},m_=function(){if(u(this,tr))return null;const[t,n]=this.pageDimensions,[s,i]=this.pageTranslation,a=u(this,zi),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:h,width:d,height:f}of a){const p=c*t+s,g=(1-h)*n+i;o[l]=o[l+4]=p,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=p+d*t,o[l+5]=o[l+7]=g-f*n,l+=8}return o},g_=function(t){return u(this,Dn).serialize(t,k(this,_e,Kh).call(this))},v_=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},y_=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},w_=function(t){const{color:n}=this._initialData;return t.color.some((s,i)=>s!==n[i])},E($e,qn),he($e,"_defaultColor",null),he($e,"_defaultOpacity",1),he($e,"_defaultThickness",12),he($e,"_type","highlight"),he($e,"_editorType",xe.HIGHLIGHT),he($e,"_freeHighlightId",-1),he($e,"_freeHighlight",null),he($e,"_freeHighlightClipId","");let Bm=$e;var Fl;class QR{constructor(){E(this,Fl,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){u(this,Fl)[e]=t}toSVGProperties(){const e=u(this,Fl);return S(this,Fl,Object.create(null)),{root:e}}reset(){S(this,Fl,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ke("Not implemented")}}Fl=new WeakMap;var pn,Vc,Kt,zl,Bl,Ha,qa,Va,jl,Ne,ry,ny,sy,Xh,b_,Yp,Yh,ku;const te=class te extends gt{constructor(t){super(t);E(this,Ne);E(this,pn,null);E(this,Vc);he(this,"_drawId",null);S(this,Vc,t.mustBeCommitted||!1),t.drawOutlines&&(k(this,Ne,ry).call(this,t),k(this,Ne,Xh).call(this))}static _mergeSVGProperties(t,n){const s=new Set(Object.keys(t));for(const[i,a]of Object.entries(n))s.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){Ke("Not implemented")}static get typesMap(){Ke("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(u(te,Kt).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)t.push([s,n[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[s,i]of this.constructor.typesMap)t.push([s,n[i]]);return t}_updateProperty(t,n,s){const i=this._drawingOptions,a=i[n],o=l=>{var h;i.updateProperty(n,l);const c=u(this,pn).updateProperty(n,l);c&&k(this,Ne,Yh).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,te._mergeSVGProperties(u(this,pn).getPathResizingSVGProperties(k(this,Ne,Yp).call(this)),{bbox:k(this,Ne,ku).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,te._mergeSVGProperties(u(this,pn).getPathResizedSVGProperties(k(this,Ne,Yp).call(this)),{bbox:k(this,Ne,ku).call(this)}))}_onTranslating(t,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:k(this,Ne,ku).call(this,t,n)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,te._mergeSVGProperties(u(this,pn).getPathTranslatedSVGProperties(k(this,Ne,Yp).call(this),this.parentDimensions),{bbox:k(this,Ne,ku).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,Vc)&&(S(this,Vc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){k(this,Ne,sy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(k(this,Ne,Xh).call(this),k(this,Ne,Yh).call(this,u(this,pn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),k(this,Ne,sy).call(this)):t&&(this._uiManager.addShouldRescale(this),k(this,Ne,Xh).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,te._mergeSVGProperties({bbox:k(this,Ne,ku).call(this)},u(this,pn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&k(this,Ne,Yh).call(this,u(this,pn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const n=document.createElement("div");t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,n,s,i,a){Ke("Not implemented")}static startDrawing(t,n,s,i){var x;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:h}=i;if(u(te,qa)&&u(te,qa)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:p}=a.getBoundingClientRect(),g=S(te,zl,new AbortController),w=t.combinedSignal(g);if(u(te,Ha)||S(te,Ha,c),u(te,qa)??S(te,qa,h),window.addEventListener("pointerup",y=>{var b;u(te,Ha)===y.pointerId?this._endDraw(y):(b=u(te,Va))==null||b.delete(y.pointerId)},{signal:w}),window.addEventListener("pointercancel",y=>{var b;u(te,Ha)===y.pointerId?this._currentParent.endDrawingSession():(b=u(te,Va))==null||b.delete(y.pointerId)},{signal:w}),window.addEventListener("pointerdown",y=>{u(te,qa)===y.pointerType&&((u(te,Va)||S(te,Va,new Set)).add(y.pointerId),u(te,Kt).isCancellable()&&(u(te,Kt).removeLastElement(),u(te,Kt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",ks,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",y=>{y.timeStamp===u(te,jl)&&_n(y)},{signal:w}),t.toggleDrawing(),(x=n._editorUndoBar)==null||x.hide(),u(te,Kt)){t.drawLayer.updateProperties(this._currentDrawId,u(te,Kt).startNew(o,l,f,p,d));return}n.updateUIForDefaultProperties(this),S(te,Kt,this.createDrawerInstance(o,l,f,p,d)),S(te,Bl,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(u(te,Bl).toSVGProperties(),u(te,Kt).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(S(te,jl,-1),!u(te,Kt))return;const{offsetX:n,offsetY:s,pointerId:i}=t;if(u(te,Ha)===i){if(((a=u(te,Va))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,u(te,Kt).add(n,s)),S(te,jl,t.timeStamp),_n(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,S(te,Kt,null),S(te,Bl,null),S(te,qa,null),S(te,jl,NaN)),u(te,zl)&&(u(te,zl).abort(),S(te,zl,null),S(te,Ha,NaN),S(te,Va,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t&&n.drawLayer.updateProperties(this._currentDrawId,u(te,Kt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=u(te,Kt),i=this._currentDrawId,a=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,s.setLastElement(a))},undo:()=>{n.drawLayer.updateProperties(i,s.removeLastElement())},mustExec:!1,type:Me.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Me.DRAW_STEP),!u(te,Kt).isEmpty()){const{pageDimensions:[s,i],scale:a}=n,o=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:u(te,Kt).getOutlines(s*a,i*a,a,this._INNER_MARGIN),drawingOptions:u(te,Bl),mustBeCommitted:!t});return this._cleanup(!0),o}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,s,i,a,o){Ke("Not implemented")}static async deserialize(t,n,s){var d,f;const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}=n.viewport,c=this.deserializeDraw(o,l,i,a,this._INNER_MARGIN,t),h=await super.deserialize(t,n,s);return h.createDrawingOptions(t),k(d=h,Ne,ry).call(d,{drawOutlines:c}),k(f=h,Ne,Xh).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[n,s]=this.pageTranslation,[i,a]=this.pageDimensions;return u(this,pn).serialize([n,s,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};pn=new WeakMap,Vc=new WeakMap,Kt=new WeakMap,zl=new WeakMap,Bl=new WeakMap,Ha=new WeakMap,qa=new WeakMap,Va=new WeakMap,jl=new WeakMap,Ne=new WeakSet,ry=function({drawOutlines:t,drawId:n,drawingOptions:s}){S(this,pn,t),this._drawingOptions||(this._drawingOptions=s),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=k(this,Ne,ny).call(this,t,this.parent),k(this,Ne,Yh).call(this,t.box)},ny=function(t,n){const{id:s}=n.drawLayer.draw(te._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},sy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Xh=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=k(this,Ne,ny).call(this,u(this,pn),t)}},b_=function([t,n,s,i]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[n,1-t,s*(o/a),i*(a/o)];case 180:return[1-t,1-n,s,i];case 270:return[1-n,t,s*(o/a),i*(a/o)];default:return[t,n,s,i]}},Yp=function(){const{x:t,y:n,width:s,height:i,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-n,t,s*(a/o),i*(o/a)];case 180:return[1-t,1-n,s,i];case 270:return[n,1-t,s*(a/o),i*(o/a)];default:return[t,n,s,i]}},Yh=function(t){if([this.x,this.y,this.width,this.height]=k(this,Ne,b_).call(this,t),this.div){this.fixAndSetPosition();const[n,s]=this.parentDimensions;this.setDims(this.width*n,this.height*s)}this._onResized()},ku=function(){const{x:t,y:n,width:s,height:i,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-n-i,t,i,s];case 2:return[1-t-s,1-n-i,s,i];case 3:return[n,1-t-s,i,s];case 4:return[t,n-s*(l/c),i*(c/l),s*(l/c)];case 5:return[1-n,t,s*(l/c),i*(c/l)];case 6:return[1-t-i*(c/l),1-n,i*(c/l),s*(l/c)];case 7:return[n-s*(l/c),1-t-i*(c/l),s*(l/c),i*(c/l)];case 8:return[t-s,n-i,s,i];case 9:return[1-n,t-s,i,s];case 10:return[1-t,1-n,s,i];case 11:return[n-i,1-t,i,s];case 12:return[t-i*(c/l),n,i*(c/l),s*(l/c)];case 13:return[1-n-s*(l/c),t-i*(c/l),s*(l/c),i*(c/l)];case 14:return[1-t,1-n-s*(l/c),i*(c/l),s*(l/c)];case 15:return[n,1-t,s*(l/c),i*(c/l)];default:return[t,n,s,i]}},he(te,"_currentDrawId",-1),he(te,"_currentParent",null),E(te,Kt,null),E(te,zl,null),E(te,Bl,null),E(te,Ha,NaN),E(te,qa,null),E(te,Va,null),E(te,jl,NaN),he(te,"_INNER_MARGIN",3);let ty=te;var Gs,Xt,Yt,$l,Gc,Tr,rr,zn,Ul,Hl,ql,Wc,Qp;class JR{constructor(e,t,n,s,i,a){E(this,Wc);E(this,Gs,new Float64Array(6));E(this,Xt);E(this,Yt);E(this,$l);E(this,Gc);E(this,Tr);E(this,rr,"");E(this,zn,0);E(this,Ul,new jm);E(this,Hl);E(this,ql);S(this,Hl,n),S(this,ql,s),S(this,$l,i),S(this,Gc,a),[e,t]=k(this,Wc,Qp).call(this,e,t);const o=S(this,Xt,[NaN,NaN,NaN,NaN,e,t]);S(this,Tr,[e,t]),S(this,Yt,[{line:o,points:u(this,Tr)}]),u(this,Gs).set(o,0)}updateProperty(e,t){e==="stroke-width"&&S(this,Gc,t)}isEmpty(){return!u(this,Yt)||u(this,Yt).length===0}isCancellable(){return u(this,Tr).length<=10}add(e,t){[e,t]=k(this,Wc,Qp).call(this,e,t);const[n,s,i,a]=u(this,Gs).subarray(2,6),o=e-i,l=t-a;return Math.hypot(u(this,Hl)*o,u(this,ql)*l)<=2?null:(u(this,Tr).push(e,t),isNaN(n)?(u(this,Gs).set([i,a,e,t],2),u(this,Xt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(u(this,Gs)[0])&&u(this,Xt).splice(6,6),u(this,Gs).set([n,s,i,a,e,t],0),u(this,Xt).push(...Z.createBezierPoints(n,s,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(u(this,Tr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,i){S(this,Hl,n),S(this,ql,s),S(this,$l,i),[e,t]=k(this,Wc,Qp).call(this,e,t);const a=S(this,Xt,[NaN,NaN,NaN,NaN,e,t]);S(this,Tr,[e,t]);const o=u(this,Yt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),u(this,Yt).push({line:a,points:u(this,Tr)}),u(this,Gs).set(a,0),S(this,zn,0),this.toSVGPath(),null}getLastElement(){return u(this,Yt).at(-1)}setLastElement(e){return u(this,Yt)?(u(this,Yt).push(e),S(this,Xt,e.line),S(this,Tr,e.points),S(this,zn,0),{path:{d:this.toSVGPath()}}):u(this,Ul).setLastElement(e)}removeLastElement(){if(!u(this,Yt))return u(this,Ul).removeLastElement();u(this,Yt).pop(),S(this,rr,"");for(let e=0,t=u(this,Yt).length;e<t;e++){const{line:n,points:s}=u(this,Yt)[e];S(this,Xt,n),S(this,Tr,s),S(this,zn,0),this.toSVGPath()}return{path:{d:u(this,rr)}}}toSVGPath(){const e=Z.svgRound(u(this,Xt)[4]),t=Z.svgRound(u(this,Xt)[5]);if(u(this,Tr).length===2)return S(this,rr,`${u(this,rr)} M ${e} ${t} Z`),u(this,rr);if(u(this,Tr).length<=6){const s=u(this,rr).lastIndexOf("M");S(this,rr,`${u(this,rr).slice(0,s)} M ${e} ${t}`),S(this,zn,6)}if(u(this,Tr).length===4){const s=Z.svgRound(u(this,Xt)[10]),i=Z.svgRound(u(this,Xt)[11]);return S(this,rr,`${u(this,rr)} L ${s} ${i}`),S(this,zn,12),u(this,rr)}const n=[];u(this,zn)===0&&(n.push(`M ${e} ${t}`),S(this,zn,6));for(let s=u(this,zn),i=u(this,Xt).length;s<i;s+=6){const[a,o,l,c,h,d]=u(this,Xt).slice(s,s+6).map(Z.svgRound);n.push(`C${a} ${o} ${l} ${c} ${h} ${d}`)}return S(this,rr,u(this,rr)+n.join(" ")),S(this,zn,u(this,Xt).length),u(this,rr)}getOutlines(e,t,n,s){const i=u(this,Yt).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),u(this,Ul).build(u(this,Yt),e,t,n,u(this,$l),u(this,Gc),s),S(this,Gs,null),S(this,Xt,null),S(this,Yt,null),S(this,rr,null),u(this,Ul)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Gs=new WeakMap,Xt=new WeakMap,Yt=new WeakMap,$l=new WeakMap,Gc=new WeakMap,Tr=new WeakMap,rr=new WeakMap,zn=new WeakMap,Ul=new WeakMap,Hl=new WeakMap,ql=new WeakMap,Wc=new WeakSet,Qp=function(e,t){return Z._normalizePoint(e,t,u(this,Hl),u(this,ql),u(this,$l))};var Cr,hf,df,mn,Ws,Ks,Kc,Xc,Yc,ir,di,S_,__,x_;const u3=class u3 extends Z{constructor(){super(...arguments);E(this,ir);E(this,Cr);E(this,hf,0);E(this,df);E(this,mn);E(this,Ws);E(this,Ks);E(this,Kc);E(this,Xc);E(this,Yc)}build(t,n,s,i,a,o,l){S(this,Ws,n),S(this,Ks,s),S(this,Kc,i),S(this,Xc,a),S(this,Yc,o),S(this,df,l??0),S(this,mn,t),k(this,ir,__).call(this)}setLastElement(t){return u(this,mn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,mn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of u(this,mn)){if(t.push(`M${Z.svgRound(n[4])} ${Z.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12){t.push(`L${Z.svgRound(n[10])} ${Z.svgRound(n[11])}`);continue}for(let s=6,i=n.length;s<i;s+=6){const[a,o,l,c,h,d]=n.subarray(s,s+6).map(Z.svgRound);t.push(`C${a} ${o} ${l} ${c} ${h} ${d}`)}}return t.join("")}serialize([t,n,s,i],a){const o=[],l=[],[c,h,d,f]=k(this,ir,S_).call(this);let p,g,w,x,y,b,_,C,R;switch(u(this,Xc)){case 0:R=Z._rescale,p=t,g=n+i,w=s,x=-i,y=t+c*s,b=n+(1-h-f)*i,_=t+(c+d)*s,C=n+(1-h)*i;break;case 90:R=Z._rescaleAndSwap,p=t,g=n,w=s,x=i,y=t+h*s,b=n+c*i,_=t+(h+f)*s,C=n+(c+d)*i;break;case 180:R=Z._rescale,p=t+s,g=n,w=-s,x=i,y=t+(1-c-d)*s,b=n+h*i,_=t+(1-c)*s,C=n+(h+f)*i;break;case 270:R=Z._rescaleAndSwap,p=t+s,g=n+i,w=-s,x=-i,y=t+(1-h-f)*s,b=n+(1-c-d)*i,_=t+(1-h)*s,C=n+(1-c)*i;break}for(const{line:I,points:O}of u(this,mn))o.push(R(I,p,g,w,x,a?new Array(I.length):null)),l.push(R(O,p,g,w,x,a?new Array(O.length):null));return{lines:o,points:l,rect:[y,b,_,C]}}static deserialize(t,n,s,i,a,{paths:{lines:o,points:l},rotation:c,thickness:h}){const d=[];let f,p,g,w,x;switch(c){case 0:x=Z._rescale,f=-t/s,p=n/i+1,g=1/s,w=-1/i;break;case 90:x=Z._rescaleAndSwap,f=-n/i,p=-t/s,g=1/i,w=1/s;break;case 180:x=Z._rescale,f=t/s+1,p=-n/i,g=-1/s,w=1/i;break;case 270:x=Z._rescaleAndSwap,f=n/i+1,p=t/s+1,g=-1/i,w=-1/s;break}if(!o){o=[];for(const b of l){const _=b.length;if(_===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(_===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const C=new Float32Array(3*(_-2));o.push(C);let[R,I,O,D]=b.subarray(0,4);C.set([NaN,NaN,NaN,NaN,R,I],0);for(let B=4;B<_;B+=2){const q=b[B],K=b[B+1];C.set(Z.createBezierPoints(R,I,O,D,q,K),(B-2)*3),[R,I,O,D]=[O,D,q,K]}}}for(let b=0,_=o.length;b<_;b++)d.push({line:x(o[b].map(C=>C??NaN),f,p,g,w),points:x(l[b].map(C=>C??NaN),f,p,g,w)});const y=new u3;return y.build(d,s,i,1,c,h,a),y}get box(){return u(this,Cr)}updateProperty(t,n){return t==="stroke-width"?k(this,ir,x_).call(this,n):null}updateParentDimensions([t,n],s){const[i,a]=k(this,ir,di).call(this);S(this,Ws,t),S(this,Ks,n),S(this,Kc,s);const[o,l]=k(this,ir,di).call(this),c=o-i,h=l-a,d=u(this,Cr);return d[0]-=c,d[1]-=h,d[2]+=2*c,d[3]+=2*h,d}updateRotation(t){return S(this,hf,t),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,Cr).map(Z.svgRound).join(" ")}get defaultProperties(){const[t,n]=u(this,Cr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=u(this,Cr);let s=0,i=0,a=0,o=0,l=0,c=0;switch(u(this,hf)){case 90:i=n/t,a=-t/n,l=t;break;case 180:s=-1,o=-1,l=t,c=n;break;case 270:i=-n/t,a=t/n,c=n;break;default:return""}return`matrix(${s} ${i} ${a} ${o} ${Z.svgRound(l)} ${Z.svgRound(c)})`}getPathResizingSVGProperties([t,n,s,i]){const[a,o]=k(this,ir,di).call(this),[l,c,h,d]=u(this,Cr);if(Math.abs(h-a)<=Z.PRECISION||Math.abs(d-o)<=Z.PRECISION){const x=t+s/2-(l+h/2),y=n+i/2-(c+d/2);return{path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(n)}`,transform:`${this.rotationTransform} translate(${x} ${y})`}}}const f=(s-2*a)/(h-2*a),p=(i-2*o)/(d-2*o),g=h/s,w=d/i;return{path:{"transform-origin":`${Z.svgRound(l)} ${Z.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${w}) translate(${Z.svgRound(a)} ${Z.svgRound(o)}) scale(${f} ${p}) translate(${Z.svgRound(-a)} ${Z.svgRound(-o)})`}}}getPathResizedSVGProperties([t,n,s,i]){const[a,o]=k(this,ir,di).call(this),l=u(this,Cr),[c,h,d,f]=l;if(l[0]=t,l[1]=n,l[2]=s,l[3]=i,Math.abs(d-a)<=Z.PRECISION||Math.abs(f-o)<=Z.PRECISION){const y=t+s/2-(c+d/2),b=n+i/2-(h+f/2);for(const{line:_,points:C}of u(this,mn))Z._translate(_,y,b,_),Z._translate(C,y,b,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(s-2*a)/(d-2*a),g=(i-2*o)/(f-2*o),w=-p*(c+a)+t+a,x=-g*(h+o)+n+o;if(p!==1||g!==1||w!==0||x!==0)for(const{line:y,points:b}of u(this,mn))Z._rescale(y,w,x,p,g,y),Z._rescale(b,w,x,p,g,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],s){const[i,a]=s,o=u(this,Cr),l=t-o[0],c=n-o[1];if(u(this,Ws)===i&&u(this,Ks)===a)for(const{line:h,points:d}of u(this,mn))Z._translate(h,l,c,h),Z._translate(d,l,c,d);else{const h=u(this,Ws)/i,d=u(this,Ks)/a;S(this,Ws,i),S(this,Ks,a);for(const{line:f,points:p}of u(this,mn))Z._rescale(f,l,c,h,d,f),Z._rescale(p,l,c,h,d,p);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(n)}`}}}get defaultSVGProperties(){const t=u(this,Cr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t[0])} ${Z.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Cr=new WeakMap,hf=new WeakMap,df=new WeakMap,mn=new WeakMap,Ws=new WeakMap,Ks=new WeakMap,Kc=new WeakMap,Xc=new WeakMap,Yc=new WeakMap,ir=new WeakSet,di=function(t=u(this,Yc)){const n=u(this,df)+t/2*u(this,Kc);return u(this,Xc)%180===0?[n/u(this,Ws),n/u(this,Ks)]:[n/u(this,Ks),n/u(this,Ws)]},S_=function(){const[t,n,s,i]=u(this,Cr),[a,o]=k(this,ir,di).call(this,0);return[t+a,n+o,s-2*a,i-2*o]},__=function(){const t=S(this,Cr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of u(this,mn)){if(i.length<=12){for(let l=4,c=i.length;l<c;l+=6){const[h,d]=i.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=i[4],o=i[5];for(let l=6,c=i.length;l<c;l+=6){const[h,d,f,p,g,w]=i.subarray(l,l+6);ue.bezierBoundingBox(a,o,h,d,f,p,g,w,t),a=g,o=w}}const[n,s]=k(this,ir,di).call(this);t[0]=Math.min(1,Math.max(0,t[0]-n)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+n)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},x_=function(t){const[n,s]=k(this,ir,di).call(this);S(this,Yc,t);const[i,a]=k(this,ir,di).call(this),[o,l]=[i-n,a-s],c=u(this,Cr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};let jm=u3;var Qc;const c3=class c3 extends QR{constructor(t){super();E(this,Qc);S(this,Qc,t),super.updateProperties({fill:"none",stroke:gt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,n){t==="stroke-width"&&(n??(n=this["stroke-width"]),n*=u(this,Qc).realScale),super.updateSVGProperty(t,n)}clone(){const t=new c3(u(this,Qc));return t.updateAll(this),t}};Qc=new WeakMap;let iy=c3;var u1,A_;const ju=class ju extends ty{constructor(t){super({...t,name:"inkEditor"});E(this,u1);this._willKeepAspectRatio=!0}static initialize(t,n){gt.initialize(t,n),this._defaultDrawingOptions=new iy(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ce(this,"typesMap",new Map([[Me.INK_THICKNESS,"stroke-width"],[Me.INK_COLOR,"stroke"],[Me.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,s,i,a){return new JR(t,n,s,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,s,i,a,o){return jm.deserialize(t,n,s,i,a,o)}static async deserialize(t,n,s){let i=null;if(t instanceof z2){const{data:{inkLists:o,rect:l,rotation:c,id:h,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:g},parent:{page:{pageNumber:w}}}=t;i=t={annotationType:xe.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:o},boxes:null,pageIndex:w-1,rect:l.slice(0),rotation:c,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,n,s);return a.annotationElementId=t.id||null,a._initialData=i,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:s}){this._drawingOptions=ju.getDefaultDrawingOptions({stroke:ue.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:xe.INK,color:gt._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:n,points:s},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?c:this.annotationElementId&&!k(this,u1,A_).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:n,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n}),null}};u1=new WeakSet,A_=function(t){const{color:n,thickness:s,opacity:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==n[l])||t.thickness!==s||t.opacity!==i||t.pageIndex!==a},he(ju,"_type","ink"),he(ju,"_editorType",xe.INK),he(ju,"_defaultDrawingOptions",null);let ay=ju;var ht,nr,Ga,ji,Wa,Jc,Xs,Ys,gn,Zc,ze,Qh,Jh,Jp,ly,Zp,uy,em,E_;const p0=class p0 extends gt{constructor(t){super({...t,name:"stampEditor"});E(this,ze);E(this,ht,null);E(this,nr,null);E(this,Ga,null);E(this,ji,null);E(this,Wa,null);E(this,Jc,"");E(this,Xs,null);E(this,Ys,null);E(this,gn,!1);E(this,Zc,!1);S(this,ji,t.bitmapUrl),S(this,Wa,t.bitmapFile)}static initialize(t,n){gt.initialize(t,n)}static get supportedTypes(){return Ce(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Ce(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,n){n.pasteEditor(xe.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),n&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;u(this,nr)&&(S(this,ht,null),this._uiManager.imageManager.deleteId(u(this,nr)),(t=u(this,Xs))==null||t.remove(),S(this,Xs,null),u(this,Ys)&&(clearTimeout(u(this,Ys)),S(this,Ys,null))),super.remove()}rebuild(){if(!this.parent){u(this,nr)&&k(this,ze,Jp).call(this);return}super.rebuild(),this.div!==null&&(u(this,nr)&&u(this,Xs)===null&&k(this,ze,Jp).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(u(this,Ga)||u(this,ht)||u(this,ji)||u(this,Wa)||u(this,nr))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;if(this.width&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),u(this,ht)?k(this,ze,ly).call(this):k(this,ze,Jp).call(this),this.width&&!this.annotationElementId){const[s,i]=this.parentDimensions;this.setAt(t*s,n*i,this.width*s,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;u(this,Ys)!==null&&clearTimeout(u(this,Ys)),S(this,Ys,setTimeout(()=>{S(this,Ys,null),k(this,ze,uy).call(this)},200))}copyCanvas(t,n,s=!1){var p;t||(t=224);const{width:i,height:a}=u(this,ht),o=new i4;let l=u(this,ht),c=i,h=a,d=null;if(n){if(i>n||a>n){const D=Math.min(n/i,n/a);c=Math.floor(i*D),h=Math.floor(a*D)}d=document.createElement("canvas");const g=d.width=Math.ceil(c*o.sx),w=d.height=Math.ceil(h*o.sy);u(this,gn)||(l=k(this,ze,Zp).call(this,g,w));const x=d.getContext("2d");x.filter=this._uiManager.hcmFilter;let y="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",b="#42414d");const _=15,C=_*o.sx,R=_*o.sy,I=new OffscreenCanvas(C*2,R*2),O=I.getContext("2d");O.fillStyle=y,O.fillRect(0,0,C*2,R*2),O.fillStyle=b,O.fillRect(0,0,C,R),O.fillRect(C,R,C,R),x.fillStyle=x.createPattern(I,"repeat"),x.fillRect(0,0,g,w),x.drawImage(l,0,0,l.width,l.height,0,0,g,w)}let f=null;if(s){let g,w;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,w=l.height;else if(l=u(this,ht),i>t||a>t){const b=Math.min(t/i,t/a);g=Math.floor(i*b),w=Math.floor(a*b),u(this,gn)||(l=k(this,ze,Zp).call(this,g,w))}const y=new OffscreenCanvas(g,w).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,g,w),f={width:g,height:w,data:y.getImageData(0,0,g,w).data}}return{canvas:d,width:c,height:h,imageData:f}}getImageForAltText(){return u(this,Xs)}static async deserialize(t,n,s){var w;let i=null;if(t instanceof GS){const{data:{rect:x,rotation:y,id:b,structParent:_,popupRef:C},container:R,parent:{page:{pageNumber:I}}}=t,O=R.querySelector("canvas"),D=s.imageManager.getFromCanvas(R.id,O);O.remove();const B=((w=await n._structTree.getAriaAttributes(`${P2}${b}`))==null?void 0:w.get("aria-label"))||"";i=t={annotationType:xe.STAMP,bitmapId:D.id,bitmap:D.bitmap,pageIndex:I-1,rect:x.slice(0),rotation:y,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:_,popupRef:C}}const a=await super.deserialize(t,n,s),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&s.imageManager.isValidId(h)?(S(a,nr,h),l&&S(a,ht,l)):S(a,ji,c),S(a,gn,d);const[p,g]=a.pageDimensions;return a.width=(o[2]-o[0])/p,a.height=(o[3]-o[1])/g,a.annotationElementId=t.id||null,f&&(a.altTextData=f),a._initialData=i,S(a,Zc,!!i),a}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:xe.STAMP,bitmapId:u(this,nr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:u(this,gn),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=k(this,ze,em).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=k(this,ze,E_).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,n===null)return s;n.stamps||(n.stamps=new Map);const o=u(this,gn)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!n.stamps.has(u(this,nr)))n.stamps.set(u(this,nr),{area:o,serialized:s}),s.bitmap=k(this,ze,em).call(this,!1);else if(u(this,gn)){const l=n.stamps.get(u(this,nr));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=k(this,ze,em).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};ht=new WeakMap,nr=new WeakMap,Ga=new WeakMap,ji=new WeakMap,Wa=new WeakMap,Jc=new WeakMap,Xs=new WeakMap,Ys=new WeakMap,gn=new WeakMap,Zc=new WeakMap,ze=new WeakSet,Qh=function(t,n=!1){if(!t){this.remove();return}S(this,ht,t.bitmap),n||(S(this,nr,t.id),S(this,gn,t.isSvg)),t.file&&S(this,Jc,t.file.name),k(this,ze,ly).call(this)},Jh=function(){if(S(this,Ga,null),this._uiManager.enableWaiting(!1),!!u(this,Xs)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,ht)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,ht)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Jp=function(){if(u(this,nr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,nr)).then(s=>k(this,ze,Qh).call(this,s,!0)).finally(()=>k(this,ze,Jh).call(this));return}if(u(this,ji)){const s=u(this,ji);S(this,ji,null),this._uiManager.enableWaiting(!0),S(this,Ga,this._uiManager.imageManager.getFromUrl(s).then(i=>k(this,ze,Qh).call(this,i)).finally(()=>k(this,ze,Jh).call(this)));return}if(u(this,Wa)){const s=u(this,Wa);S(this,Wa,null),this._uiManager.enableWaiting(!0),S(this,Ga,this._uiManager.imageManager.getFromFile(s).then(i=>k(this,ze,Qh).call(this,i)).finally(()=>k(this,ze,Jh).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=p0.supportedTypesStr;const n=this._uiManager._signal;S(this,Ga,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),k(this,ze,Qh).call(this,i)}s()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:n})}).finally(()=>k(this,ze,Jh).call(this))),t.click()},ly=function(){var d;const{div:t}=this;let{width:n,height:s}=u(this,ht);const[i,a]=this.pageDimensions,o=.75;if(this.width)n=this.width*i,s=this.height*a;else if(n>o*i||s>o*a){const f=Math.min(o*i/n,o*a/s);n*=f,s*=f}const[l,c]=this.parentDimensions;this.setDims(n*l/i,s*c/a),this._uiManager.enableWaiting(!1);const h=S(this,Xs,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/i,this.height=s/a,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),k(this,ze,uy).call(this),u(this,Zc)||(this.parent.addUndoableEditor(this),S(this,Zc,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,Jc)&&h.setAttribute("aria-label",u(this,Jc))},Zp=function(t,n){const{width:s,height:i}=u(this,ht);let a=s,o=i,l=u(this,ht);for(;a>2*t||o>2*n;){const c=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*n&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=d.transferToImageBitmap()}return l},uy=function(){const[t,n]=this.parentDimensions,{width:s,height:i}=this,a=new i4,o=Math.ceil(s*t*a.sx),l=Math.ceil(i*n*a.sy),c=u(this,Xs);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const h=u(this,gn)?u(this,ht):k(this,ze,Zp).call(this,o,l),d=c.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,l)},em=function(t){if(t){if(u(this,gn)){const i=this._uiManager.imageManager.getSvgUrl(u(this,nr));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=u(this,ht),n.getContext("2d").drawImage(u(this,ht),0,0),n.toDataURL()}if(u(this,gn)){const[n,s]=this.pageDimensions,i=Math.round(this.width*n*po.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*po.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(u(this,ht),0,0,u(this,ht).width,u(this,ht).height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(u(this,ht))},E_=function(t){var o;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,i=t.pageIndex===n,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}},he(p0,"_type","stamp"),he(p0,"_editorType",xe.STAMP);let oy=p0;var Vl,eh,Qs,Ka,$i,Bn,Xa,th,Gl,vs,Ui,yr,Hi,oe,Ya,ot,k_,Os,hy,dy,tm;const ns=class ns{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:i,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){E(this,ot);E(this,Vl);E(this,eh,!1);E(this,Qs,null);E(this,Ka,null);E(this,$i,null);E(this,Bn,new Map);E(this,Xa,!1);E(this,th,!1);E(this,Gl,!1);E(this,vs,null);E(this,Ui,null);E(this,yr,null);E(this,Hi,null);E(this,oe);const d=[...u(ns,Ya).values()];if(!ns._initialized){ns._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),S(this,oe,e),this.pageIndex=t,this.div=n,S(this,Vl,i),S(this,Qs,a),this.viewport=c,S(this,yr,l),this.drawLayer=o,this._structTree=s,u(this,oe).addLayer(this)}get isEmpty(){return u(this,Bn).size===0}get isInvisible(){return this.isEmpty&&u(this,oe).getMode()===xe.NONE}updateToolbar(e){u(this,oe).updateToolbar(e)}updateMode(e=u(this,oe).getMode()){switch(k(this,ot,tm).call(this),e){case xe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case xe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case xe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of u(ns,Ya).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=u(this,yr))==null?void 0:t.div)}setEditingState(e){u(this,oe).setEditingState(e)}addCommands(e){u(this,oe).addCommands(e)}cleanUndoStack(e){u(this,oe).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=u(this,Qs))==null||t.div.classList.toggle("disabled",!e)}async enable(){S(this,Gl,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of u(this,Bn).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(u(this,oe).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!u(this,Qs)){S(this,Gl,!1);return}const t=u(this,Qs).getEditableAnnotations();for(const n of t){if(n.hide(),u(this,oe).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}S(this,Gl,!1)}disable(){var s;S(this,th,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of u(this,Bn).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(s=this.getEditableAnnotation(i.annotationElementId))==null||s.show(),i.remove()}if(u(this,Qs)){const i=u(this,Qs).getEditableAnnotations();for(const a of i){const{id:o}=a.data;if(u(this,oe).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(u(this,oe).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}k(this,ot,tm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of u(ns,Ya).values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),S(this,th,!1)}getEditableAnnotation(e){var t;return((t=u(this,Qs))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){u(this,oe).getActive()!==e&&u(this,oe).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=u(this,yr))!=null&&e.div&&!u(this,Hi)){S(this,Hi,new AbortController);const t=u(this,oe).combinedSignal(u(this,Hi));u(this,yr).div.addEventListener("pointerdown",k(this,ot,k_).bind(this),{signal:t}),u(this,yr).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=u(this,yr))!=null&&e.div&&u(this,Hi)&&(u(this,Hi).abort(),S(this,Hi,null),u(this,yr).div.classList.remove("highlighting"))}enableClick(){if(u(this,Ka))return;S(this,Ka,new AbortController);const e=u(this,oe).combinedSignal(u(this,Ka));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=u(this,Ka))==null||e.abort(),S(this,Ka,null)}attach(e){u(this,Bn).set(e.id,e);const{annotationElementId:t}=e;t&&u(this,oe).isDeletedAnnotationElement(t)&&u(this,oe).removeDeletedAnnotationElement(e)}detach(e){var t;u(this,Bn).delete(e.id),(t=u(this,Vl))==null||t.removePointerInTextLayer(e.contentDiv),!u(this,th)&&e.annotationElementId&&u(this,oe).addDeletedAnnotationElement(e)}remove(e){this.detach(e),u(this,oe).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(u(this,oe).addDeletedAnnotationElement(e.annotationElementId),gt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),u(this,oe).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!u(this,Gl)),u(this,oe).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!u(this,$i)&&(e._focusEventsAllowed=!1,S(this,$i,setTimeout(()=>{S(this,$i,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:u(this,oe)._signal}),t.focus())},0))),e._structTreeParentId=(n=u(this,Vl))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return u(this,oe).getId()}combinedSignal(e){return u(this,oe).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=u(this,ot,Os))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){u(this,oe).updateToolbar(e),u(this,oe).updateMode(e);const{offsetX:n,offsetY:s}=k(this,ot,dy).call(this),i=this.getNextId(),a=k(this,ot,hy).call(this,{parent:this,id:i,x:n,y:s,uiManager:u(this,oe),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=u(ns,Ya).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,u(this,oe)))||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),i=k(this,ot,hy).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:u(this,oe),isCentered:t,...n});return i&&this.add(i),i}addNewEditor(){this.createAndAddNewEditor(k(this,ot,dy).call(this),!0)}setSelected(e){u(this,oe).setSelected(e)}toggleSelected(e){u(this,oe).toggleSelected(e)}unselect(e){u(this,oe).unselect(e)}pointerup(e){var n;const{isMac:t}=Nr.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&u(this,Xa)&&(S(this,Xa,!1),!((n=u(this,ot,Os))!=null&&n.isDrawer&&u(this,ot,Os).supportMultipleDrawings))){if(!u(this,eh)){S(this,eh,!0);return}if(u(this,oe).getMode()===xe.STAMP){u(this,oe).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(u(this,oe).getMode()===xe.HIGHLIGHT&&this.enableTextSelection(),u(this,Xa)){S(this,Xa,!1);return}const{isMac:t}=Nr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(S(this,Xa,!0),(s=u(this,ot,Os))!=null&&s.isDrawer){this.startDrawingSession(e);return}const n=u(this,oe).getActive();S(this,eh,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus(),u(this,vs)){u(this,ot,Os).startDrawing(this,u(this,oe),!1,e);return}u(this,oe).setCurrentDrawingSession(this),S(this,vs,new AbortController);const t=u(this,oe).combinedSignal(u(this,vs));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(S(this,Ui,null),this.commitOrRemove())},{signal:t}),u(this,ot,Os).startDrawing(this,u(this,oe),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&S(this,Ui,t);return}u(this,Ui)&&setTimeout(()=>{var t;(t=u(this,Ui))==null||t.focus(),S(this,Ui,null)},0)}endDrawingSession(e=!1){return u(this,vs)?(u(this,oe).setCurrentDrawingSession(null),u(this,vs).abort(),S(this,vs,null),S(this,Ui,null),u(this,ot,Os).endDrawing(e)):null}findNewParent(e,t,n){const s=u(this,oe).findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return u(this,vs)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,vs)&&u(this,ot,Os).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=u(this,oe).getActive())==null?void 0:e.parent)===this&&(u(this,oe).commitOrRemove(),u(this,oe).setActiveEditor(null)),u(this,$i)&&(clearTimeout(u(this,$i)),S(this,$i,null));for(const n of u(this,Bn).values())(t=u(this,Vl))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,u(this,Bn).clear(),u(this,oe).removeLayer(this)}render({viewport:e}){this.viewport=e,ru(this.div,e);for(const t of u(this,oe).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){u(this,oe).commitOrRemove(),k(this,ot,tm).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,ru(this.div,{rotation:n}),t!==n)for(const s of u(this,Bn).values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return u(this,oe).viewParameters.realScale}};Vl=new WeakMap,eh=new WeakMap,Qs=new WeakMap,Ka=new WeakMap,$i=new WeakMap,Bn=new WeakMap,Xa=new WeakMap,th=new WeakMap,Gl=new WeakMap,vs=new WeakMap,Ui=new WeakMap,yr=new WeakMap,Hi=new WeakMap,oe=new WeakMap,Ya=new WeakMap,ot=new WeakSet,k_=function(e){u(this,oe).unselectAll();const{target:t}=e;if(t===u(this,yr).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&u(this,yr).div.contains(t)){const{isMac:n}=Nr.platform;if(e.button!==0||e.ctrlKey&&n)return;u(this,oe).showAllEditors("highlight",!0,!0),u(this,yr).div.classList.add("free"),this.toggleDrawing(),Bm.startHighlighting(this,u(this,oe).direction==="ltr",{target:u(this,yr).div,x:e.x,y:e.y}),u(this,yr).div.addEventListener("pointerup",()=>{u(this,yr).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,oe)._signal}),e.preventDefault()}},Os=function(){return u(ns,Ya).get(u(this,oe).getMode())},hy=function(e){const t=u(this,ot,Os);return t?new t.prototype.constructor(e):null},dy=function(){const{x:e,y:t,width:n,height:s}=this.div.getBoundingClientRect(),i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+n),l=Math.min(window.innerHeight,t+s),c=(i+o)/2-e,h=(a+l)/2-t,[d,f]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:d,offsetY:f}},tm=function(){for(const e of u(this,Bn).values())e.isEmpty()&&e.remove()},he(ns,"_initialized",!1),E(ns,Ya,new Map([V4,ay,oy,Bm].map(e=>[e._editorType,e])));let cy=ns;var ys,ff,Rr,Wl,c1,T_,si,py,C_,my;const pr=class pr{constructor({pageIndex:e}){E(this,si);E(this,ys,null);E(this,ff,0);E(this,Rr,new Map);E(this,Wl,new Map);this.pageIndex=e}setParent(e){if(!u(this,ys)){S(this,ys,e);return}if(u(this,ys)!==e){if(u(this,Rr).size>0)for(const t of u(this,Rr).values())t.remove(),e.append(t);S(this,ys,e)}}static get _svgFactory(){return Ce(this,"_svgFactory",new F2)}draw(e,t=!1,n=!1){const s=xr(this,ff)._++,i=k(this,si,py).call(this),a=pr._svgFactory.createElement("defs");i.append(a);const o=pr._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&u(this,Wl).set(s,o);const c=n?k(this,si,C_).call(this,a,l):null,h=pr._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(i,e),u(this,Rr).set(s,i),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const n=xr(this,ff)._++,s=k(this,si,py).call(this),i=pr._svgFactory.createElement("defs");s.append(i);const a=pr._svgFactory.createElement("path");i.append(a);const o=`path_p${this.pageIndex}_${n}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=pr._svgFactory.createElement("mask");i.append(d),l=`mask_p${this.pageIndex}_${n}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const f=pr._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=pr._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const c=pr._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return s.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),u(this,Rr).set(n,s),n}finalizeDraw(e,t){u(this,Wl).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:n,bbox:s,rootClass:i,path:a}=t,o=typeof e=="number"?u(this,Rr).get(e):e;if(o){if(n&&k(this,si,my).call(this,o,n),s&&k(l=pr,c1,T_).call(l,o,s),i){const{classList:c}=o;for(const[h,d]of Object.entries(i))c.toggle(h,d)}if(a){const h=o.firstChild.firstChild;k(this,si,my).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const n=u(this,Rr).get(e);n&&(u(t,ys).append(n),u(this,Rr).delete(e),u(t,Rr).set(e,n))}remove(e){u(this,Wl).delete(e),u(this,ys)!==null&&(u(this,Rr).get(e).remove(),u(this,Rr).delete(e))}destroy(){S(this,ys,null);for(const e of u(this,Rr).values())e.remove();u(this,Rr).clear(),u(this,Wl).clear()}};ys=new WeakMap,ff=new WeakMap,Rr=new WeakMap,Wl=new WeakMap,c1=new WeakSet,T_=function(e,[t,n,s,i]){const{style:a}=e;a.top=`${100*n}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*i}%`},si=new WeakSet,py=function(){const e=pr._svgFactory.create(1,1,!0);return u(this,ys).append(e),e.setAttribute("aria-hidden",!0),e},C_=function(e,t){const n=pr._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const i=pr._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),s},my=function(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)},E(pr,c1);let fy=pr;globalThis.pdfjsTestingUtils={HighlightOutliner:W4};be.AbortException;be.AnnotationEditorLayer;be.AnnotationEditorParamsType;be.AnnotationEditorType;be.AnnotationEditorUIManager;be.AnnotationLayer;be.AnnotationMode;be.ColorPicker;be.DOMSVGFactory;be.DrawLayer;be.FeatureTest;var ZR=be.GlobalWorkerOptions;be.ImageKind;be.InvalidPDFException;be.MissingPDFException;be.OPS;be.OutputScale;be.PDFDataRangeTransport;be.PDFDateString;be.PDFWorker;be.PasswordResponses;be.PermissionFlag;be.PixelsPerInch;be.RenderingCancelledException;be.TextLayer;be.TouchManager;be.UnexpectedResponseException;be.Util;be.VerbosityLevel;be.XfaLayer;be.build;be.createValidAbsoluteUrl;be.fetchData;var eP=be.getDocument;be.getFilenameFromUrl;be.getPdfFilenameFromUrl;be.getXfaPageViewport;be.isDataScheme;be.isPdfFile;be.noContextMenu;be.normalizeUnicode;be.setLayerDimensions;be.shadow;be.stopEvent;be.version;const tP="/assets/pdf.worker.min-yatZIOMy.mjs";ZR.workerSrc=tP;async function rP(r){const e=await r.arrayBuffer(),t=await eP({data:e}).promise,n=[];for(let s=1;s<=t.numPages;s++){const i=await t.getPage(s),a=i.getViewport({scale:2}),o=document.createElement("canvas"),l=o.getContext("2d");if(!l)throw new Error("Could not get canvas context");o.height=a.height,o.width=a.width,await i.render({canvasContext:l,viewport:a}).promise;const c=o.toDataURL("image/png");n.push(c.split(",")[1])}return n}class Xr{constructor(e,t,n){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=n}static range(e,t){return t?!e||!e.loc||!t.loc||e.loc.lexer!==t.loc.lexer?null:new Xr(e.loc.lexer,e.loc.start,t.loc.end):e&&e.loc}}class kn{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new kn(t,Xr.range(this,e))}}class U{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var n="KaTeX parse error: "+e,s,i,a=t&&t.loc;if(a&&a.start<=a.end){var o=a.lexer.input;s=a.start,i=a.end,s===o.length?n+=" at end of input: ":n+=" at position "+(s+1)+": ";var l=o.slice(s,i).replace(/[^]/g,"$&"),c;s>15?c=""+o.slice(s-15,s):c=o.slice(0,s);var h;i+15<o.length?h=o.slice(i,i+15)+"":h=o.slice(i),n+=c+l+h}var d=new Error(n);return d.name="ParseError",d.__proto__=U.prototype,d.position=s,s!=null&&i!=null&&(d.length=i-s),d.rawMessage=e,d}}U.prototype.__proto__=Error.prototype;var nP=function(e,t){return e===void 0?t:e},sP=/([A-Z])/g,iP=function(e){return e.replace(sP,"-$1").toLowerCase()},aP={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},oP=/[&><"']/g;function lP(r){return String(r).replace(oP,e=>aP[e])}var R_=function r(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?r(e.body[0]):e:e.type==="font"?r(e.body):e},uP=function(e){var t=R_(e);return t.type==="mathord"||t.type==="textord"||t.type==="atom"},cP=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},hP=function(e){var t=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?t[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(t[1])?null:t[1].toLowerCase():"_relative"},Fe={deflt:nP,escape:lP,hyphenate:iP,getBaseElem:R_,isCharacterBox:uP,protocolFromUrl:hP},rm={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:r=>"#"+r},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(r,e)=>(e.push(r),e)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:r=>Math.max(0,r),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:r=>Math.max(0,r),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:r=>Math.max(0,r),cli:"-e, --max-expand <n>",cliProcessor:r=>r==="Infinity"?1/0:parseInt(r)},globalGroup:{type:"boolean",cli:!1}};function dP(r){if(r.default)return r.default;var e=r.type,t=Array.isArray(e)?e[0]:e;if(typeof t!="string")return t.enum[0];switch(t){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class B2{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(var t in rm)if(rm.hasOwnProperty(t)){var n=rm[t];this[t]=e[t]!==void 0?n.processor?n.processor(e[t]):e[t]:dP(n)}}reportNonstrict(e,t,n){var s=this.strict;if(typeof s=="function"&&(s=s(e,t,n)),!(!s||s==="ignore")){if(s===!0||s==="error")throw new U("LaTeX-incompatible input and strict mode is set to 'error': "+(t+" ["+e+"]"),n);s==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+t+" ["+e+"]"))}}useStrictBehavior(e,t,n){var s=this.strict;if(typeof s=="function")try{s=s(e,t,n)}catch{s="error"}return!s||s==="ignore"?!1:s===!0||s==="error"?!0:s==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+t+" ["+e+"]")),!1)}isTrusted(e){if(e.url&&!e.protocol){var t=Fe.protocolFromUrl(e.url);if(t==null)return!1;e.protocol=t}var n=typeof this.trust=="function"?this.trust(e):this.trust;return!!n}}class ha{constructor(e,t,n){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=n}sup(){return Js[fP[this.id]]}sub(){return Js[pP[this.id]]}fracNum(){return Js[mP[this.id]]}fracDen(){return Js[gP[this.id]]}cramp(){return Js[vP[this.id]]}text(){return Js[yP[this.id]]}isTight(){return this.size>=2}}var j2=0,$m=1,Yu=2,Ki=3,j0=4,Gn=5,ch=6,Ir=7,Js=[new ha(j2,0,!1),new ha($m,0,!0),new ha(Yu,1,!1),new ha(Ki,1,!0),new ha(j0,2,!1),new ha(Gn,2,!0),new ha(ch,3,!1),new ha(Ir,3,!0)],fP=[j0,Gn,j0,Gn,ch,Ir,ch,Ir],pP=[Gn,Gn,Gn,Gn,Ir,Ir,Ir,Ir],mP=[Yu,Ki,j0,Gn,ch,Ir,ch,Ir],gP=[Ki,Ki,Gn,Gn,Ir,Ir,Ir,Ir],vP=[$m,$m,Ki,Ki,Gn,Gn,Ir,Ir],yP=[j2,$m,Yu,Ki,Yu,Ki,Yu,Ki],pe={DISPLAY:Js[j2],TEXT:Js[Yu],SCRIPT:Js[j0],SCRIPTSCRIPT:Js[ch]},gy=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function wP(r){for(var e=0;e<gy.length;e++)for(var t=gy[e],n=0;n<t.blocks.length;n++){var s=t.blocks[n];if(r>=s[0]&&r<=s[1])return t.name}return null}var nm=[];gy.forEach(r=>r.blocks.forEach(e=>nm.push(...e)));function P_(r){for(var e=0;e<nm.length;e+=2)if(r>=nm[e]&&r<=nm[e+1])return!0;return!1}var vu=80,bP=function(e,t){return"M95,"+(622+e+t)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+e/2.075+" -"+e+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+e)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},SP=function(e,t){return"M263,"+(601+e+t)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+e/2.084+" -"+e+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+e)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},_P=function(e,t){return"M983 "+(10+e+t)+`
l`+e/3.13+" -"+e+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+e)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},xP=function(e,t){return"M424,"+(2398+e+t)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+e/4.223+" -"+e+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+e)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+e)+" "+t+`
h400000v`+(40+e)+"h-400000z"},AP=function(e,t){return"M473,"+(2713+e+t)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+e/5.298+" -"+e+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+e)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"},EP=function(e){var t=e/2;return"M400000 "+e+" H0 L"+t+" 0 l65 45 L145 "+(e-80)+" H400000z"},kP=function(e,t,n){var s=n-54-t-e;return"M702 "+(e+t)+"H400000"+(40+e)+`
H742v`+s+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+t+"H400000v"+(40+e)+"H742z"},TP=function(e,t,n){t=1e3*t;var s="";switch(e){case"sqrtMain":s=bP(t,vu);break;case"sqrtSize1":s=SP(t,vu);break;case"sqrtSize2":s=_P(t,vu);break;case"sqrtSize3":s=xP(t,vu);break;case"sqrtSize4":s=AP(t,vu);break;case"sqrtTall":s=kP(t,vu,n)}return s},CP=function(e,t){switch(e){case"":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z"+("M367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z");case"":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257z"+("M478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z");default:return""}},Pw={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},RP=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+` v585 h43z
M367 15 v585 v`+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v602 h84z
M403 1759 V0 H319 V1759 v`+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v602 h84z
M347 1759 V0 h-84 V1759 v`+t+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(t+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(t+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(t+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(t+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class Af{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return this.classes.includes(e)}toNode(){for(var e=document.createDocumentFragment(),t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){var e=t=>t.toText();return this.children.map(e).join("")}}var ei={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},sp={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},Mw={:"A",:"D",:"o",:"a",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function PP(r,e){ei[r]=e}function $2(r,e,t){if(!ei[e])throw new Error("Font metrics not found for font: "+e+".");var n=r.charCodeAt(0),s=ei[e][n];if(!s&&r[0]in Mw&&(n=Mw[r[0]].charCodeAt(0),s=ei[e][n]),!s&&t==="text"&&P_(n)&&(s=ei[e][77]),s)return{depth:s[0],height:s[1],italic:s[2],skew:s[3],width:s[4]}}var Ng={};function MP(r){var e;if(r>=5?e=0:r>=3?e=1:e=2,!Ng[e]){var t=Ng[e]={cssEmPerMu:sp.quad[e]/18};for(var n in sp)sp.hasOwnProperty(n)&&(t[n]=sp[n][e])}return Ng[e]}var IP=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],Iw=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],Ow=function(e,t){return t.size<2?e:IP[e-1][t.size-1]};class yi{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||yi.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=Iw[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return new yi(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:Ow(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:Iw[e-1]})}havingBaseStyle(e){e=e||this.style.text();var t=Ow(yi.BASESIZE,e);return this.size===t&&this.textSize===yi.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==yi.BASESIZE?["sizing","reset-size"+this.size,"size"+yi.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=MP(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}yi.BASESIZE=6;var vy={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},OP={ex:!0,em:!0,mu:!0},M_=function(e){return typeof e!="string"&&(e=e.unit),e in vy||e in OP||e==="ex"},mt=function(e,t){var n;if(e.unit in vy)n=vy[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if(e.unit==="mu")n=t.fontMetrics().cssEmPerMu;else{var s;if(t.style.isTight()?s=t.havingStyle(t.style.text()):s=t,e.unit==="ex")n=s.fontMetrics().xHeight;else if(e.unit==="em")n=s.fontMetrics().quad;else throw new U("Invalid unit: '"+e.unit+"'");s!==t&&(n*=s.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*n,t.maxSize)},G=function(e){return+e.toFixed(4)+"em"},mo=function(e){return e.filter(t=>t).join(" ")},I_=function(e,t,n){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=n||{},t){t.style.isTight()&&this.classes.push("mtight");var s=t.getColor();s&&(this.style.color=s)}},O_=function(e){var t=document.createElement(e);t.className=mo(this.classes);for(var n in this.style)this.style.hasOwnProperty(n)&&(t.style[n]=this.style[n]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&t.setAttribute(s,this.attributes[s]);for(var i=0;i<this.children.length;i++)t.appendChild(this.children[i].toNode());return t},NP=/[\s"'>/=\x00-\x1f]/,N_=function(e){var t="<"+e;this.classes.length&&(t+=' class="'+Fe.escape(mo(this.classes))+'"');var n="";for(var s in this.style)this.style.hasOwnProperty(s)&&(n+=Fe.hyphenate(s)+":"+this.style[s]+";");n&&(t+=' style="'+Fe.escape(n)+'"');for(var i in this.attributes)if(this.attributes.hasOwnProperty(i)){if(NP.test(i))throw new U("Invalid attribute name '"+i+"'");t+=" "+i+'="'+Fe.escape(this.attributes[i])+'"'}t+=">";for(var a=0;a<this.children.length;a++)t+=this.children[a].toMarkup();return t+="</"+e+">",t};class Ef{constructor(e,t,n,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,I_.call(this,e,n,s),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return O_.call(this,"span")}toMarkup(){return N_.call(this,"span")}}class U2{constructor(e,t,n,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,I_.call(this,t,s),this.children=n||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return O_.call(this,"a")}toMarkup(){return N_.call(this,"a")}}class LP{constructor(e,t,n){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=n}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(var t in this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){var e='<img src="'+Fe.escape(this.src)+'"'+(' alt="'+Fe.escape(this.alt)+'"'),t="";for(var n in this.style)this.style.hasOwnProperty(n)&&(t+=Fe.hyphenate(n)+":"+this.style[n]+";");return t&&(e+=' style="'+Fe.escape(t)+'"'),e+="'/>",e}}var DP={:"",:"",:"",:""};class Qn{constructor(e,t,n,s,i,a,o,l){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=n||0,this.italic=s||0,this.skew=i||0,this.width=a||0,this.classes=o||[],this.style=l||{},this.maxFontSize=0;var c=wP(this.text.charCodeAt(0));c&&this.classes.push(c+"_fallback"),/[]/.test(this.text)&&(this.text=DP[this.text])}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createTextNode(this.text),t=null;this.italic>0&&(t=document.createElement("span"),t.style.marginRight=G(this.italic)),this.classes.length>0&&(t=t||document.createElement("span"),t.className=mo(this.classes));for(var n in this.style)this.style.hasOwnProperty(n)&&(t=t||document.createElement("span"),t.style[n]=this.style[n]);return t?(t.appendChild(e),t):e}toMarkup(){var e=!1,t="<span";this.classes.length&&(e=!0,t+=' class="',t+=Fe.escape(mo(this.classes)),t+='"');var n="";this.italic>0&&(n+="margin-right:"+this.italic+"em;");for(var s in this.style)this.style.hasOwnProperty(s)&&(n+=Fe.hyphenate(s)+":"+this.style[s]+";");n&&(e=!0,t+=' style="'+Fe.escape(n)+'"');var i=Fe.escape(this.text);return e?(t+=">",t+=i,t+="</span>",t):i}}class ra{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&t.setAttribute(n,this.attributes[n]);for(var s=0;s<this.children.length;s++)t.appendChild(this.children[s].toNode());return t}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+Fe.escape(this.attributes[t])+'"');e+=">";for(var n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e+="</svg>",e}}class go{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"path");return this.alternate?t.setAttribute("d",this.alternate):t.setAttribute("d",Pw[this.pathName]),t}toMarkup(){return this.alternate?'<path d="'+Fe.escape(this.alternate)+'"/>':'<path d="'+Fe.escape(Pw[this.pathName])+'"/>'}}class yy{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"line");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&t.setAttribute(n,this.attributes[n]);return t}toMarkup(){var e="<line";for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+Fe.escape(this.attributes[t])+'"');return e+="/>",e}}function Nw(r){if(r instanceof Qn)return r;throw new Error("Expected symbolNode but got "+String(r)+".")}function FP(r){if(r instanceof Ef)return r;throw new Error("Expected span<HtmlDomNode> but got "+String(r)+".")}var zP={bin:1,close:1,inner:1,open:1,punct:1,rel:1},BP={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},et={math:{},text:{}};function m(r,e,t,n,s,i){et[r][s]={font:e,group:t,replace:n},i&&n&&(et[r][n]=et[r][s])}var v="math",j="text",A="main",P="ams",ut="accent-token",Q="bin",Br="close",vh="inner",fe="mathord",Nt="op-token",Mn="open",F1="punct",M="rel",la="spacing",N="textord";m(v,A,M,"","\\equiv",!0);m(v,A,M,"","\\prec",!0);m(v,A,M,"","\\succ",!0);m(v,A,M,"","\\sim",!0);m(v,A,M,"","\\perp");m(v,A,M,"","\\preceq",!0);m(v,A,M,"","\\succeq",!0);m(v,A,M,"","\\simeq",!0);m(v,A,M,"","\\mid",!0);m(v,A,M,"","\\ll",!0);m(v,A,M,"","\\gg",!0);m(v,A,M,"","\\asymp",!0);m(v,A,M,"","\\parallel");m(v,A,M,"","\\bowtie",!0);m(v,A,M,"","\\smile",!0);m(v,A,M,"","\\sqsubseteq",!0);m(v,A,M,"","\\sqsupseteq",!0);m(v,A,M,"","\\doteq",!0);m(v,A,M,"","\\frown",!0);m(v,A,M,"","\\ni",!0);m(v,A,M,"","\\propto",!0);m(v,A,M,"","\\vdash",!0);m(v,A,M,"","\\dashv",!0);m(v,A,M,"","\\owns");m(v,A,F1,".","\\ldotp");m(v,A,F1,"","\\cdotp");m(v,A,N,"#","\\#");m(j,A,N,"#","\\#");m(v,A,N,"&","\\&");m(j,A,N,"&","\\&");m(v,A,N,"","\\aleph",!0);m(v,A,N,"","\\forall",!0);m(v,A,N,"","\\hbar",!0);m(v,A,N,"","\\exists",!0);m(v,A,N,"","\\nabla",!0);m(v,A,N,"","\\flat",!0);m(v,A,N,"","\\ell",!0);m(v,A,N,"","\\natural",!0);m(v,A,N,"","\\clubsuit",!0);m(v,A,N,"","\\wp",!0);m(v,A,N,"","\\sharp",!0);m(v,A,N,"","\\diamondsuit",!0);m(v,A,N,"","\\Re",!0);m(v,A,N,"","\\heartsuit",!0);m(v,A,N,"","\\Im",!0);m(v,A,N,"","\\spadesuit",!0);m(v,A,N,"","\\S",!0);m(j,A,N,"","\\S");m(v,A,N,"","\\P",!0);m(j,A,N,"","\\P");m(v,A,N,"","\\dag");m(j,A,N,"","\\dag");m(j,A,N,"","\\textdagger");m(v,A,N,"","\\ddag");m(j,A,N,"","\\ddag");m(j,A,N,"","\\textdaggerdbl");m(v,A,Br,"","\\rmoustache",!0);m(v,A,Mn,"","\\lmoustache",!0);m(v,A,Br,"","\\rgroup",!0);m(v,A,Mn,"","\\lgroup",!0);m(v,A,Q,"","\\mp",!0);m(v,A,Q,"","\\ominus",!0);m(v,A,Q,"","\\uplus",!0);m(v,A,Q,"","\\sqcap",!0);m(v,A,Q,"","\\ast");m(v,A,Q,"","\\sqcup",!0);m(v,A,Q,"","\\bigcirc",!0);m(v,A,Q,"","\\bullet",!0);m(v,A,Q,"","\\ddagger");m(v,A,Q,"","\\wr",!0);m(v,A,Q,"","\\amalg");m(v,A,Q,"&","\\And");m(v,A,M,"","\\longleftarrow",!0);m(v,A,M,"","\\Leftarrow",!0);m(v,A,M,"","\\Longleftarrow",!0);m(v,A,M,"","\\longrightarrow",!0);m(v,A,M,"","\\Rightarrow",!0);m(v,A,M,"","\\Longrightarrow",!0);m(v,A,M,"","\\leftrightarrow",!0);m(v,A,M,"","\\longleftrightarrow",!0);m(v,A,M,"","\\Leftrightarrow",!0);m(v,A,M,"","\\Longleftrightarrow",!0);m(v,A,M,"","\\mapsto",!0);m(v,A,M,"","\\longmapsto",!0);m(v,A,M,"","\\nearrow",!0);m(v,A,M,"","\\hookleftarrow",!0);m(v,A,M,"","\\hookrightarrow",!0);m(v,A,M,"","\\searrow",!0);m(v,A,M,"","\\leftharpoonup",!0);m(v,A,M,"","\\rightharpoonup",!0);m(v,A,M,"","\\swarrow",!0);m(v,A,M,"","\\leftharpoondown",!0);m(v,A,M,"","\\rightharpoondown",!0);m(v,A,M,"","\\nwarrow",!0);m(v,A,M,"","\\rightleftharpoons",!0);m(v,P,M,"","\\nless",!0);m(v,P,M,"","\\@nleqslant");m(v,P,M,"","\\@nleqq");m(v,P,M,"","\\lneq",!0);m(v,P,M,"","\\lneqq",!0);m(v,P,M,"","\\@lvertneqq");m(v,P,M,"","\\lnsim",!0);m(v,P,M,"","\\lnapprox",!0);m(v,P,M,"","\\nprec",!0);m(v,P,M,"","\\npreceq",!0);m(v,P,M,"","\\precnsim",!0);m(v,P,M,"","\\precnapprox",!0);m(v,P,M,"","\\nsim",!0);m(v,P,M,"","\\@nshortmid");m(v,P,M,"","\\nmid",!0);m(v,P,M,"","\\nvdash",!0);m(v,P,M,"","\\nvDash",!0);m(v,P,M,"","\\ntriangleleft");m(v,P,M,"","\\ntrianglelefteq",!0);m(v,P,M,"","\\subsetneq",!0);m(v,P,M,"","\\@varsubsetneq");m(v,P,M,"","\\subsetneqq",!0);m(v,P,M,"","\\@varsubsetneqq");m(v,P,M,"","\\ngtr",!0);m(v,P,M,"","\\@ngeqslant");m(v,P,M,"","\\@ngeqq");m(v,P,M,"","\\gneq",!0);m(v,P,M,"","\\gneqq",!0);m(v,P,M,"","\\@gvertneqq");m(v,P,M,"","\\gnsim",!0);m(v,P,M,"","\\gnapprox",!0);m(v,P,M,"","\\nsucc",!0);m(v,P,M,"","\\nsucceq",!0);m(v,P,M,"","\\succnsim",!0);m(v,P,M,"","\\succnapprox",!0);m(v,P,M,"","\\ncong",!0);m(v,P,M,"","\\@nshortparallel");m(v,P,M,"","\\nparallel",!0);m(v,P,M,"","\\nVDash",!0);m(v,P,M,"","\\ntriangleright");m(v,P,M,"","\\ntrianglerighteq",!0);m(v,P,M,"","\\@nsupseteqq");m(v,P,M,"","\\supsetneq",!0);m(v,P,M,"","\\@varsupsetneq");m(v,P,M,"","\\supsetneqq",!0);m(v,P,M,"","\\@varsupsetneqq");m(v,P,M,"","\\nVdash",!0);m(v,P,M,"","\\precneqq",!0);m(v,P,M,"","\\succneqq",!0);m(v,P,M,"","\\@nsubseteqq");m(v,P,Q,"","\\unlhd");m(v,P,Q,"","\\unrhd");m(v,P,M,"","\\nleftarrow",!0);m(v,P,M,"","\\nrightarrow",!0);m(v,P,M,"","\\nLeftarrow",!0);m(v,P,M,"","\\nRightarrow",!0);m(v,P,M,"","\\nleftrightarrow",!0);m(v,P,M,"","\\nLeftrightarrow",!0);m(v,P,M,"","\\vartriangle");m(v,P,N,"","\\hslash");m(v,P,N,"","\\triangledown");m(v,P,N,"","\\lozenge");m(v,P,N,"","\\circledS");m(v,P,N,"","\\circledR");m(j,P,N,"","\\circledR");m(v,P,N,"","\\measuredangle",!0);m(v,P,N,"","\\nexists");m(v,P,N,"","\\mho");m(v,P,N,"","\\Finv",!0);m(v,P,N,"","\\Game",!0);m(v,P,N,"","\\backprime");m(v,P,N,"","\\blacktriangle");m(v,P,N,"","\\blacktriangledown");m(v,P,N,"","\\blacksquare");m(v,P,N,"","\\blacklozenge");m(v,P,N,"","\\bigstar");m(v,P,N,"","\\sphericalangle",!0);m(v,P,N,"","\\complement",!0);m(v,P,N,"","\\eth",!0);m(j,A,N,"","");m(v,P,N,"","\\diagup");m(v,P,N,"","\\diagdown");m(v,P,N,"","\\square");m(v,P,N,"","\\Box");m(v,P,N,"","\\Diamond");m(v,P,N,"","\\yen",!0);m(j,P,N,"","\\yen",!0);m(v,P,N,"","\\checkmark",!0);m(j,P,N,"","\\checkmark");m(v,P,N,"","\\beth",!0);m(v,P,N,"","\\daleth",!0);m(v,P,N,"","\\gimel",!0);m(v,P,N,"","\\digamma",!0);m(v,P,N,"","\\varkappa");m(v,P,Mn,"","\\@ulcorner",!0);m(v,P,Br,"","\\@urcorner",!0);m(v,P,Mn,"","\\@llcorner",!0);m(v,P,Br,"","\\@lrcorner",!0);m(v,P,M,"","\\leqq",!0);m(v,P,M,"","\\leqslant",!0);m(v,P,M,"","\\eqslantless",!0);m(v,P,M,"","\\lesssim",!0);m(v,P,M,"","\\lessapprox",!0);m(v,P,M,"","\\approxeq",!0);m(v,P,Q,"","\\lessdot");m(v,P,M,"","\\lll",!0);m(v,P,M,"","\\lessgtr",!0);m(v,P,M,"","\\lesseqgtr",!0);m(v,P,M,"","\\lesseqqgtr",!0);m(v,P,M,"","\\doteqdot");m(v,P,M,"","\\risingdotseq",!0);m(v,P,M,"","\\fallingdotseq",!0);m(v,P,M,"","\\backsim",!0);m(v,P,M,"","\\backsimeq",!0);m(v,P,M,"","\\subseteqq",!0);m(v,P,M,"","\\Subset",!0);m(v,P,M,"","\\sqsubset",!0);m(v,P,M,"","\\preccurlyeq",!0);m(v,P,M,"","\\curlyeqprec",!0);m(v,P,M,"","\\precsim",!0);m(v,P,M,"","\\precapprox",!0);m(v,P,M,"","\\vartriangleleft");m(v,P,M,"","\\trianglelefteq");m(v,P,M,"","\\vDash",!0);m(v,P,M,"","\\Vvdash",!0);m(v,P,M,"","\\smallsmile");m(v,P,M,"","\\smallfrown");m(v,P,M,"","\\bumpeq",!0);m(v,P,M,"","\\Bumpeq",!0);m(v,P,M,"","\\geqq",!0);m(v,P,M,"","\\geqslant",!0);m(v,P,M,"","\\eqslantgtr",!0);m(v,P,M,"","\\gtrsim",!0);m(v,P,M,"","\\gtrapprox",!0);m(v,P,Q,"","\\gtrdot");m(v,P,M,"","\\ggg",!0);m(v,P,M,"","\\gtrless",!0);m(v,P,M,"","\\gtreqless",!0);m(v,P,M,"","\\gtreqqless",!0);m(v,P,M,"","\\eqcirc",!0);m(v,P,M,"","\\circeq",!0);m(v,P,M,"","\\triangleq",!0);m(v,P,M,"","\\thicksim");m(v,P,M,"","\\thickapprox");m(v,P,M,"","\\supseteqq",!0);m(v,P,M,"","\\Supset",!0);m(v,P,M,"","\\sqsupset",!0);m(v,P,M,"","\\succcurlyeq",!0);m(v,P,M,"","\\curlyeqsucc",!0);m(v,P,M,"","\\succsim",!0);m(v,P,M,"","\\succapprox",!0);m(v,P,M,"","\\vartriangleright");m(v,P,M,"","\\trianglerighteq");m(v,P,M,"","\\Vdash",!0);m(v,P,M,"","\\shortmid");m(v,P,M,"","\\shortparallel");m(v,P,M,"","\\between",!0);m(v,P,M,"","\\pitchfork",!0);m(v,P,M,"","\\varpropto");m(v,P,M,"","\\blacktriangleleft");m(v,P,M,"","\\therefore",!0);m(v,P,M,"","\\backepsilon");m(v,P,M,"","\\blacktriangleright");m(v,P,M,"","\\because",!0);m(v,P,M,"","\\llless");m(v,P,M,"","\\gggtr");m(v,P,Q,"","\\lhd");m(v,P,Q,"","\\rhd");m(v,P,M,"","\\eqsim",!0);m(v,A,M,"","\\Join");m(v,P,M,"","\\Doteq",!0);m(v,P,Q,"","\\dotplus",!0);m(v,P,Q,"","\\smallsetminus");m(v,P,Q,"","\\Cap",!0);m(v,P,Q,"","\\Cup",!0);m(v,P,Q,"","\\doublebarwedge",!0);m(v,P,Q,"","\\boxminus",!0);m(v,P,Q,"","\\boxplus",!0);m(v,P,Q,"","\\divideontimes",!0);m(v,P,Q,"","\\ltimes",!0);m(v,P,Q,"","\\rtimes",!0);m(v,P,Q,"","\\leftthreetimes",!0);m(v,P,Q,"","\\rightthreetimes",!0);m(v,P,Q,"","\\curlywedge",!0);m(v,P,Q,"","\\curlyvee",!0);m(v,P,Q,"","\\circleddash",!0);m(v,P,Q,"","\\circledast",!0);m(v,P,Q,"","\\centerdot");m(v,P,Q,"","\\intercal",!0);m(v,P,Q,"","\\doublecap");m(v,P,Q,"","\\doublecup");m(v,P,Q,"","\\boxtimes",!0);m(v,P,M,"","\\dashrightarrow",!0);m(v,P,M,"","\\dashleftarrow",!0);m(v,P,M,"","\\leftleftarrows",!0);m(v,P,M,"","\\leftrightarrows",!0);m(v,P,M,"","\\Lleftarrow",!0);m(v,P,M,"","\\twoheadleftarrow",!0);m(v,P,M,"","\\leftarrowtail",!0);m(v,P,M,"","\\looparrowleft",!0);m(v,P,M,"","\\leftrightharpoons",!0);m(v,P,M,"","\\curvearrowleft",!0);m(v,P,M,"","\\circlearrowleft",!0);m(v,P,M,"","\\Lsh",!0);m(v,P,M,"","\\upuparrows",!0);m(v,P,M,"","\\upharpoonleft",!0);m(v,P,M,"","\\downharpoonleft",!0);m(v,A,M,"","\\origof",!0);m(v,A,M,"","\\imageof",!0);m(v,P,M,"","\\multimap",!0);m(v,P,M,"","\\leftrightsquigarrow",!0);m(v,P,M,"","\\rightrightarrows",!0);m(v,P,M,"","\\rightleftarrows",!0);m(v,P,M,"","\\twoheadrightarrow",!0);m(v,P,M,"","\\rightarrowtail",!0);m(v,P,M,"","\\looparrowright",!0);m(v,P,M,"","\\curvearrowright",!0);m(v,P,M,"","\\circlearrowright",!0);m(v,P,M,"","\\Rsh",!0);m(v,P,M,"","\\downdownarrows",!0);m(v,P,M,"","\\upharpoonright",!0);m(v,P,M,"","\\downharpoonright",!0);m(v,P,M,"","\\rightsquigarrow",!0);m(v,P,M,"","\\leadsto");m(v,P,M,"","\\Rrightarrow",!0);m(v,P,M,"","\\restriction");m(v,A,N,"","`");m(v,A,N,"$","\\$");m(j,A,N,"$","\\$");m(j,A,N,"$","\\textdollar");m(v,A,N,"%","\\%");m(j,A,N,"%","\\%");m(v,A,N,"_","\\_");m(j,A,N,"_","\\_");m(j,A,N,"_","\\textunderscore");m(v,A,N,"","\\angle",!0);m(v,A,N,"","\\infty",!0);m(v,A,N,"","\\prime");m(v,A,N,"","\\triangle");m(v,A,N,"","\\Gamma",!0);m(v,A,N,"","\\Delta",!0);m(v,A,N,"","\\Theta",!0);m(v,A,N,"","\\Lambda",!0);m(v,A,N,"","\\Xi",!0);m(v,A,N,"","\\Pi",!0);m(v,A,N,"","\\Sigma",!0);m(v,A,N,"","\\Upsilon",!0);m(v,A,N,"","\\Phi",!0);m(v,A,N,"","\\Psi",!0);m(v,A,N,"","\\Omega",!0);m(v,A,N,"A","");m(v,A,N,"B","");m(v,A,N,"E","");m(v,A,N,"Z","");m(v,A,N,"H","");m(v,A,N,"I","");m(v,A,N,"K","");m(v,A,N,"M","");m(v,A,N,"N","");m(v,A,N,"O","");m(v,A,N,"P","");m(v,A,N,"T","");m(v,A,N,"X","");m(v,A,N,"","\\neg",!0);m(v,A,N,"","\\lnot");m(v,A,N,"","\\top");m(v,A,N,"","\\bot");m(v,A,N,"","\\emptyset");m(v,P,N,"","\\varnothing");m(v,A,fe,"","\\alpha",!0);m(v,A,fe,"","\\beta",!0);m(v,A,fe,"","\\gamma",!0);m(v,A,fe,"","\\delta",!0);m(v,A,fe,"","\\epsilon",!0);m(v,A,fe,"","\\zeta",!0);m(v,A,fe,"","\\eta",!0);m(v,A,fe,"","\\theta",!0);m(v,A,fe,"","\\iota",!0);m(v,A,fe,"","\\kappa",!0);m(v,A,fe,"","\\lambda",!0);m(v,A,fe,"","\\mu",!0);m(v,A,fe,"","\\nu",!0);m(v,A,fe,"","\\xi",!0);m(v,A,fe,"","\\omicron",!0);m(v,A,fe,"","\\pi",!0);m(v,A,fe,"","\\rho",!0);m(v,A,fe,"","\\sigma",!0);m(v,A,fe,"","\\tau",!0);m(v,A,fe,"","\\upsilon",!0);m(v,A,fe,"","\\phi",!0);m(v,A,fe,"","\\chi",!0);m(v,A,fe,"","\\psi",!0);m(v,A,fe,"","\\omega",!0);m(v,A,fe,"","\\varepsilon",!0);m(v,A,fe,"","\\vartheta",!0);m(v,A,fe,"","\\varpi",!0);m(v,A,fe,"","\\varrho",!0);m(v,A,fe,"","\\varsigma",!0);m(v,A,fe,"","\\varphi",!0);m(v,A,Q,"","*",!0);m(v,A,Q,"+","+");m(v,A,Q,"","-",!0);m(v,A,Q,"","\\cdot",!0);m(v,A,Q,"","\\circ",!0);m(v,A,Q,"","\\div",!0);m(v,A,Q,"","\\pm",!0);m(v,A,Q,"","\\times",!0);m(v,A,Q,"","\\cap",!0);m(v,A,Q,"","\\cup",!0);m(v,A,Q,"","\\setminus",!0);m(v,A,Q,"","\\land");m(v,A,Q,"","\\lor");m(v,A,Q,"","\\wedge",!0);m(v,A,Q,"","\\vee",!0);m(v,A,N,"","\\surd");m(v,A,Mn,"","\\langle",!0);m(v,A,Mn,"","\\lvert");m(v,A,Mn,"","\\lVert");m(v,A,Br,"?","?");m(v,A,Br,"!","!");m(v,A,Br,"","\\rangle",!0);m(v,A,Br,"","\\rvert");m(v,A,Br,"","\\rVert");m(v,A,M,"=","=");m(v,A,M,":",":");m(v,A,M,"","\\approx",!0);m(v,A,M,"","\\cong",!0);m(v,A,M,"","\\ge");m(v,A,M,"","\\geq",!0);m(v,A,M,"","\\gets");m(v,A,M,">","\\gt",!0);m(v,A,M,"","\\in",!0);m(v,A,M,"","\\@not");m(v,A,M,"","\\subset",!0);m(v,A,M,"","\\supset",!0);m(v,A,M,"","\\subseteq",!0);m(v,A,M,"","\\supseteq",!0);m(v,P,M,"","\\nsubseteq",!0);m(v,P,M,"","\\nsupseteq",!0);m(v,A,M,"","\\models");m(v,A,M,"","\\leftarrow",!0);m(v,A,M,"","\\le");m(v,A,M,"","\\leq",!0);m(v,A,M,"<","\\lt",!0);m(v,A,M,"","\\rightarrow",!0);m(v,A,M,"","\\to");m(v,P,M,"","\\ngeq",!0);m(v,P,M,"","\\nleq",!0);m(v,A,la,"","\\ ");m(v,A,la,"","\\space");m(v,A,la,"","\\nobreakspace");m(j,A,la,"","\\ ");m(j,A,la,""," ");m(j,A,la,"","\\space");m(j,A,la,"","\\nobreakspace");m(v,A,la,null,"\\nobreak");m(v,A,la,null,"\\allowbreak");m(v,A,F1,",",",");m(v,A,F1,";",";");m(v,P,Q,"","\\barwedge",!0);m(v,P,Q,"","\\veebar",!0);m(v,A,Q,"","\\odot",!0);m(v,A,Q,"","\\oplus",!0);m(v,A,Q,"","\\otimes",!0);m(v,A,N,"","\\partial",!0);m(v,A,Q,"","\\oslash",!0);m(v,P,Q,"","\\circledcirc",!0);m(v,P,Q,"","\\boxdot",!0);m(v,A,Q,"","\\bigtriangleup");m(v,A,Q,"","\\bigtriangledown");m(v,A,Q,"","\\dagger");m(v,A,Q,"","\\diamond");m(v,A,Q,"","\\star");m(v,A,Q,"","\\triangleleft");m(v,A,Q,"","\\triangleright");m(v,A,Mn,"{","\\{");m(j,A,N,"{","\\{");m(j,A,N,"{","\\textbraceleft");m(v,A,Br,"}","\\}");m(j,A,N,"}","\\}");m(j,A,N,"}","\\textbraceright");m(v,A,Mn,"{","\\lbrace");m(v,A,Br,"}","\\rbrace");m(v,A,Mn,"[","\\lbrack",!0);m(j,A,N,"[","\\lbrack",!0);m(v,A,Br,"]","\\rbrack",!0);m(j,A,N,"]","\\rbrack",!0);m(v,A,Mn,"(","\\lparen",!0);m(v,A,Br,")","\\rparen",!0);m(j,A,N,"<","\\textless",!0);m(j,A,N,">","\\textgreater",!0);m(v,A,Mn,"","\\lfloor",!0);m(v,A,Br,"","\\rfloor",!0);m(v,A,Mn,"","\\lceil",!0);m(v,A,Br,"","\\rceil",!0);m(v,A,N,"\\","\\backslash");m(v,A,N,"","|");m(v,A,N,"","\\vert");m(j,A,N,"|","\\textbar",!0);m(v,A,N,"","\\|");m(v,A,N,"","\\Vert");m(j,A,N,"","\\textbardbl");m(j,A,N,"~","\\textasciitilde");m(j,A,N,"\\","\\textbackslash");m(j,A,N,"^","\\textasciicircum");m(v,A,M,"","\\uparrow",!0);m(v,A,M,"","\\Uparrow",!0);m(v,A,M,"","\\downarrow",!0);m(v,A,M,"","\\Downarrow",!0);m(v,A,M,"","\\updownarrow",!0);m(v,A,M,"","\\Updownarrow",!0);m(v,A,Nt,"","\\coprod");m(v,A,Nt,"","\\bigvee");m(v,A,Nt,"","\\bigwedge");m(v,A,Nt,"","\\biguplus");m(v,A,Nt,"","\\bigcap");m(v,A,Nt,"","\\bigcup");m(v,A,Nt,"","\\int");m(v,A,Nt,"","\\intop");m(v,A,Nt,"","\\iint");m(v,A,Nt,"","\\iiint");m(v,A,Nt,"","\\prod");m(v,A,Nt,"","\\sum");m(v,A,Nt,"","\\bigotimes");m(v,A,Nt,"","\\bigoplus");m(v,A,Nt,"","\\bigodot");m(v,A,Nt,"","\\oint");m(v,A,Nt,"","\\oiint");m(v,A,Nt,"","\\oiiint");m(v,A,Nt,"","\\bigsqcup");m(v,A,Nt,"","\\smallint");m(j,A,vh,"","\\textellipsis");m(v,A,vh,"","\\mathellipsis");m(j,A,vh,"","\\ldots",!0);m(v,A,vh,"","\\ldots",!0);m(v,A,vh,"","\\@cdots",!0);m(v,A,vh,"","\\ddots",!0);m(v,A,N,"","\\varvdots");m(j,A,N,"","\\varvdots");m(v,A,ut,"","\\acute");m(v,A,ut,"","\\grave");m(v,A,ut,"","\\ddot");m(v,A,ut,"~","\\tilde");m(v,A,ut,"","\\bar");m(v,A,ut,"","\\breve");m(v,A,ut,"","\\check");m(v,A,ut,"^","\\hat");m(v,A,ut,"","\\vec");m(v,A,ut,"","\\dot");m(v,A,ut,"","\\mathring");m(v,A,fe,"","\\@imath");m(v,A,fe,"","\\@jmath");m(v,A,N,"","");m(v,A,N,"","");m(j,A,N,"","\\i",!0);m(j,A,N,"","\\j",!0);m(j,A,N,"","\\ss",!0);m(j,A,N,"","\\ae",!0);m(j,A,N,"","\\oe",!0);m(j,A,N,"","\\o",!0);m(j,A,N,"","\\AE",!0);m(j,A,N,"","\\OE",!0);m(j,A,N,"","\\O",!0);m(j,A,ut,"","\\'");m(j,A,ut,"","\\`");m(j,A,ut,"","\\^");m(j,A,ut,"","\\~");m(j,A,ut,"","\\=");m(j,A,ut,"","\\u");m(j,A,ut,"","\\.");m(j,A,ut,"","\\c");m(j,A,ut,"","\\r");m(j,A,ut,"","\\v");m(j,A,ut,"",'\\"');m(j,A,ut,"","\\H");m(j,A,ut,"","\\textcircled");var L_={"--":!0,"---":!0,"``":!0,"''":!0};m(j,A,N,"","--",!0);m(j,A,N,"","\\textendash");m(j,A,N,"","---",!0);m(j,A,N,"","\\textemdash");m(j,A,N,"","`",!0);m(j,A,N,"","\\textquoteleft");m(j,A,N,"","'",!0);m(j,A,N,"","\\textquoteright");m(j,A,N,"","``",!0);m(j,A,N,"","\\textquotedblleft");m(j,A,N,"","''",!0);m(j,A,N,"","\\textquotedblright");m(v,A,N,"","\\degree",!0);m(j,A,N,"","\\degree");m(j,A,N,"","\\textdegree",!0);m(v,A,N,"","\\pounds");m(v,A,N,"","\\mathsterling",!0);m(j,A,N,"","\\pounds");m(j,A,N,"","\\textsterling",!0);m(v,P,N,"","\\maltese");m(j,P,N,"","\\maltese");var Lw='0123456789/@."';for(var Lg=0;Lg<Lw.length;Lg++){var Dw=Lw.charAt(Lg);m(v,A,N,Dw,Dw)}var Fw='0123456789!@*()-=+";:?/.,';for(var Dg=0;Dg<Fw.length;Dg++){var zw=Fw.charAt(Dg);m(j,A,N,zw,zw)}var Um="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var Fg=0;Fg<Um.length;Fg++){var ip=Um.charAt(Fg);m(v,A,fe,ip,ip),m(j,A,N,ip,ip)}m(v,P,N,"C","");m(j,P,N,"C","");m(v,P,N,"H","");m(j,P,N,"H","");m(v,P,N,"N","");m(j,P,N,"N","");m(v,P,N,"P","");m(j,P,N,"P","");m(v,P,N,"Q","");m(j,P,N,"Q","");m(v,P,N,"R","");m(j,P,N,"R","");m(v,P,N,"Z","");m(j,P,N,"Z","");m(v,A,fe,"h","");m(j,A,fe,"h","");var ye="";for(var Ar=0;Ar<Um.length;Ar++){var bt=Um.charAt(Ar);ye=String.fromCharCode(55349,56320+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56372+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56424+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56580+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56684+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56736+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56788+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56840+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56944+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),Ar<26&&(ye=String.fromCharCode(55349,56632+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye),ye=String.fromCharCode(55349,56476+Ar),m(v,A,fe,bt,ye),m(j,A,N,bt,ye))}ye="";m(v,A,fe,"k",ye);m(j,A,N,"k",ye);for(var To=0;To<10;To++){var da=To.toString();ye=String.fromCharCode(55349,57294+To),m(v,A,fe,da,ye),m(j,A,N,da,ye),ye=String.fromCharCode(55349,57314+To),m(v,A,fe,da,ye),m(j,A,N,da,ye),ye=String.fromCharCode(55349,57324+To),m(v,A,fe,da,ye),m(j,A,N,da,ye),ye=String.fromCharCode(55349,57334+To),m(v,A,fe,da,ye),m(j,A,N,da,ye)}var wy="";for(var zg=0;zg<wy.length;zg++){var ap=wy.charAt(zg);m(v,A,fe,ap,ap),m(j,A,N,ap,ap)}var op=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],Bw=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],jP=function(e,t){var n=e.charCodeAt(0),s=e.charCodeAt(1),i=(n-55296)*1024+(s-56320)+65536,a=t==="math"?0:1;if(119808<=i&&i<120484){var o=Math.floor((i-119808)/26);return[op[o][2],op[o][a]]}else if(120782<=i&&i<=120831){var l=Math.floor((i-120782)/10);return[Bw[l][2],Bw[l][a]]}else{if(i===120485||i===120486)return[op[0][2],op[0][a]];if(120486<i&&i<120782)return["",""];throw new U("Unsupported character: "+e)}},z1=function(e,t,n){return et[n][e]&&et[n][e].replace&&(e=et[n][e].replace),{value:e,metrics:$2(e,t,n)}},bs=function(e,t,n,s,i){var a=z1(e,t,n),o=a.metrics;e=a.value;var l;if(o){var c=o.italic;(n==="text"||s&&s.font==="mathit")&&(c=0),l=new Qn(e,o.height,o.depth,c,o.skew,o.width,i)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+e+"' in style '"+t+"' and mode '"+n+"'")),l=new Qn(e,0,0,0,0,0,i);if(s){l.maxFontSize=s.sizeMultiplier,s.style.isTight()&&l.classes.push("mtight");var h=s.getColor();h&&(l.style.color=h)}return l},$P=function(e,t,n,s){return s===void 0&&(s=[]),n.font==="boldsymbol"&&z1(e,"Main-Bold",t).metrics?bs(e,"Main-Bold",t,n,s.concat(["mathbf"])):e==="\\"||et[t][e].font==="main"?bs(e,"Main-Regular",t,n,s):bs(e,"AMS-Regular",t,n,s.concat(["amsrm"]))},UP=function(e,t,n,s,i){return i!=="textord"&&z1(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},HP=function(e,t,n){var s=e.mode,i=e.text,a=["mord"],o=s==="math"||s==="text"&&t.font,l=o?t.font:t.fontFamily,c="",h="";if(i.charCodeAt(0)===55349&&([c,h]=jP(i,s)),c.length>0)return bs(i,c,s,t,a.concat(h));if(l){var d,f;if(l==="boldsymbol"){var p=UP(i,s,t,a,n);d=p.fontName,f=[p.fontClass]}else o?(d=z_[l].fontName,f=[l]):(d=lp(l,t.fontWeight,t.fontShape),f=[l,t.fontWeight,t.fontShape]);if(z1(i,d,s).metrics)return bs(i,d,s,t,a.concat(f));if(L_.hasOwnProperty(i)&&d.slice(0,10)==="Typewriter"){for(var g=[],w=0;w<i.length;w++)g.push(bs(i[w],d,s,t,a.concat(f)));return F_(g)}}if(n==="mathord")return bs(i,"Math-Italic",s,t,a.concat(["mathnormal"]));if(n==="textord"){var x=et[s][i]&&et[s][i].font;if(x==="ams"){var y=lp("amsrm",t.fontWeight,t.fontShape);return bs(i,y,s,t,a.concat("amsrm",t.fontWeight,t.fontShape))}else if(x==="main"||!x){var b=lp("textrm",t.fontWeight,t.fontShape);return bs(i,b,s,t,a.concat(t.fontWeight,t.fontShape))}else{var _=lp(x,t.fontWeight,t.fontShape);return bs(i,_,s,t,a.concat(_,t.fontWeight,t.fontShape))}}else throw new Error("unexpected type: "+n+" in makeOrd")},qP=(r,e)=>{if(mo(r.classes)!==mo(e.classes)||r.skew!==e.skew||r.maxFontSize!==e.maxFontSize)return!1;if(r.classes.length===1){var t=r.classes[0];if(t==="mbin"||t==="mord")return!1}for(var n in r.style)if(r.style.hasOwnProperty(n)&&r.style[n]!==e.style[n])return!1;for(var s in e.style)if(e.style.hasOwnProperty(s)&&r.style[s]!==e.style[s])return!1;return!0},VP=r=>{for(var e=0;e<r.length-1;e++){var t=r[e],n=r[e+1];t instanceof Qn&&n instanceof Qn&&qP(t,n)&&(t.text+=n.text,t.height=Math.max(t.height,n.height),t.depth=Math.max(t.depth,n.depth),t.italic=n.italic,r.splice(e+1,1),e--)}return r},H2=function(e){for(var t=0,n=0,s=0,i=0;i<e.children.length;i++){var a=e.children[i];a.height>t&&(t=a.height),a.depth>n&&(n=a.depth),a.maxFontSize>s&&(s=a.maxFontSize)}e.height=t,e.depth=n,e.maxFontSize=s},Wr=function(e,t,n,s){var i=new Ef(e,t,n,s);return H2(i),i},D_=(r,e,t,n)=>new Ef(r,e,t,n),GP=function(e,t,n){var s=Wr([e],[],t);return s.height=Math.max(n||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),s.style.borderBottomWidth=G(s.height),s.maxFontSize=1,s},WP=function(e,t,n,s){var i=new U2(e,t,n,s);return H2(i),i},F_=function(e){var t=new Af(e);return H2(t),t},KP=function(e,t){return e instanceof Af?Wr([],[e],t):e},XP=function(e){if(e.positionType==="individualShift"){for(var t=e.children,n=[t[0]],s=-t[0].shift-t[0].elem.depth,i=s,a=1;a<t.length;a++){var o=-t[a].shift-i-t[a].elem.depth,l=o-(t[a-1].elem.height+t[a-1].elem.depth);i=i+o,n.push({type:"kern",size:l}),n.push(t[a])}return{children:n,depth:s}}var c;if(e.positionType==="top"){for(var h=e.positionData,d=0;d<e.children.length;d++){var f=e.children[d];h-=f.type==="kern"?f.size:f.elem.height+f.elem.depth}c=h}else if(e.positionType==="bottom")c=-e.positionData;else{var p=e.children[0];if(p.type!=="elem")throw new Error('First child must have type "elem".');if(e.positionType==="shift")c=-p.elem.depth-e.positionData;else if(e.positionType==="firstBaseline")c=-p.elem.depth;else throw new Error("Invalid positionType "+e.positionType+".")}return{children:e.children,depth:c}},YP=function(e,t){for(var{children:n,depth:s}=XP(e),i=0,a=0;a<n.length;a++){var o=n[a];if(o.type==="elem"){var l=o.elem;i=Math.max(i,l.maxFontSize,l.height)}}i+=2;var c=Wr(["pstrut"],[]);c.style.height=G(i);for(var h=[],d=s,f=s,p=s,g=0;g<n.length;g++){var w=n[g];if(w.type==="kern")p+=w.size;else{var x=w.elem,y=w.wrapperClasses||[],b=w.wrapperStyle||{},_=Wr(y,[c,x],void 0,b);_.style.top=G(-i-p-x.depth),w.marginLeft&&(_.style.marginLeft=w.marginLeft),w.marginRight&&(_.style.marginRight=w.marginRight),h.push(_),p+=x.height+x.depth}d=Math.min(d,p),f=Math.max(f,p)}var C=Wr(["vlist"],h);C.style.height=G(f);var R;if(d<0){var I=Wr([],[]),O=Wr(["vlist"],[I]);O.style.height=G(-d);var D=Wr(["vlist-s"],[new Qn("")]);R=[Wr(["vlist-r"],[C,D]),Wr(["vlist-r"],[O])]}else R=[Wr(["vlist-r"],[C])];var B=Wr(["vlist-t"],R);return R.length===2&&B.classes.push("vlist-t2"),B.height=f,B.depth=-d,B},QP=(r,e)=>{var t=Wr(["mspace"],[],e),n=mt(r,e);return t.style.marginRight=G(n),t},lp=function(e,t,n){var s="";switch(e){case"amsrm":s="AMS";break;case"textrm":s="Main";break;case"textsf":s="SansSerif";break;case"texttt":s="Typewriter";break;default:s=e}var i;return t==="textbf"&&n==="textit"?i="BoldItalic":t==="textbf"?i="Bold":t==="textit"?i="Italic":i="Regular",s+"-"+i},z_={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},B_={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},JP=function(e,t){var[n,s,i]=B_[e],a=new go(n),o=new ra([a],{width:G(s),height:G(i),style:"width:"+G(s),viewBox:"0 0 "+1e3*s+" "+1e3*i,preserveAspectRatio:"xMinYMin"}),l=D_(["overlay"],[o],t);return l.height=i,l.style.height=G(i),l.style.width=G(s),l},L={fontMap:z_,makeSymbol:bs,mathsym:$P,makeSpan:Wr,makeSvgSpan:D_,makeLineSpan:GP,makeAnchor:WP,makeFragment:F_,wrapFragment:KP,makeVList:YP,makeOrd:HP,makeGlue:QP,staticSvg:JP,svgData:B_,tryCombineChars:VP},dt={number:3,unit:"mu"},Co={number:4,unit:"mu"},ui={number:5,unit:"mu"},ZP={mord:{mop:dt,mbin:Co,mrel:ui,minner:dt},mop:{mord:dt,mop:dt,mrel:ui,minner:dt},mbin:{mord:Co,mop:Co,mopen:Co,minner:Co},mrel:{mord:ui,mop:ui,mopen:ui,minner:ui},mopen:{},mclose:{mop:dt,mbin:Co,mrel:ui,minner:dt},mpunct:{mord:dt,mop:dt,mrel:ui,mopen:dt,mclose:dt,mpunct:dt,minner:dt},minner:{mord:dt,mop:dt,mbin:Co,mrel:ui,mopen:dt,mpunct:dt,minner:dt}},eM={mord:{mop:dt},mop:{mord:dt,mop:dt},mbin:{},mrel:{},mopen:{},mclose:{mop:dt},mpunct:{},minner:{mop:dt}},j_={},Hm={},qm={};function Y(r){for(var{type:e,names:t,props:n,handler:s,htmlBuilder:i,mathmlBuilder:a}=r,o={type:e,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:n.allowedInMath===void 0?!0:n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:s},l=0;l<t.length;++l)j_[t[l]]=o;e&&(i&&(Hm[e]=i),a&&(qm[e]=a))}function uu(r){var{type:e,htmlBuilder:t,mathmlBuilder:n}=r;Y({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:t,mathmlBuilder:n})}var Vm=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},kt=function(e){return e.type==="ordgroup"?e.body:[e]},na=L.makeSpan,tM=["leftmost","mbin","mopen","mrel","mop","mpunct"],rM=["rightmost","mrel","mclose","mpunct"],nM={display:pe.DISPLAY,text:pe.TEXT,script:pe.SCRIPT,scriptscript:pe.SCRIPTSCRIPT},sM={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},Ht=function(e,t,n,s){s===void 0&&(s=[null,null]);for(var i=[],a=0;a<e.length;a++){var o=Le(e[a],t);if(o instanceof Af){var l=o.children;i.push(...l)}else i.push(o)}if(L.tryCombineChars(i),!n)return i;var c=t;if(e.length===1){var h=e[0];h.type==="sizing"?c=t.havingSize(h.size):h.type==="styling"&&(c=t.havingStyle(nM[h.style]))}var d=na([s[0]||"leftmost"],[],t),f=na([s[1]||"rightmost"],[],t),p=n==="root";return jw(i,(g,w)=>{var x=w.classes[0],y=g.classes[0];x==="mbin"&&rM.includes(y)?w.classes[0]="mord":y==="mbin"&&tM.includes(x)&&(g.classes[0]="mord")},{node:d},f,p),jw(i,(g,w)=>{var x=by(w),y=by(g),b=x&&y?g.hasClass("mtight")?eM[x][y]:ZP[x][y]:null;if(b)return L.makeGlue(b,c)},{node:d},f,p),i},jw=function r(e,t,n,s,i){s&&e.push(s);for(var a=0;a<e.length;a++){var o=e[a],l=$_(o);if(l){r(l.children,t,n,null,i);continue}var c=!o.hasClass("mspace");if(c){var h=t(o,n.node);h&&(n.insertAfter?n.insertAfter(h):(e.unshift(h),a++))}c?n.node=o:i&&o.hasClass("newline")&&(n.node=na(["leftmost"])),n.insertAfter=(d=>f=>{e.splice(d+1,0,f),a++})(a)}s&&e.pop()},$_=function(e){return e instanceof Af||e instanceof U2||e instanceof Ef&&e.hasClass("enclosing")?e:null},iM=function r(e,t){var n=$_(e);if(n){var s=n.children;if(s.length){if(t==="right")return r(s[s.length-1],"right");if(t==="left")return r(s[0],"left")}}return e},by=function(e,t){return e?(t&&(e=iM(e,t)),sM[e.classes[0]]||null):null},$0=function(e,t){var n=["nulldelimiter"].concat(e.baseSizingClasses());return na(t.concat(n))},Le=function(e,t,n){if(!e)return na();if(Hm[e.type]){var s=Hm[e.type](e,t);if(n&&t.size!==n.size){s=na(t.sizingClasses(n),[s],t);var i=t.sizeMultiplier/n.sizeMultiplier;s.height*=i,s.depth*=i}return s}else throw new U("Got group of unknown type: '"+e.type+"'")};function up(r,e){var t=na(["base"],r,e),n=na(["strut"]);return n.style.height=G(t.height+t.depth),t.depth&&(n.style.verticalAlign=G(-t.depth)),t.children.unshift(n),t}function Sy(r,e){var t=null;r.length===1&&r[0].type==="tag"&&(t=r[0].tag,r=r[0].body);var n=Ht(r,e,"root"),s;n.length===2&&n[1].hasClass("tag")&&(s=n.pop());for(var i=[],a=[],o=0;o<n.length;o++)if(a.push(n[o]),n[o].hasClass("mbin")||n[o].hasClass("mrel")||n[o].hasClass("allowbreak")){for(var l=!1;o<n.length-1&&n[o+1].hasClass("mspace")&&!n[o+1].hasClass("newline");)o++,a.push(n[o]),n[o].hasClass("nobreak")&&(l=!0);l||(i.push(up(a,e)),a=[])}else n[o].hasClass("newline")&&(a.pop(),a.length>0&&(i.push(up(a,e)),a=[]),i.push(n[o]));a.length>0&&i.push(up(a,e));var c;t?(c=up(Ht(t,e,!0)),c.classes=["tag"],i.push(c)):s&&i.push(s);var h=na(["katex-html"],i);if(h.setAttribute("aria-hidden","true"),c){var d=c.children[0];d.style.height=G(h.height+h.depth),h.depth&&(d.style.verticalAlign=G(-h.depth))}return h}function U_(r){return new Af(r)}class xn{constructor(e,t,n){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=n||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=mo(this.classes));for(var n=0;n<this.children.length;n++)if(this.children[n]instanceof ti&&this.children[n+1]instanceof ti){for(var s=this.children[n].toText()+this.children[++n].toText();this.children[n+1]instanceof ti;)s+=this.children[++n].toText();e.appendChild(new ti(s).toNode())}else e.appendChild(this.children[n].toNode());return e}toMarkup(){var e="<"+this.type;for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="',e+=Fe.escape(this.attributes[t]),e+='"');this.classes.length>0&&(e+=' class ="'+Fe.escape(mo(this.classes))+'"'),e+=">";for(var n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}class ti{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Fe.escape(this.toText())}toText(){return this.text}}class aM{constructor(e){this.width=void 0,this.character=void 0,this.width=e,e>=.05555&&e<=.05556?this.character="":e>=.1666&&e<=.1667?this.character="":e>=.2222&&e<=.2223?this.character="":e>=.2777&&e<=.2778?this.character="":e>=-.05556&&e<=-.05555?this.character="":e>=-.1667&&e<=-.1666?this.character="":e>=-.2223&&e<=-.2222?this.character="":e>=-.2778&&e<=-.2777?this.character="":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",G(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+G(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var $={MathNode:xn,TextNode:ti,SpaceNode:aM,newDocumentFragment:U_},Jn=function(e,t,n){return et[t][e]&&et[t][e].replace&&e.charCodeAt(0)!==55349&&!(L_.hasOwnProperty(e)&&n&&(n.fontFamily&&n.fontFamily.slice(4,6)==="tt"||n.font&&n.font.slice(4,6)==="tt"))&&(e=et[t][e].replace),new $.TextNode(e)},q2=function(e){return e.length===1?e[0]:new $.MathNode("mrow",e)},V2=function(e,t){if(t.fontFamily==="texttt")return"monospace";if(t.fontFamily==="textsf")return t.fontShape==="textit"&&t.fontWeight==="textbf"?"sans-serif-bold-italic":t.fontShape==="textit"?"sans-serif-italic":t.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(t.fontShape==="textit"&&t.fontWeight==="textbf")return"bold-italic";if(t.fontShape==="textit")return"italic";if(t.fontWeight==="textbf")return"bold";var n=t.font;if(!n||n==="mathnormal")return null;var s=e.mode;if(n==="mathit")return"italic";if(n==="boldsymbol")return e.type==="textord"?"bold":"bold-italic";if(n==="mathbf")return"bold";if(n==="mathbb")return"double-struck";if(n==="mathsfit")return"sans-serif-italic";if(n==="mathfrak")return"fraktur";if(n==="mathscr"||n==="mathcal")return"script";if(n==="mathsf")return"sans-serif";if(n==="mathtt")return"monospace";var i=e.text;if(["\\imath","\\jmath"].includes(i))return null;et[s][i]&&et[s][i].replace&&(i=et[s][i].replace);var a=L.fontMap[n].fontName;return $2(i,a,s)?L.fontMap[n].variant:null};function Bg(r){if(!r)return!1;if(r.type==="mi"&&r.children.length===1){var e=r.children[0];return e instanceof ti&&e.text==="."}else if(r.type==="mo"&&r.children.length===1&&r.getAttribute("separator")==="true"&&r.getAttribute("lspace")==="0em"&&r.getAttribute("rspace")==="0em"){var t=r.children[0];return t instanceof ti&&t.text===","}else return!1}var rn=function(e,t,n){if(e.length===1){var s=Xe(e[0],t);return n&&s instanceof xn&&s.type==="mo"&&(s.setAttribute("lspace","0em"),s.setAttribute("rspace","0em")),[s]}for(var i=[],a,o=0;o<e.length;o++){var l=Xe(e[o],t);if(l instanceof xn&&a instanceof xn){if(l.type==="mtext"&&a.type==="mtext"&&l.getAttribute("mathvariant")===a.getAttribute("mathvariant")){a.children.push(...l.children);continue}else if(l.type==="mn"&&a.type==="mn"){a.children.push(...l.children);continue}else if(Bg(l)&&a.type==="mn"){a.children.push(...l.children);continue}else if(l.type==="mn"&&Bg(a))l.children=[...a.children,...l.children],i.pop();else if((l.type==="msup"||l.type==="msub")&&l.children.length>=1&&(a.type==="mn"||Bg(a))){var c=l.children[0];c instanceof xn&&c.type==="mn"&&(c.children=[...a.children,...c.children],i.pop())}else if(a.type==="mi"&&a.children.length===1){var h=a.children[0];if(h instanceof ti&&h.text===""&&(l.type==="mo"||l.type==="mi"||l.type==="mn")){var d=l.children[0];d instanceof ti&&d.text.length>0&&(d.text=d.text.slice(0,1)+""+d.text.slice(1),i.pop())}}}i.push(l),a=l}return i},vo=function(e,t,n){return q2(rn(e,t,n))},Xe=function(e,t){if(!e)return new $.MathNode("mrow");if(qm[e.type]){var n=qm[e.type](e,t);return n}else throw new U("Got group of unknown type: '"+e.type+"'")};function $w(r,e,t,n,s){var i=rn(r,t),a;i.length===1&&i[0]instanceof xn&&["mrow","mtable"].includes(i[0].type)?a=i[0]:a=new $.MathNode("mrow",i);var o=new $.MathNode("annotation",[new $.TextNode(e)]);o.setAttribute("encoding","application/x-tex");var l=new $.MathNode("semantics",[a,o]),c=new $.MathNode("math",[l]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&c.setAttribute("display","block");var h=s?"katex":"katex-mathml";return L.makeSpan([h],[c])}var H_=function(e){return new yi({style:e.displayMode?pe.DISPLAY:pe.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},q_=function(e,t){if(t.displayMode){var n=["katex-display"];t.leqno&&n.push("leqno"),t.fleqn&&n.push("fleqn"),e=L.makeSpan(n,[e])}return e},oM=function(e,t,n){var s=H_(n),i;if(n.output==="mathml")return $w(e,t,s,n.displayMode,!0);if(n.output==="html"){var a=Sy(e,s);i=L.makeSpan(["katex"],[a])}else{var o=$w(e,t,s,n.displayMode,!1),l=Sy(e,s);i=L.makeSpan(["katex"],[o,l])}return q_(i,n)},lM=function(e,t,n){var s=H_(n),i=Sy(e,s),a=L.makeSpan(["katex"],[i]);return q_(a,n)},uM={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xrightleftarrows:"",xrightequilibrium:"",xleftequilibrium:"","\\cdrightarrow":"","\\cdleftarrow":"","\\cdlongequal":"="},cM=function(e){var t=new $.MathNode("mo",[new $.TextNode(uM[e.replace(/^\\/,"")])]);return t.setAttribute("stretchy","true"),t},hM={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},dM=function(e){return e.type==="ordgroup"?e.body.length:1},fM=function(e,t){function n(){var o=4e5,l=e.label.slice(1);if(["widehat","widecheck","widetilde","utilde"].includes(l)){var c=e,h=dM(c.base),d,f,p;if(h>5)l==="widehat"||l==="widecheck"?(d=420,o=2364,p=.42,f=l+"4"):(d=312,o=2340,p=.34,f="tilde4");else{var g=[1,1,2,2,3,3][h];l==="widehat"||l==="widecheck"?(o=[0,1062,2364,2364,2364][g],d=[0,239,300,360,420][g],p=[0,.24,.3,.3,.36,.42][g],f=l+g):(o=[0,600,1033,2339,2340][g],d=[0,260,286,306,312][g],p=[0,.26,.286,.3,.306,.34][g],f="tilde"+g)}var w=new go(f),x=new ra([w],{width:"100%",height:G(p),viewBox:"0 0 "+o+" "+d,preserveAspectRatio:"none"});return{span:L.makeSvgSpan([],[x],t),minWidth:0,height:p}}else{var y=[],b=hM[l],[_,C,R]=b,I=R/1e3,O=_.length,D,B;if(O===1){var q=b[3];D=["hide-tail"],B=[q]}else if(O===2)D=["halfarrow-left","halfarrow-right"],B=["xMinYMin","xMaxYMin"];else if(O===3)D=["brace-left","brace-center","brace-right"],B=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+O+" children.");for(var K=0;K<O;K++){var de=new go(_[K]),Re=new ra([de],{width:"400em",height:G(I),viewBox:"0 0 "+o+" "+R,preserveAspectRatio:B[K]+" slice"}),ge=L.makeSvgSpan([D[K]],[Re],t);if(O===1)return{span:ge,minWidth:C,height:I};ge.style.height=G(I),y.push(ge)}return{span:L.makeSpan(["stretchy"],y,t),minWidth:C,height:I}}}var{span:s,minWidth:i,height:a}=n();return s.height=a,s.style.height=G(a),i>0&&(s.style.minWidth=G(i)),s},pM=function(e,t,n,s,i){var a,o=e.height+e.depth+n+s;if(/fbox|color|angl/.test(t)){if(a=L.makeSpan(["stretchy",t],[],i),t==="fbox"){var l=i.color&&i.getColor();l&&(a.style.borderColor=l)}}else{var c=[];/^[bx]cancel$/.test(t)&&c.push(new yy({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&c.push(new yy({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var h=new ra(c,{width:"100%",height:G(o)});a=L.makeSvgSpan([],[h],i)}return a.height=o,a.style.height=G(o),a},sa={encloseSpan:pM,mathMLnode:cM,svgSpan:fM};function Ee(r,e){if(!r||r.type!==e)throw new Error("Expected node of type "+e+", but got "+(r?"node of type "+r.type:String(r)));return r}function G2(r){var e=B1(r);if(!e)throw new Error("Expected node of symbol group type, but got "+(r?"node of type "+r.type:String(r)));return e}function B1(r){return r&&(r.type==="atom"||BP.hasOwnProperty(r.type))?r:null}var W2=(r,e)=>{var t,n,s;r&&r.type==="supsub"?(n=Ee(r.base,"accent"),t=n.base,r.base=t,s=FP(Le(r,e)),r.base=n):(n=Ee(r,"accent"),t=n.base);var i=Le(t,e.havingCrampedStyle()),a=n.isShifty&&Fe.isCharacterBox(t),o=0;if(a){var l=Fe.getBaseElem(t),c=Le(l,e.havingCrampedStyle());o=Nw(c).skew}var h=n.label==="\\c",d=h?i.height+i.depth:Math.min(i.height,e.fontMetrics().xHeight),f;if(n.isStretchy)f=sa.svgSpan(n,e),f=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"elem",elem:f,wrapperClasses:["svg-align"],wrapperStyle:o>0?{width:"calc(100% - "+G(2*o)+")",marginLeft:G(2*o)}:void 0}]},e);else{var p,g;n.label==="\\vec"?(p=L.staticSvg("vec",e),g=L.svgData.vec[1]):(p=L.makeOrd({mode:n.mode,text:n.label},e,"textord"),p=Nw(p),p.italic=0,g=p.width,h&&(d+=p.depth)),f=L.makeSpan(["accent-body"],[p]);var w=n.label==="\\textcircled";w&&(f.classes.push("accent-full"),d=i.height);var x=o;w||(x-=g/2),f.style.left=G(x),n.label==="\\textcircled"&&(f.style.top=".2em"),f=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:-d},{type:"elem",elem:f}]},e)}var y=L.makeSpan(["mord","accent"],[f],e);return s?(s.children[0]=y,s.height=Math.max(y.height,s.height),s.classes[0]="mord",s):y},V_=(r,e)=>{var t=r.isStretchy?sa.mathMLnode(r.label):new $.MathNode("mo",[Jn(r.label,r.mode)]),n=new $.MathNode("mover",[Xe(r.base,e),t]);return n.setAttribute("accent","true"),n},mM=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(r=>"\\"+r).join("|"));Y({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(r,e)=>{var t=Vm(e[0]),n=!mM.test(r.funcName),s=!n||r.funcName==="\\widehat"||r.funcName==="\\widetilde"||r.funcName==="\\widecheck";return{type:"accent",mode:r.parser.mode,label:r.funcName,isStretchy:n,isShifty:s,base:t}},htmlBuilder:W2,mathmlBuilder:V_});Y({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(r,e)=>{var t=e[0],n=r.parser.mode;return n==="math"&&(r.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+r.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:r.funcName,isStretchy:!1,isShifty:!0,base:t}},htmlBuilder:W2,mathmlBuilder:V_});Y({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0];return{type:"accentUnder",mode:t.mode,label:n,base:s}},htmlBuilder:(r,e)=>{var t=Le(r.base,e),n=sa.svgSpan(r,e),s=r.label==="\\utilde"?.12:0,i=L.makeVList({positionType:"top",positionData:t.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:s},{type:"elem",elem:t}]},e);return L.makeSpan(["mord","accentunder"],[i],e)},mathmlBuilder:(r,e)=>{var t=sa.mathMLnode(r.label),n=new $.MathNode("munder",[Xe(r.base,e),t]);return n.setAttribute("accentunder","true"),n}});var cp=r=>{var e=new $.MathNode("mpadded",r?[r]:[]);return e.setAttribute("width","+0.6em"),e.setAttribute("lspace","0.3em"),e};Y({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(r,e,t){var{parser:n,funcName:s}=r;return{type:"xArrow",mode:n.mode,label:s,body:e[0],below:t[0]}},htmlBuilder(r,e){var t=e.style,n=e.havingStyle(t.sup()),s=L.wrapFragment(Le(r.body,n,e),e),i=r.label.slice(0,2)==="\\x"?"x":"cd";s.classes.push(i+"-arrow-pad");var a;r.below&&(n=e.havingStyle(t.sub()),a=L.wrapFragment(Le(r.below,n,e),e),a.classes.push(i+"-arrow-pad"));var o=sa.svgSpan(r,e),l=-e.fontMetrics().axisHeight+.5*o.height,c=-e.fontMetrics().axisHeight-.5*o.height-.111;(s.depth>.25||r.label==="\\xleftequilibrium")&&(c-=s.depth);var h;if(a){var d=-e.fontMetrics().axisHeight+a.height+.5*o.height+.111;h=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:c},{type:"elem",elem:o,shift:l},{type:"elem",elem:a,shift:d}]},e)}else h=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:c},{type:"elem",elem:o,shift:l}]},e);return h.children[0].children[0].children[1].classes.push("svg-align"),L.makeSpan(["mrel","x-arrow"],[h],e)},mathmlBuilder(r,e){var t=sa.mathMLnode(r.label);t.setAttribute("minsize",r.label.charAt(0)==="x"?"1.75em":"3.0em");var n;if(r.body){var s=cp(Xe(r.body,e));if(r.below){var i=cp(Xe(r.below,e));n=new $.MathNode("munderover",[t,i,s])}else n=new $.MathNode("mover",[t,s])}else if(r.below){var a=cp(Xe(r.below,e));n=new $.MathNode("munder",[t,a])}else n=cp(),n=new $.MathNode("mover",[t,n]);return n}});var gM=L.makeSpan;function G_(r,e){var t=Ht(r.body,e,!0);return gM([r.mclass],t,e)}function W_(r,e){var t,n=rn(r.body,e);return r.mclass==="minner"?t=new $.MathNode("mpadded",n):r.mclass==="mord"?r.isCharacterBox?(t=n[0],t.type="mi"):t=new $.MathNode("mi",n):(r.isCharacterBox?(t=n[0],t.type="mo"):t=new $.MathNode("mo",n),r.mclass==="mbin"?(t.attributes.lspace="0.22em",t.attributes.rspace="0.22em"):r.mclass==="mpunct"?(t.attributes.lspace="0em",t.attributes.rspace="0.17em"):r.mclass==="mopen"||r.mclass==="mclose"?(t.attributes.lspace="0em",t.attributes.rspace="0em"):r.mclass==="minner"&&(t.attributes.lspace="0.0556em",t.attributes.width="+0.1111em")),t}Y({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(r,e){var{parser:t,funcName:n}=r,s=e[0];return{type:"mclass",mode:t.mode,mclass:"m"+n.slice(5),body:kt(s),isCharacterBox:Fe.isCharacterBox(s)}},htmlBuilder:G_,mathmlBuilder:W_});var j1=r=>{var e=r.type==="ordgroup"&&r.body.length?r.body[0]:r;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};Y({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(r,e){var{parser:t}=r;return{type:"mclass",mode:t.mode,mclass:j1(e[0]),body:kt(e[1]),isCharacterBox:Fe.isCharacterBox(e[1])}}});Y({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(r,e){var{parser:t,funcName:n}=r,s=e[1],i=e[0],a;n!=="\\stackrel"?a=j1(s):a="mrel";var o={type:"op",mode:s.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:n!=="\\stackrel",body:kt(s)},l={type:"supsub",mode:i.mode,base:o,sup:n==="\\underset"?null:i,sub:n==="\\underset"?i:null};return{type:"mclass",mode:t.mode,mclass:a,body:[l],isCharacterBox:Fe.isCharacterBox(l)}},htmlBuilder:G_,mathmlBuilder:W_});Y({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(r,e){var{parser:t}=r;return{type:"pmb",mode:t.mode,mclass:j1(e[0]),body:kt(e[0])}},htmlBuilder(r,e){var t=Ht(r.body,e,!0),n=L.makeSpan([r.mclass],t,e);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(r,e){var t=rn(r.body,e),n=new $.MathNode("mstyle",t);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});var vM={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},Uw=()=>({type:"styling",body:[],mode:"math",style:"display"}),Hw=r=>r.type==="textord"&&r.text==="@",yM=(r,e)=>(r.type==="mathord"||r.type==="atom")&&r.text===e;function wM(r,e,t){var n=vM[r];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return t.callFunction(n,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{var s=t.callFunction("\\\\cdleft",[e[0]],[]),i={type:"atom",text:n,mode:"math",family:"rel"},a=t.callFunction("\\Big",[i],[]),o=t.callFunction("\\\\cdright",[e[1]],[]),l={type:"ordgroup",mode:"math",body:[s,a,o]};return t.callFunction("\\\\cdparent",[l],[])}case"\\\\cdlongequal":return t.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var c={type:"textord",text:"\\Vert",mode:"math"};return t.callFunction("\\Big",[c],[])}default:return{type:"textord",text:" ",mode:"math"}}}function bM(r){var e=[];for(r.gullet.beginGroup(),r.gullet.macros.set("\\cr","\\\\\\relax"),r.gullet.beginGroup();;){e.push(r.parseExpression(!1,"\\\\")),r.gullet.endGroup(),r.gullet.beginGroup();var t=r.fetch().text;if(t==="&"||t==="\\\\")r.consume();else if(t==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new U("Expected \\\\ or \\cr or \\end",r.nextToken)}for(var n=[],s=[n],i=0;i<e.length;i++){for(var a=e[i],o=Uw(),l=0;l<a.length;l++)if(!Hw(a[l]))o.body.push(a[l]);else{n.push(o),l+=1;var c=G2(a[l]).text,h=new Array(2);if(h[0]={type:"ordgroup",mode:"math",body:[]},h[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(c)>-1))if("<>AV".indexOf(c)>-1)for(var d=0;d<2;d++){for(var f=!0,p=l+1;p<a.length;p++){if(yM(a[p],c)){f=!1,l=p;break}if(Hw(a[p]))throw new U("Missing a "+c+" character to complete a CD arrow.",a[p]);h[d].body.push(a[p])}if(f)throw new U("Missing a "+c+" character to complete a CD arrow.",a[l])}else throw new U('Expected one of "<>AV=|." after @',a[l]);var g=wM(c,h,r),w={type:"styling",body:[g],mode:"math",style:"display"};n.push(w),o=Uw()}i%2===0?n.push(o):n.shift(),n=[],s.push(n)}r.gullet.endGroup(),r.gullet.endGroup();var x=new Array(s[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:s,arraystretch:1,addJot:!0,rowGaps:[null],cols:x,colSeparationType:"CD",hLinesBeforeRow:new Array(s.length+1).fill([])}}Y({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(r,e){var{parser:t,funcName:n}=r;return{type:"cdlabel",mode:t.mode,side:n.slice(4),label:e[0]}},htmlBuilder(r,e){var t=e.havingStyle(e.style.sup()),n=L.wrapFragment(Le(r.label,t,e),e);return n.classes.push("cd-label-"+r.side),n.style.bottom=G(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(r,e){var t=new $.MathNode("mrow",[Xe(r.label,e)]);return t=new $.MathNode("mpadded",[t]),t.setAttribute("width","0"),r.side==="left"&&t.setAttribute("lspace","-1width"),t.setAttribute("voffset","0.7em"),t=new $.MathNode("mstyle",[t]),t.setAttribute("displaystyle","false"),t.setAttribute("scriptlevel","1"),t}});Y({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(r,e){var{parser:t}=r;return{type:"cdlabelparent",mode:t.mode,fragment:e[0]}},htmlBuilder(r,e){var t=L.wrapFragment(Le(r.fragment,e),e);return t.classes.push("cd-vert-arrow"),t},mathmlBuilder(r,e){return new $.MathNode("mrow",[Xe(r.fragment,e)])}});Y({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(r,e){for(var{parser:t}=r,n=Ee(e[0],"ordgroup"),s=n.body,i="",a=0;a<s.length;a++){var o=Ee(s[a],"textord");i+=o.text}var l=parseInt(i),c;if(isNaN(l))throw new U("\\@char has non-numeric argument "+i);if(l<0||l>=1114111)throw new U("\\@char with invalid code point "+i);return l<=65535?c=String.fromCharCode(l):(l-=65536,c=String.fromCharCode((l>>10)+55296,(l&1023)+56320)),{type:"textord",mode:t.mode,text:c}}});var K_=(r,e)=>{var t=Ht(r.body,e.withColor(r.color),!1);return L.makeFragment(t)},X_=(r,e)=>{var t=rn(r.body,e.withColor(r.color)),n=new $.MathNode("mstyle",t);return n.setAttribute("mathcolor",r.color),n};Y({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(r,e){var{parser:t}=r,n=Ee(e[0],"color-token").color,s=e[1];return{type:"color",mode:t.mode,color:n,body:kt(s)}},htmlBuilder:K_,mathmlBuilder:X_});Y({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(r,e){var{parser:t,breakOnTokenText:n}=r,s=Ee(e[0],"color-token").color;t.gullet.macros.set("\\current@color",s);var i=t.parseExpression(!0,n);return{type:"color",mode:t.mode,color:s,body:i}},htmlBuilder:K_,mathmlBuilder:X_});Y({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(r,e,t){var{parser:n}=r,s=n.gullet.future().text==="["?n.parseSizeGroup(!0):null,i=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:i,size:s&&Ee(s,"size").value}},htmlBuilder(r,e){var t=L.makeSpan(["mspace"],[],e);return r.newLine&&(t.classes.push("newline"),r.size&&(t.style.marginTop=G(mt(r.size,e)))),t},mathmlBuilder(r,e){var t=new $.MathNode("mspace");return r.newLine&&(t.setAttribute("linebreak","newline"),r.size&&t.setAttribute("height",G(mt(r.size,e)))),t}});var _y={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},Y_=r=>{var e=r.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new U("Expected a control sequence",r);return e},SM=r=>{var e=r.gullet.popToken();return e.text==="="&&(e=r.gullet.popToken(),e.text===" "&&(e=r.gullet.popToken())),e},Q_=(r,e,t,n)=>{var s=r.gullet.macros.get(t.text);s==null&&(t.noexpand=!0,s={tokens:[t],numArgs:0,unexpandable:!r.gullet.isExpandable(t.text)}),r.gullet.macros.set(e,s,n)};Y({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(r){var{parser:e,funcName:t}=r;e.consumeSpaces();var n=e.fetch();if(_y[n.text])return(t==="\\global"||t==="\\\\globallong")&&(n.text=_y[n.text]),Ee(e.parseFunction(),"internal");throw new U("Invalid token after macro prefix",n)}});Y({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:t}=r,n=e.gullet.popToken(),s=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(s))throw new U("Expected a control sequence",n);for(var i=0,a,o=[[]];e.gullet.future().text!=="{";)if(n=e.gullet.popToken(),n.text==="#"){if(e.gullet.future().text==="{"){a=e.gullet.future(),o[i].push("{");break}if(n=e.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new U('Invalid argument number "'+n.text+'"');if(parseInt(n.text)!==i+1)throw new U('Argument number "'+n.text+'" out of order');i++,o.push([])}else{if(n.text==="EOF")throw new U("Expected a macro definition");o[i].push(n.text)}var{tokens:l}=e.gullet.consumeArg();return a&&l.unshift(a),(t==="\\edef"||t==="\\xdef")&&(l=e.gullet.expandTokens(l),l.reverse()),e.gullet.macros.set(s,{tokens:l,numArgs:i,delimiters:o},t===_y[t]),{type:"internal",mode:e.mode}}});Y({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:t}=r,n=Y_(e.gullet.popToken());e.gullet.consumeSpaces();var s=SM(e);return Q_(e,n,s,t==="\\\\globallet"),{type:"internal",mode:e.mode}}});Y({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:t}=r,n=Y_(e.gullet.popToken()),s=e.gullet.popToken(),i=e.gullet.popToken();return Q_(e,n,i,t==="\\\\globalfuture"),e.gullet.pushToken(i),e.gullet.pushToken(s),{type:"internal",mode:e.mode}}});var Zh=function(e,t,n){var s=et.math[e]&&et.math[e].replace,i=$2(s||e,t,n);if(!i)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return i},K2=function(e,t,n,s){var i=n.havingBaseStyle(t),a=L.makeSpan(s.concat(i.sizingClasses(n)),[e],n),o=i.sizeMultiplier/n.sizeMultiplier;return a.height*=o,a.depth*=o,a.maxFontSize=i.sizeMultiplier,a},J_=function(e,t,n){var s=t.havingBaseStyle(n),i=(1-t.sizeMultiplier/s.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=G(i),e.height-=i,e.depth+=i},_M=function(e,t,n,s,i,a){var o=L.makeSymbol(e,"Main-Regular",i,s),l=K2(o,t,s,a);return n&&J_(l,s,t),l},xM=function(e,t,n,s){return L.makeSymbol(e,"Size"+t+"-Regular",n,s)},Z_=function(e,t,n,s,i,a){var o=xM(e,t,i,s),l=K2(L.makeSpan(["delimsizing","size"+t],[o],s),pe.TEXT,s,a);return n&&J_(l,s,pe.TEXT),l},jg=function(e,t,n){var s;t==="Size1-Regular"?s="delim-size1":s="delim-size4";var i=L.makeSpan(["delimsizinginner",s],[L.makeSpan([],[L.makeSymbol(e,t,n)])]);return{type:"elem",elem:i}},$g=function(e,t,n){var s=ei["Size4-Regular"][e.charCodeAt(0)]?ei["Size4-Regular"][e.charCodeAt(0)][4]:ei["Size1-Regular"][e.charCodeAt(0)][4],i=new go("inner",CP(e,Math.round(1e3*t))),a=new ra([i],{width:G(s),height:G(t),style:"width:"+G(s),viewBox:"0 0 "+1e3*s+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),o=L.makeSvgSpan([],[a],n);return o.height=t,o.style.height=G(t),o.style.width=G(s),{type:"elem",elem:o}},xy=.008,hp={type:"kern",size:-1*xy},AM=["|","\\lvert","\\rvert","\\vert"],EM=["\\|","\\lVert","\\rVert","\\Vert"],ex=function(e,t,n,s,i,a){var o,l,c,h,d="",f=0;o=c=h=e,l=null;var p="Size1-Regular";e==="\\uparrow"?c=h="":e==="\\Uparrow"?c=h="":e==="\\downarrow"?o=c="":e==="\\Downarrow"?o=c="":e==="\\updownarrow"?(o="\\uparrow",c="",h="\\downarrow"):e==="\\Updownarrow"?(o="\\Uparrow",c="",h="\\Downarrow"):AM.includes(e)?(c="",d="vert",f=333):EM.includes(e)?(c="",d="doublevert",f=556):e==="["||e==="\\lbrack"?(o="",c="",h="",p="Size4-Regular",d="lbrack",f=667):e==="]"||e==="\\rbrack"?(o="",c="",h="",p="Size4-Regular",d="rbrack",f=667):e==="\\lfloor"||e===""?(c=o="",h="",p="Size4-Regular",d="lfloor",f=667):e==="\\lceil"||e===""?(o="",c=h="",p="Size4-Regular",d="lceil",f=667):e==="\\rfloor"||e===""?(c=o="",h="",p="Size4-Regular",d="rfloor",f=667):e==="\\rceil"||e===""?(o="",c=h="",p="Size4-Regular",d="rceil",f=667):e==="("||e==="\\lparen"?(o="",c="",h="",p="Size4-Regular",d="lparen",f=875):e===")"||e==="\\rparen"?(o="",c="",h="",p="Size4-Regular",d="rparen",f=875):e==="\\{"||e==="\\lbrace"?(o="",l="",h="",c="",p="Size4-Regular"):e==="\\}"||e==="\\rbrace"?(o="",l="",h="",c="",p="Size4-Regular"):e==="\\lgroup"||e===""?(o="",h="",c="",p="Size4-Regular"):e==="\\rgroup"||e===""?(o="",h="",c="",p="Size4-Regular"):e==="\\lmoustache"||e===""?(o="",h="",c="",p="Size4-Regular"):(e==="\\rmoustache"||e==="")&&(o="",h="",c="",p="Size4-Regular");var g=Zh(o,p,i),w=g.height+g.depth,x=Zh(c,p,i),y=x.height+x.depth,b=Zh(h,p,i),_=b.height+b.depth,C=0,R=1;if(l!==null){var I=Zh(l,p,i);C=I.height+I.depth,R=2}var O=w+_+C,D=Math.max(0,Math.ceil((t-O)/(R*y))),B=O+D*R*y,q=s.fontMetrics().axisHeight;n&&(q*=s.sizeMultiplier);var K=B/2-q,de=[];if(d.length>0){var Re=B-w-_,ge=Math.round(B*1e3),Be=RP(d,Math.round(Re*1e3)),W=new go(d,Be),ne=(f/1e3).toFixed(3)+"em",V=(ge/1e3).toFixed(3)+"em",le=new ra([W],{width:ne,height:V,viewBox:"0 0 "+f+" "+ge}),re=L.makeSvgSpan([],[le],s);re.height=ge/1e3,re.style.width=ne,re.style.height=V,de.push({type:"elem",elem:re})}else{if(de.push(jg(h,p,i)),de.push(hp),l===null){var Se=B-w-_+2*xy;de.push($g(c,Se,s))}else{var ve=(B-w-_-C)/2+2*xy;de.push($g(c,ve,s)),de.push(hp),de.push(jg(l,p,i)),de.push(hp),de.push($g(c,ve,s))}de.push(hp),de.push(jg(o,p,i))}var De=s.havingBaseStyle(pe.TEXT),Ct=L.makeVList({positionType:"bottom",positionData:K,children:de},De);return K2(L.makeSpan(["delimsizing","mult"],[Ct],De),pe.TEXT,s,a)},Ug=80,Hg=.08,qg=function(e,t,n,s,i){var a=TP(e,s,n),o=new go(e,a),l=new ra([o],{width:"400em",height:G(t),viewBox:"0 0 400000 "+n,preserveAspectRatio:"xMinYMin slice"});return L.makeSvgSpan(["hide-tail"],[l],i)},kM=function(e,t){var n=t.havingBaseSizing(),s=sx("\\surd",e*n.sizeMultiplier,nx,n),i=n.sizeMultiplier,a=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),o,l=0,c=0,h=0,d;return s.type==="small"?(h=1e3+1e3*a+Ug,e<1?i=1:e<1.4&&(i=.7),l=(1+a+Hg)/i,c=(1+a)/i,o=qg("sqrtMain",l,h,a,t),o.style.minWidth="0.853em",d=.833/i):s.type==="large"?(h=(1e3+Ug)*f0[s.size],c=(f0[s.size]+a)/i,l=(f0[s.size]+a+Hg)/i,o=qg("sqrtSize"+s.size,l,h,a,t),o.style.minWidth="1.02em",d=1/i):(l=e+a+Hg,c=e+a,h=Math.floor(1e3*e+a)+Ug,o=qg("sqrtTall",l,h,a,t),o.style.minWidth="0.742em",d=1.056),o.height=c,o.style.height=G(l),{span:o,advanceWidth:d,ruleWidth:(t.fontMetrics().sqrtRuleThickness+a)*i}},tx=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","\\surd"],TM=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","",""],rx=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],f0=[0,1.2,1.8,2.4,3],CM=function(e,t,n,s,i){if(e==="<"||e==="\\lt"||e===""?e="\\langle":(e===">"||e==="\\gt"||e==="")&&(e="\\rangle"),tx.includes(e)||rx.includes(e))return Z_(e,t,!1,n,s,i);if(TM.includes(e))return ex(e,f0[t],!1,n,s,i);throw new U("Illegal delimiter: '"+e+"'")},RM=[{type:"small",style:pe.SCRIPTSCRIPT},{type:"small",style:pe.SCRIPT},{type:"small",style:pe.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],PM=[{type:"small",style:pe.SCRIPTSCRIPT},{type:"small",style:pe.SCRIPT},{type:"small",style:pe.TEXT},{type:"stack"}],nx=[{type:"small",style:pe.SCRIPTSCRIPT},{type:"small",style:pe.SCRIPT},{type:"small",style:pe.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],MM=function(e){if(e.type==="small")return"Main-Regular";if(e.type==="large")return"Size"+e.size+"-Regular";if(e.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},sx=function(e,t,n,s){for(var i=Math.min(2,3-s.style.size),a=i;a<n.length&&n[a].type!=="stack";a++){var o=Zh(e,MM(n[a]),"math"),l=o.height+o.depth;if(n[a].type==="small"){var c=s.havingBaseStyle(n[a].style);l*=c.sizeMultiplier}if(l>t)return n[a]}return n[n.length-1]},ix=function(e,t,n,s,i,a){e==="<"||e==="\\lt"||e===""?e="\\langle":(e===">"||e==="\\gt"||e==="")&&(e="\\rangle");var o;rx.includes(e)?o=RM:tx.includes(e)?o=nx:o=PM;var l=sx(e,t,o,s);return l.type==="small"?_M(e,l.style,n,s,i,a):l.type==="large"?Z_(e,l.size,n,s,i,a):ex(e,t,n,s,i,a)},IM=function(e,t,n,s,i,a){var o=s.fontMetrics().axisHeight*s.sizeMultiplier,l=901,c=5/s.fontMetrics().ptPerEm,h=Math.max(t-o,n+o),d=Math.max(h/500*l,2*h-c);return ix(e,d,!0,s,i,a)},Xi={sqrtImage:kM,sizedDelim:CM,sizeToMaxHeight:f0,customSizedDelim:ix,leftRightDelim:IM},qw={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},OM=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","<",">","\\langle","","\\rangle","","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","","","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function $1(r,e){var t=B1(r);if(t&&OM.includes(t.text))return t;throw t?new U("Invalid delimiter '"+t.text+"' after '"+e.funcName+"'",r):new U("Invalid delimiter type '"+r.type+"'",r)}Y({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(r,e)=>{var t=$1(e[0],r);return{type:"delimsizing",mode:r.parser.mode,size:qw[r.funcName].size,mclass:qw[r.funcName].mclass,delim:t.text}},htmlBuilder:(r,e)=>r.delim==="."?L.makeSpan([r.mclass]):Xi.sizedDelim(r.delim,r.size,e,r.mode,[r.mclass]),mathmlBuilder:r=>{var e=[];r.delim!=="."&&e.push(Jn(r.delim,r.mode));var t=new $.MathNode("mo",e);r.mclass==="mopen"||r.mclass==="mclose"?t.setAttribute("fence","true"):t.setAttribute("fence","false"),t.setAttribute("stretchy","true");var n=G(Xi.sizeToMaxHeight[r.size]);return t.setAttribute("minsize",n),t.setAttribute("maxsize",n),t}});function Vw(r){if(!r.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}Y({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var t=r.parser.gullet.macros.get("\\current@color");if(t&&typeof t!="string")throw new U("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:r.parser.mode,delim:$1(e[0],r).text,color:t}}});Y({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var t=$1(e[0],r),n=r.parser;++n.leftrightDepth;var s=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\right",!1);var i=Ee(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:s,left:t.text,right:i.delim,rightColor:i.color}},htmlBuilder:(r,e)=>{Vw(r);for(var t=Ht(r.body,e,!0,["mopen","mclose"]),n=0,s=0,i=!1,a=0;a<t.length;a++)t[a].isMiddle?i=!0:(n=Math.max(t[a].height,n),s=Math.max(t[a].depth,s));n*=e.sizeMultiplier,s*=e.sizeMultiplier;var o;if(r.left==="."?o=$0(e,["mopen"]):o=Xi.leftRightDelim(r.left,n,s,e,r.mode,["mopen"]),t.unshift(o),i)for(var l=1;l<t.length;l++){var c=t[l],h=c.isMiddle;h&&(t[l]=Xi.leftRightDelim(h.delim,n,s,h.options,r.mode,[]))}var d;if(r.right===".")d=$0(e,["mclose"]);else{var f=r.rightColor?e.withColor(r.rightColor):e;d=Xi.leftRightDelim(r.right,n,s,f,r.mode,["mclose"])}return t.push(d),L.makeSpan(["minner"],t,e)},mathmlBuilder:(r,e)=>{Vw(r);var t=rn(r.body,e);if(r.left!=="."){var n=new $.MathNode("mo",[Jn(r.left,r.mode)]);n.setAttribute("fence","true"),t.unshift(n)}if(r.right!=="."){var s=new $.MathNode("mo",[Jn(r.right,r.mode)]);s.setAttribute("fence","true"),r.rightColor&&s.setAttribute("mathcolor",r.rightColor),t.push(s)}return q2(t)}});Y({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var t=$1(e[0],r);if(!r.parser.leftrightDepth)throw new U("\\middle without preceding \\left",t);return{type:"middle",mode:r.parser.mode,delim:t.text}},htmlBuilder:(r,e)=>{var t;if(r.delim===".")t=$0(e,[]);else{t=Xi.sizedDelim(r.delim,1,e,r.mode,[]);var n={delim:r.delim,options:e};t.isMiddle=n}return t},mathmlBuilder:(r,e)=>{var t=r.delim==="\\vert"||r.delim==="|"?Jn("|","text"):Jn(r.delim,r.mode),n=new $.MathNode("mo",[t]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});var X2=(r,e)=>{var t=L.wrapFragment(Le(r.body,e),e),n=r.label.slice(1),s=e.sizeMultiplier,i,a=0,o=Fe.isCharacterBox(r.body);if(n==="sout")i=L.makeSpan(["stretchy","sout"]),i.height=e.fontMetrics().defaultRuleThickness/s,a=-.5*e.fontMetrics().xHeight;else if(n==="phase"){var l=mt({number:.6,unit:"pt"},e),c=mt({number:.35,unit:"ex"},e),h=e.havingBaseSizing();s=s/h.sizeMultiplier;var d=t.height+t.depth+l+c;t.style.paddingLeft=G(d/2+l);var f=Math.floor(1e3*d*s),p=EP(f),g=new ra([new go("phase",p)],{width:"400em",height:G(f/1e3),viewBox:"0 0 400000 "+f,preserveAspectRatio:"xMinYMin slice"});i=L.makeSvgSpan(["hide-tail"],[g],e),i.style.height=G(d),a=t.depth+l+c}else{/cancel/.test(n)?o||t.classes.push("cancel-pad"):n==="angl"?t.classes.push("anglpad"):t.classes.push("boxpad");var w=0,x=0,y=0;/box/.test(n)?(y=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness),w=e.fontMetrics().fboxsep+(n==="colorbox"?0:y),x=w):n==="angl"?(y=Math.max(e.fontMetrics().defaultRuleThickness,e.minRuleThickness),w=4*y,x=Math.max(0,.25-t.depth)):(w=o?.2:0,x=w),i=sa.encloseSpan(t,n,w,x,e),/fbox|boxed|fcolorbox/.test(n)?(i.style.borderStyle="solid",i.style.borderWidth=G(y)):n==="angl"&&y!==.049&&(i.style.borderTopWidth=G(y),i.style.borderRightWidth=G(y)),a=t.depth+x,r.backgroundColor&&(i.style.backgroundColor=r.backgroundColor,r.borderColor&&(i.style.borderColor=r.borderColor))}var b;if(r.backgroundColor)b=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:a},{type:"elem",elem:t,shift:0}]},e);else{var _=/cancel|phase/.test(n)?["svg-align"]:[];b=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:t,shift:0},{type:"elem",elem:i,shift:a,wrapperClasses:_}]},e)}return/cancel/.test(n)&&(b.height=t.height,b.depth=t.depth),/cancel/.test(n)&&!o?L.makeSpan(["mord","cancel-lap"],[b],e):L.makeSpan(["mord"],[b],e)},Y2=(r,e)=>{var t=0,n=new $.MathNode(r.label.indexOf("colorbox")>-1?"mpadded":"menclose",[Xe(r.body,e)]);switch(r.label){case"\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\phase":n.setAttribute("notation","phasorangle");break;case"\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\fbox":n.setAttribute("notation","box");break;case"\\angl":n.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(t=e.fontMetrics().fboxsep*e.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*t+"pt"),n.setAttribute("height","+"+2*t+"pt"),n.setAttribute("lspace",t+"pt"),n.setAttribute("voffset",t+"pt"),r.label==="\\fcolorbox"){var s=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness);n.setAttribute("style","border: "+s+"em solid "+String(r.borderColor))}break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return r.backgroundColor&&n.setAttribute("mathbackground",r.backgroundColor),n};Y({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(r,e,t){var{parser:n,funcName:s}=r,i=Ee(e[0],"color-token").color,a=e[1];return{type:"enclose",mode:n.mode,label:s,backgroundColor:i,body:a}},htmlBuilder:X2,mathmlBuilder:Y2});Y({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(r,e,t){var{parser:n,funcName:s}=r,i=Ee(e[0],"color-token").color,a=Ee(e[1],"color-token").color,o=e[2];return{type:"enclose",mode:n.mode,label:s,backgroundColor:a,borderColor:i,body:o}},htmlBuilder:X2,mathmlBuilder:Y2});Y({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(r,e){var{parser:t}=r;return{type:"enclose",mode:t.mode,label:"\\fbox",body:e[0]}}});Y({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(r,e){var{parser:t,funcName:n}=r,s=e[0];return{type:"enclose",mode:t.mode,label:n,body:s}},htmlBuilder:X2,mathmlBuilder:Y2});Y({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(r,e){var{parser:t}=r;return{type:"enclose",mode:t.mode,label:"\\angl",body:e[0]}}});var ax={};function ii(r){for(var{type:e,names:t,props:n,handler:s,htmlBuilder:i,mathmlBuilder:a}=r,o={type:e,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:s},l=0;l<t.length;++l)ax[t[l]]=o;i&&(Hm[e]=i),a&&(qm[e]=a)}var ox={};function T(r,e){ox[r]=e}function Gw(r){var e=[];r.consumeSpaces();var t=r.fetch().text;for(t==="\\relax"&&(r.consume(),r.consumeSpaces(),t=r.fetch().text);t==="\\hline"||t==="\\hdashline";)r.consume(),e.push(t==="\\hdashline"),r.consumeSpaces(),t=r.fetch().text;return e}var U1=r=>{var e=r.parser.settings;if(!e.displayMode)throw new U("{"+r.envName+"} can be used only in display mode.")};function Q2(r){if(r.indexOf("ed")===-1)return r.indexOf("*")===-1}function Ao(r,e,t){var{hskipBeforeAndAfter:n,addJot:s,cols:i,arraystretch:a,colSeparationType:o,autoTag:l,singleRow:c,emptySingleRow:h,maxNumCols:d,leqno:f}=e;if(r.gullet.beginGroup(),c||r.gullet.macros.set("\\cr","\\\\\\relax"),!a){var p=r.gullet.expandMacroAsText("\\arraystretch");if(p==null)a=1;else if(a=parseFloat(p),!a||a<0)throw new U("Invalid \\arraystretch: "+p)}r.gullet.beginGroup();var g=[],w=[g],x=[],y=[],b=l!=null?[]:void 0;function _(){l&&r.gullet.macros.set("\\@eqnsw","1",!0)}function C(){b&&(r.gullet.macros.get("\\df@tag")?(b.push(r.subparse([new kn("\\df@tag")])),r.gullet.macros.set("\\df@tag",void 0,!0)):b.push(!!l&&r.gullet.macros.get("\\@eqnsw")==="1"))}for(_(),y.push(Gw(r));;){var R=r.parseExpression(!1,c?"\\end":"\\\\");r.gullet.endGroup(),r.gullet.beginGroup(),R={type:"ordgroup",mode:r.mode,body:R},t&&(R={type:"styling",mode:r.mode,style:t,body:[R]}),g.push(R);var I=r.fetch().text;if(I==="&"){if(d&&g.length===d){if(c||o)throw new U("Too many tab characters: &",r.nextToken);r.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}r.consume()}else if(I==="\\end"){C(),g.length===1&&R.type==="styling"&&R.body[0].body.length===0&&(w.length>1||!h)&&w.pop(),y.length<w.length+1&&y.push([]);break}else if(I==="\\\\"){r.consume();var O=void 0;r.gullet.future().text!==" "&&(O=r.parseSizeGroup(!0)),x.push(O?O.value:null),C(),y.push(Gw(r)),g=[],w.push(g),_()}else throw new U("Expected & or \\\\ or \\cr or \\end",r.nextToken)}return r.gullet.endGroup(),r.gullet.endGroup(),{type:"array",mode:r.mode,addJot:s,arraystretch:a,body:w,cols:i,rowGaps:x,hskipBeforeAndAfter:n,hLinesBeforeRow:y,colSeparationType:o,tags:b,leqno:f}}function J2(r){return r.slice(0,1)==="d"?"display":"text"}var ai=function(e,t){var n,s,i=e.body.length,a=e.hLinesBeforeRow,o=0,l=new Array(i),c=[],h=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),d=1/t.fontMetrics().ptPerEm,f=5*d;if(e.colSeparationType&&e.colSeparationType==="small"){var p=t.havingStyle(pe.SCRIPT).sizeMultiplier;f=.2778*(p/t.sizeMultiplier)}var g=e.colSeparationType==="CD"?mt({number:3,unit:"ex"},t):12*d,w=3*d,x=e.arraystretch*g,y=.7*x,b=.3*x,_=0;function C(Rs){for(var wt=0;wt<Rs.length;++wt)wt>0&&(_+=.25),c.push({pos:_,isDashed:Rs[wt]})}for(C(a[0]),n=0;n<e.body.length;++n){var R=e.body[n],I=y,O=b;o<R.length&&(o=R.length);var D=new Array(R.length);for(s=0;s<R.length;++s){var B=Le(R[s],t);O<B.depth&&(O=B.depth),I<B.height&&(I=B.height),D[s]=B}var q=e.rowGaps[n],K=0;q&&(K=mt(q,t),K>0&&(K+=b,O<K&&(O=K),K=0)),e.addJot&&(O+=w),D.height=I,D.depth=O,_+=I,D.pos=_,_+=O+K,l[n]=D,C(a[n+1])}var de=_/2+t.fontMetrics().axisHeight,Re=e.cols||[],ge=[],Be,W,ne=[];if(e.tags&&e.tags.some(Rs=>Rs))for(n=0;n<i;++n){var V=l[n],le=V.pos-de,re=e.tags[n],Se=void 0;re===!0?Se=L.makeSpan(["eqn-num"],[],t):re===!1?Se=L.makeSpan([],[],t):Se=L.makeSpan([],Ht(re,t,!0),t),Se.depth=V.depth,Se.height=V.height,ne.push({type:"elem",elem:Se,shift:le})}for(s=0,W=0;s<o||W<Re.length;++s,++W){for(var ve=Re[W]||{},De=!0;ve.type==="separator";){if(De||(Be=L.makeSpan(["arraycolsep"],[]),Be.style.width=G(t.fontMetrics().doubleRuleSep),ge.push(Be)),ve.separator==="|"||ve.separator===":"){var Ct=ve.separator==="|"?"solid":"dashed",qt=L.makeSpan(["vertical-separator"],[],t);qt.style.height=G(_),qt.style.borderRightWidth=G(h),qt.style.borderRightStyle=Ct,qt.style.margin="0 "+G(-h/2);var Ve=_-de;Ve&&(qt.style.verticalAlign=G(-Ve)),ge.push(qt)}else throw new U("Invalid separator type: "+ve.separator);W++,ve=Re[W]||{},De=!1}if(!(s>=o)){var F=void 0;(s>0||e.hskipBeforeAndAfter)&&(F=Fe.deflt(ve.pregap,f),F!==0&&(Be=L.makeSpan(["arraycolsep"],[]),Be.style.width=G(F),ge.push(Be)));var se=[];for(n=0;n<i;++n){var ae=l[n],Ie=ae[s];if(Ie){var Ye=ae.pos-de;Ie.depth=ae.depth,Ie.height=ae.height,se.push({type:"elem",elem:Ie,shift:Ye})}}se=L.makeVList({positionType:"individualShift",children:se},t),se=L.makeSpan(["col-align-"+(ve.align||"c")],[se]),ge.push(se),(s<o-1||e.hskipBeforeAndAfter)&&(F=Fe.deflt(ve.postgap,f),F!==0&&(Be=L.makeSpan(["arraycolsep"],[]),Be.style.width=G(F),ge.push(Be)))}}if(l=L.makeSpan(["mtable"],ge),c.length>0){for(var je=L.makeLineSpan("hline",t,h),Cs=L.makeLineSpan("hdashline",t,h),Zn=[{type:"elem",elem:l,shift:0}];c.length>0;){var nn=c.pop(),li=nn.pos-de;nn.isDashed?Zn.push({type:"elem",elem:Cs,shift:li}):Zn.push({type:"elem",elem:je,shift:li})}l=L.makeVList({positionType:"individualShift",children:Zn},t)}if(ne.length===0)return L.makeSpan(["mord"],[l],t);var lr=L.makeVList({positionType:"individualShift",children:ne},t);return lr=L.makeSpan(["tag"],[lr],t),L.makeFragment([l,lr])},NM={c:"center ",l:"left ",r:"right "},oi=function(e,t){for(var n=[],s=new $.MathNode("mtd",[],["mtr-glue"]),i=new $.MathNode("mtd",[],["mml-eqn-num"]),a=0;a<e.body.length;a++){for(var o=e.body[a],l=[],c=0;c<o.length;c++)l.push(new $.MathNode("mtd",[Xe(o[c],t)]));e.tags&&e.tags[a]&&(l.unshift(s),l.push(s),e.leqno?l.unshift(i):l.push(i)),n.push(new $.MathNode("mtr",l))}var h=new $.MathNode("mtable",n),d=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);h.setAttribute("rowspacing",G(d));var f="",p="";if(e.cols&&e.cols.length>0){var g=e.cols,w="",x=!1,y=0,b=g.length;g[0].type==="separator"&&(f+="top ",y=1),g[g.length-1].type==="separator"&&(f+="bottom ",b-=1);for(var _=y;_<b;_++)g[_].type==="align"?(p+=NM[g[_].align],x&&(w+="none "),x=!0):g[_].type==="separator"&&x&&(w+=g[_].separator==="|"?"solid ":"dashed ",x=!1);h.setAttribute("columnalign",p.trim()),/[sd]/.test(w)&&h.setAttribute("columnlines",w.trim())}if(e.colSeparationType==="align"){for(var C=e.cols||[],R="",I=1;I<C.length;I++)R+=I%2?"0em ":"1em ";h.setAttribute("columnspacing",R.trim())}else e.colSeparationType==="alignat"||e.colSeparationType==="gather"?h.setAttribute("columnspacing","0em"):e.colSeparationType==="small"?h.setAttribute("columnspacing","0.2778em"):e.colSeparationType==="CD"?h.setAttribute("columnspacing","0.5em"):h.setAttribute("columnspacing","1em");var O="",D=e.hLinesBeforeRow;f+=D[0].length>0?"left ":"",f+=D[D.length-1].length>0?"right ":"";for(var B=1;B<D.length-1;B++)O+=D[B].length===0?"none ":D[B][0]?"dashed ":"solid ";return/[sd]/.test(O)&&h.setAttribute("rowlines",O.trim()),f!==""&&(h=new $.MathNode("menclose",[h]),h.setAttribute("notation",f.trim())),e.arraystretch&&e.arraystretch<1&&(h=new $.MathNode("mstyle",[h]),h.setAttribute("scriptlevel","1")),h},lx=function(e,t){e.envName.indexOf("ed")===-1&&U1(e);var n=[],s=e.envName.indexOf("at")>-1?"alignat":"align",i=e.envName==="split",a=Ao(e.parser,{cols:n,addJot:!0,autoTag:i?void 0:Q2(e.envName),emptySingleRow:!0,colSeparationType:s,maxNumCols:i?2:void 0,leqno:e.parser.settings.leqno},"display"),o,l=0,c={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&t[0].type==="ordgroup"){for(var h="",d=0;d<t[0].body.length;d++){var f=Ee(t[0].body[d],"textord");h+=f.text}o=Number(h),l=o*2}var p=!l;a.body.forEach(function(y){for(var b=1;b<y.length;b+=2){var _=Ee(y[b],"styling"),C=Ee(_.body[0],"ordgroup");C.body.unshift(c)}if(p)l<y.length&&(l=y.length);else{var R=y.length/2;if(o<R)throw new U("Too many math in a row: "+("expected "+o+", but got "+R),y[0])}});for(var g=0;g<l;++g){var w="r",x=0;g%2===1?w="l":g>0&&p&&(x=1),n[g]={type:"align",align:w,pregap:x,postgap:0}}return a.colSeparationType=p?"align":"alignat",a};ii({type:"array",names:["array","darray"],props:{numArgs:1},handler(r,e){var t=B1(e[0]),n=t?[e[0]]:Ee(e[0],"ordgroup").body,s=n.map(function(a){var o=G2(a),l=o.text;if("lcr".indexOf(l)!==-1)return{type:"align",align:l};if(l==="|")return{type:"separator",separator:"|"};if(l===":")return{type:"separator",separator:":"};throw new U("Unknown column alignment: "+l,a)}),i={cols:s,hskipBeforeAndAfter:!0,maxNumCols:s.length};return Ao(r.parser,i,J2(r.envName))},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(r){var e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[r.envName.replace("*","")],t="c",n={hskipBeforeAndAfter:!1,cols:[{type:"align",align:t}]};if(r.envName.charAt(r.envName.length-1)==="*"){var s=r.parser;if(s.consumeSpaces(),s.fetch().text==="["){if(s.consume(),s.consumeSpaces(),t=s.fetch().text,"lcr".indexOf(t)===-1)throw new U("Expected l or c or r",s.nextToken);s.consume(),s.consumeSpaces(),s.expect("]"),s.consume(),n.cols=[{type:"align",align:t}]}}var i=Ao(r.parser,n,J2(r.envName)),a=Math.max(0,...i.body.map(o=>o.length));return i.cols=new Array(a).fill({type:"align",align:t}),e?{type:"leftright",mode:r.mode,body:[i],left:e[0],right:e[1],rightColor:void 0}:i},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(r){var e={arraystretch:.5},t=Ao(r.parser,e,"script");return t.colSeparationType="small",t},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["subarray"],props:{numArgs:1},handler(r,e){var t=B1(e[0]),n=t?[e[0]]:Ee(e[0],"ordgroup").body,s=n.map(function(a){var o=G2(a),l=o.text;if("lc".indexOf(l)!==-1)return{type:"align",align:l};throw new U("Unknown column alignment: "+l,a)});if(s.length>1)throw new U("{subarray} can contain only one column");var i={cols:s,hskipBeforeAndAfter:!1,arraystretch:.5};if(i=Ao(r.parser,i,"script"),i.body.length>0&&i.body[0].length>1)throw new U("{subarray} can contain only one column");return i},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(r){var e={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},t=Ao(r.parser,e,J2(r.envName));return{type:"leftright",mode:r.mode,body:[t],left:r.envName.indexOf("r")>-1?".":"\\{",right:r.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:lx,htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(r){["gather","gather*"].includes(r.envName)&&U1(r);var e={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:Q2(r.envName),emptySingleRow:!0,leqno:r.parser.settings.leqno};return Ao(r.parser,e,"display")},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:lx,htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(r){U1(r);var e={autoTag:Q2(r.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:r.parser.settings.leqno};return Ao(r.parser,e,"display")},htmlBuilder:ai,mathmlBuilder:oi});ii({type:"array",names:["CD"],props:{numArgs:0},handler(r){return U1(r),bM(r.parser)},htmlBuilder:ai,mathmlBuilder:oi});T("\\nonumber","\\gdef\\@eqnsw{0}");T("\\notag","\\nonumber");Y({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(r,e){throw new U(r.funcName+" valid only within array environment")}});var Ww=ax;Y({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(r,e){var{parser:t,funcName:n}=r,s=e[0];if(s.type!=="ordgroup")throw new U("Invalid environment name",s);for(var i="",a=0;a<s.body.length;++a)i+=Ee(s.body[a],"textord").text;if(n==="\\begin"){if(!Ww.hasOwnProperty(i))throw new U("No such environment: "+i,s);var o=Ww[i],{args:l,optArgs:c}=t.parseArguments("\\begin{"+i+"}",o),h={mode:t.mode,envName:i,parser:t},d=o.handler(h,l,c);t.expect("\\end",!1);var f=t.nextToken,p=Ee(t.parseFunction(),"environment");if(p.name!==i)throw new U("Mismatch: \\begin{"+i+"} matched by \\end{"+p.name+"}",f);return d}return{type:"environment",mode:t.mode,name:i,nameGroup:s}}});var ux=(r,e)=>{var t=r.font,n=e.withFont(t);return Le(r.body,n)},cx=(r,e)=>{var t=r.font,n=e.withFont(t);return Xe(r.body,n)},Kw={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};Y({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=Vm(e[0]),i=n;return i in Kw&&(i=Kw[i]),{type:"font",mode:t.mode,font:i.slice(1),body:s}},htmlBuilder:ux,mathmlBuilder:cx});Y({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(r,e)=>{var{parser:t}=r,n=e[0],s=Fe.isCharacterBox(n);return{type:"mclass",mode:t.mode,mclass:j1(n),body:[{type:"font",mode:t.mode,font:"boldsymbol",body:n}],isCharacterBox:s}}});Y({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(r,e)=>{var{parser:t,funcName:n,breakOnTokenText:s}=r,{mode:i}=t,a=t.parseExpression(!0,s),o="math"+n.slice(1);return{type:"font",mode:i,font:o,body:{type:"ordgroup",mode:t.mode,body:a}}},htmlBuilder:ux,mathmlBuilder:cx});var hx=(r,e)=>{var t=e;return r==="display"?t=t.id>=pe.SCRIPT.id?t.text():pe.DISPLAY:r==="text"&&t.size===pe.DISPLAY.size?t=pe.TEXT:r==="script"?t=pe.SCRIPT:r==="scriptscript"&&(t=pe.SCRIPTSCRIPT),t},Z2=(r,e)=>{var t=hx(r.size,e.style),n=t.fracNum(),s=t.fracDen(),i;i=e.havingStyle(n);var a=Le(r.numer,i,e);if(r.continued){var o=8.5/e.fontMetrics().ptPerEm,l=3.5/e.fontMetrics().ptPerEm;a.height=a.height<o?o:a.height,a.depth=a.depth<l?l:a.depth}i=e.havingStyle(s);var c=Le(r.denom,i,e),h,d,f;r.hasBarLine?(r.barSize?(d=mt(r.barSize,e),h=L.makeLineSpan("frac-line",e,d)):h=L.makeLineSpan("frac-line",e),d=h.height,f=h.height):(h=null,d=0,f=e.fontMetrics().defaultRuleThickness);var p,g,w;t.size===pe.DISPLAY.size||r.size==="display"?(p=e.fontMetrics().num1,d>0?g=3*f:g=7*f,w=e.fontMetrics().denom1):(d>0?(p=e.fontMetrics().num2,g=f):(p=e.fontMetrics().num3,g=3*f),w=e.fontMetrics().denom2);var x;if(h){var b=e.fontMetrics().axisHeight;p-a.depth-(b+.5*d)<g&&(p+=g-(p-a.depth-(b+.5*d))),b-.5*d-(c.height-w)<g&&(w+=g-(b-.5*d-(c.height-w)));var _=-(b-.5*d);x=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:w},{type:"elem",elem:h,shift:_},{type:"elem",elem:a,shift:-p}]},e)}else{var y=p-a.depth-(c.height-w);y<g&&(p+=.5*(g-y),w+=.5*(g-y)),x=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:w},{type:"elem",elem:a,shift:-p}]},e)}i=e.havingStyle(t),x.height*=i.sizeMultiplier/e.sizeMultiplier,x.depth*=i.sizeMultiplier/e.sizeMultiplier;var C;t.size===pe.DISPLAY.size?C=e.fontMetrics().delim1:t.size===pe.SCRIPTSCRIPT.size?C=e.havingStyle(pe.SCRIPT).fontMetrics().delim2:C=e.fontMetrics().delim2;var R,I;return r.leftDelim==null?R=$0(e,["mopen"]):R=Xi.customSizedDelim(r.leftDelim,C,!0,e.havingStyle(t),r.mode,["mopen"]),r.continued?I=L.makeSpan([]):r.rightDelim==null?I=$0(e,["mclose"]):I=Xi.customSizedDelim(r.rightDelim,C,!0,e.havingStyle(t),r.mode,["mclose"]),L.makeSpan(["mord"].concat(i.sizingClasses(e)),[R,L.makeSpan(["mfrac"],[x]),I],e)},e3=(r,e)=>{var t=new $.MathNode("mfrac",[Xe(r.numer,e),Xe(r.denom,e)]);if(!r.hasBarLine)t.setAttribute("linethickness","0px");else if(r.barSize){var n=mt(r.barSize,e);t.setAttribute("linethickness",G(n))}var s=hx(r.size,e.style);if(s.size!==e.style.size){t=new $.MathNode("mstyle",[t]);var i=s.size===pe.DISPLAY.size?"true":"false";t.setAttribute("displaystyle",i),t.setAttribute("scriptlevel","0")}if(r.leftDelim!=null||r.rightDelim!=null){var a=[];if(r.leftDelim!=null){var o=new $.MathNode("mo",[new $.TextNode(r.leftDelim.replace("\\",""))]);o.setAttribute("fence","true"),a.push(o)}if(a.push(t),r.rightDelim!=null){var l=new $.MathNode("mo",[new $.TextNode(r.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),a.push(l)}return q2(a)}return t};Y({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0],i=e[1],a,o=null,l=null,c="auto";switch(n){case"\\dfrac":case"\\frac":case"\\tfrac":a=!0;break;case"\\\\atopfrac":a=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":a=!1,o="(",l=")";break;case"\\\\bracefrac":a=!1,o="\\{",l="\\}";break;case"\\\\brackfrac":a=!1,o="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(n){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text";break}return{type:"genfrac",mode:t.mode,continued:!1,numer:s,denom:i,hasBarLine:a,leftDelim:o,rightDelim:l,size:c,barSize:null}},htmlBuilder:Z2,mathmlBuilder:e3});Y({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0],i=e[1];return{type:"genfrac",mode:t.mode,continued:!0,numer:s,denom:i,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});Y({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(r){var{parser:e,funcName:t,token:n}=r,s;switch(t){case"\\over":s="\\frac";break;case"\\choose":s="\\binom";break;case"\\atop":s="\\\\atopfrac";break;case"\\brace":s="\\\\bracefrac";break;case"\\brack":s="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:s,token:n}}});var Xw=["display","text","script","scriptscript"],Yw=function(e){var t=null;return e.length>0&&(t=e,t=t==="."?null:t),t};Y({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(r,e){var{parser:t}=r,n=e[4],s=e[5],i=Vm(e[0]),a=i.type==="atom"&&i.family==="open"?Yw(i.text):null,o=Vm(e[1]),l=o.type==="atom"&&o.family==="close"?Yw(o.text):null,c=Ee(e[2],"size"),h,d=null;c.isBlank?h=!0:(d=c.value,h=d.number>0);var f="auto",p=e[3];if(p.type==="ordgroup"){if(p.body.length>0){var g=Ee(p.body[0],"textord");f=Xw[Number(g.text)]}}else p=Ee(p,"textord"),f=Xw[Number(p.text)];return{type:"genfrac",mode:t.mode,numer:n,denom:s,continued:!1,hasBarLine:h,barSize:d,leftDelim:a,rightDelim:l,size:f}},htmlBuilder:Z2,mathmlBuilder:e3});Y({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(r,e){var{parser:t,funcName:n,token:s}=r;return{type:"infix",mode:t.mode,replaceWith:"\\\\abovefrac",size:Ee(e[0],"size").value,token:s}}});Y({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0],i=cP(Ee(e[1],"infix").size),a=e[2],o=i.number>0;return{type:"genfrac",mode:t.mode,numer:s,denom:a,continued:!1,hasBarLine:o,barSize:i,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:Z2,mathmlBuilder:e3});var dx=(r,e)=>{var t=e.style,n,s;r.type==="supsub"?(n=r.sup?Le(r.sup,e.havingStyle(t.sup()),e):Le(r.sub,e.havingStyle(t.sub()),e),s=Ee(r.base,"horizBrace")):s=Ee(r,"horizBrace");var i=Le(s.base,e.havingBaseStyle(pe.DISPLAY)),a=sa.svgSpan(s,e),o;if(s.isOver?(o=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:.1},{type:"elem",elem:a}]},e),o.children[0].children[0].children[1].classes.push("svg-align")):(o=L.makeVList({positionType:"bottom",positionData:i.depth+.1+a.height,children:[{type:"elem",elem:a},{type:"kern",size:.1},{type:"elem",elem:i}]},e),o.children[0].children[0].children[0].classes.push("svg-align")),n){var l=L.makeSpan(["mord",s.isOver?"mover":"munder"],[o],e);s.isOver?o=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:n}]},e):o=L.makeVList({positionType:"bottom",positionData:l.depth+.2+n.height+n.depth,children:[{type:"elem",elem:n},{type:"kern",size:.2},{type:"elem",elem:l}]},e)}return L.makeSpan(["mord",s.isOver?"mover":"munder"],[o],e)},LM=(r,e)=>{var t=sa.mathMLnode(r.label);return new $.MathNode(r.isOver?"mover":"munder",[Xe(r.base,e),t])};Y({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(r,e){var{parser:t,funcName:n}=r;return{type:"horizBrace",mode:t.mode,label:n,isOver:/^\\over/.test(n),base:e[0]}},htmlBuilder:dx,mathmlBuilder:LM});Y({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(r,e)=>{var{parser:t}=r,n=e[1],s=Ee(e[0],"url").url;return t.settings.isTrusted({command:"\\href",url:s})?{type:"href",mode:t.mode,href:s,body:kt(n)}:t.formatUnsupportedCmd("\\href")},htmlBuilder:(r,e)=>{var t=Ht(r.body,e,!1);return L.makeAnchor(r.href,[],t,e)},mathmlBuilder:(r,e)=>{var t=vo(r.body,e);return t instanceof xn||(t=new xn("mrow",[t])),t.setAttribute("href",r.href),t}});Y({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(r,e)=>{var{parser:t}=r,n=Ee(e[0],"url").url;if(!t.settings.isTrusted({command:"\\url",url:n}))return t.formatUnsupportedCmd("\\url");for(var s=[],i=0;i<n.length;i++){var a=n[i];a==="~"&&(a="\\textasciitilde"),s.push({type:"textord",mode:"text",text:a})}var o={type:"text",mode:t.mode,font:"\\texttt",body:s};return{type:"href",mode:t.mode,href:n,body:kt(o)}}});Y({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(r,e){var{parser:t}=r;return{type:"hbox",mode:t.mode,body:kt(e[0])}},htmlBuilder(r,e){var t=Ht(r.body,e,!1);return L.makeFragment(t)},mathmlBuilder(r,e){return new $.MathNode("mrow",rn(r.body,e))}});Y({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(r,e)=>{var{parser:t,funcName:n,token:s}=r,i=Ee(e[0],"raw").string,a=e[1];t.settings.strict&&t.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var o,l={};switch(n){case"\\htmlClass":l.class=i,o={command:"\\htmlClass",class:i};break;case"\\htmlId":l.id=i,o={command:"\\htmlId",id:i};break;case"\\htmlStyle":l.style=i,o={command:"\\htmlStyle",style:i};break;case"\\htmlData":{for(var c=i.split(","),h=0;h<c.length;h++){var d=c[h].split("=");if(d.length!==2)throw new U("Error parsing key-value for \\htmlData");l["data-"+d[0].trim()]=d[1].trim()}o={command:"\\htmlData",attributes:l};break}default:throw new Error("Unrecognized html command")}return t.settings.isTrusted(o)?{type:"html",mode:t.mode,attributes:l,body:kt(a)}:t.formatUnsupportedCmd(n)},htmlBuilder:(r,e)=>{var t=Ht(r.body,e,!1),n=["enclosing"];r.attributes.class&&n.push(...r.attributes.class.trim().split(/\s+/));var s=L.makeSpan(n,t,e);for(var i in r.attributes)i!=="class"&&r.attributes.hasOwnProperty(i)&&s.setAttribute(i,r.attributes[i]);return s},mathmlBuilder:(r,e)=>vo(r.body,e)});Y({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(r,e)=>{var{parser:t}=r;return{type:"htmlmathml",mode:t.mode,html:kt(e[0]),mathml:kt(e[1])}},htmlBuilder:(r,e)=>{var t=Ht(r.html,e,!1);return L.makeFragment(t)},mathmlBuilder:(r,e)=>vo(r.mathml,e)});var Vg=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new U("Invalid size: '"+e+"' in \\includegraphics");var n={number:+(t[1]+t[2]),unit:t[3]};if(!M_(n))throw new U("Invalid unit: '"+n.unit+"' in \\includegraphics.");return n};Y({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(r,e,t)=>{var{parser:n}=r,s={number:0,unit:"em"},i={number:.9,unit:"em"},a={number:0,unit:"em"},o="";if(t[0])for(var l=Ee(t[0],"raw").string,c=l.split(","),h=0;h<c.length;h++){var d=c[h].split("=");if(d.length===2){var f=d[1].trim();switch(d[0].trim()){case"alt":o=f;break;case"width":s=Vg(f);break;case"height":i=Vg(f);break;case"totalheight":a=Vg(f);break;default:throw new U("Invalid key: '"+d[0]+"' in \\includegraphics.")}}}var p=Ee(e[0],"url").url;return o===""&&(o=p,o=o.replace(/^.*[\\/]/,""),o=o.substring(0,o.lastIndexOf("."))),n.settings.isTrusted({command:"\\includegraphics",url:p})?{type:"includegraphics",mode:n.mode,alt:o,width:s,height:i,totalheight:a,src:p}:n.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(r,e)=>{var t=mt(r.height,e),n=0;r.totalheight.number>0&&(n=mt(r.totalheight,e)-t);var s=0;r.width.number>0&&(s=mt(r.width,e));var i={height:G(t+n)};s>0&&(i.width=G(s)),n>0&&(i.verticalAlign=G(-n));var a=new LP(r.src,r.alt,i);return a.height=t,a.depth=n,a},mathmlBuilder:(r,e)=>{var t=new $.MathNode("mglyph",[]);t.setAttribute("alt",r.alt);var n=mt(r.height,e),s=0;if(r.totalheight.number>0&&(s=mt(r.totalheight,e)-n,t.setAttribute("valign",G(-s))),t.setAttribute("height",G(n+s)),r.width.number>0){var i=mt(r.width,e);t.setAttribute("width",G(i))}return t.setAttribute("src",r.src),t}});Y({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(r,e){var{parser:t,funcName:n}=r,s=Ee(e[0],"size");if(t.settings.strict){var i=n[1]==="m",a=s.value.unit==="mu";i?(a||t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" supports only mu units, "+("not "+s.value.unit+" units")),t.mode!=="math"&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" works only in math mode")):a&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" doesn't support mu units")}return{type:"kern",mode:t.mode,dimension:s.value}},htmlBuilder(r,e){return L.makeGlue(r.dimension,e)},mathmlBuilder(r,e){var t=mt(r.dimension,e);return new $.SpaceNode(t)}});Y({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0];return{type:"lap",mode:t.mode,alignment:n.slice(5),body:s}},htmlBuilder:(r,e)=>{var t;r.alignment==="clap"?(t=L.makeSpan([],[Le(r.body,e)]),t=L.makeSpan(["inner"],[t],e)):t=L.makeSpan(["inner"],[Le(r.body,e)]);var n=L.makeSpan(["fix"],[]),s=L.makeSpan([r.alignment],[t,n],e),i=L.makeSpan(["strut"]);return i.style.height=G(s.height+s.depth),s.depth&&(i.style.verticalAlign=G(-s.depth)),s.children.unshift(i),s=L.makeSpan(["thinbox"],[s],e),L.makeSpan(["mord","vbox"],[s],e)},mathmlBuilder:(r,e)=>{var t=new $.MathNode("mpadded",[Xe(r.body,e)]);if(r.alignment!=="rlap"){var n=r.alignment==="llap"?"-1":"-0.5";t.setAttribute("lspace",n+"width")}return t.setAttribute("width","0px"),t}});Y({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(r,e){var{funcName:t,parser:n}=r,s=n.mode;n.switchMode("math");var i=t==="\\("?"\\)":"$",a=n.parseExpression(!1,i);return n.expect(i),n.switchMode(s),{type:"styling",mode:n.mode,style:"text",body:a}}});Y({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(r,e){throw new U("Mismatched "+r.funcName)}});var Qw=(r,e)=>{switch(e.style.size){case pe.DISPLAY.size:return r.display;case pe.TEXT.size:return r.text;case pe.SCRIPT.size:return r.script;case pe.SCRIPTSCRIPT.size:return r.scriptscript;default:return r.text}};Y({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(r,e)=>{var{parser:t}=r;return{type:"mathchoice",mode:t.mode,display:kt(e[0]),text:kt(e[1]),script:kt(e[2]),scriptscript:kt(e[3])}},htmlBuilder:(r,e)=>{var t=Qw(r,e),n=Ht(t,e,!1);return L.makeFragment(n)},mathmlBuilder:(r,e)=>{var t=Qw(r,e);return vo(t,e)}});var fx=(r,e,t,n,s,i,a)=>{r=L.makeSpan([],[r]);var o=t&&Fe.isCharacterBox(t),l,c;if(e){var h=Le(e,n.havingStyle(s.sup()),n);c={elem:h,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-h.depth)}}if(t){var d=Le(t,n.havingStyle(s.sub()),n);l={elem:d,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-d.height)}}var f;if(c&&l){var p=n.fontMetrics().bigOpSpacing5+l.elem.height+l.elem.depth+l.kern+r.depth+a;f=L.makeVList({positionType:"bottom",positionData:p,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:G(-i)},{type:"kern",size:l.kern},{type:"elem",elem:r},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:G(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(l){var g=r.height-a;f=L.makeVList({positionType:"top",positionData:g,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:G(-i)},{type:"kern",size:l.kern},{type:"elem",elem:r}]},n)}else if(c){var w=r.depth+a;f=L.makeVList({positionType:"bottom",positionData:w,children:[{type:"elem",elem:r},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:G(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else return r;var x=[f];if(l&&i!==0&&!o){var y=L.makeSpan(["mspace"],[],n);y.style.marginRight=G(i),x.unshift(y)}return L.makeSpan(["mop","op-limits"],x,n)},px=["\\smallint"],yh=(r,e)=>{var t,n,s=!1,i;r.type==="supsub"?(t=r.sup,n=r.sub,i=Ee(r.base,"op"),s=!0):i=Ee(r,"op");var a=e.style,o=!1;a.size===pe.DISPLAY.size&&i.symbol&&!px.includes(i.name)&&(o=!0);var l;if(i.symbol){var c=o?"Size2-Regular":"Size1-Regular",h="";if((i.name==="\\oiint"||i.name==="\\oiiint")&&(h=i.name.slice(1),i.name=h==="oiint"?"\\iint":"\\iiint"),l=L.makeSymbol(i.name,c,"math",e,["mop","op-symbol",o?"large-op":"small-op"]),h.length>0){var d=l.italic,f=L.staticSvg(h+"Size"+(o?"2":"1"),e);l=L.makeVList({positionType:"individualShift",children:[{type:"elem",elem:l,shift:0},{type:"elem",elem:f,shift:o?.08:0}]},e),i.name="\\"+h,l.classes.unshift("mop"),l.italic=d}}else if(i.body){var p=Ht(i.body,e,!0);p.length===1&&p[0]instanceof Qn?(l=p[0],l.classes[0]="mop"):l=L.makeSpan(["mop"],p,e)}else{for(var g=[],w=1;w<i.name.length;w++)g.push(L.mathsym(i.name[w],i.mode,e));l=L.makeSpan(["mop"],g,e)}var x=0,y=0;return(l instanceof Qn||i.name==="\\oiint"||i.name==="\\oiiint")&&!i.suppressBaseShift&&(x=(l.height-l.depth)/2-e.fontMetrics().axisHeight,y=l.italic),s?fx(l,t,n,e,a,y,x):(x&&(l.style.position="relative",l.style.top=G(x)),l)},kf=(r,e)=>{var t;if(r.symbol)t=new xn("mo",[Jn(r.name,r.mode)]),px.includes(r.name)&&t.setAttribute("largeop","false");else if(r.body)t=new xn("mo",rn(r.body,e));else{t=new xn("mi",[new ti(r.name.slice(1))]);var n=new xn("mo",[Jn("","text")]);r.parentIsSupSub?t=new xn("mrow",[t,n]):t=U_([t,n])}return t},DM={"":"\\prod","":"\\coprod","":"\\sum","":"\\bigwedge","":"\\bigvee","":"\\bigcap","":"\\bigcup","":"\\bigodot","":"\\bigoplus","":"\\bigotimes","":"\\biguplus","":"\\bigsqcup"};Y({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","","","","","","","","","","","",""],props:{numArgs:0},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=n;return s.length===1&&(s=DM[s]),{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:s}},htmlBuilder:yh,mathmlBuilder:kf});Y({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var{parser:t}=r,n=e[0];return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:kt(n)}},htmlBuilder:yh,mathmlBuilder:kf});var FM={"":"\\int","":"\\iint","":"\\iiint","":"\\oint","":"\\oiint","":"\\oiiint"};Y({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(r){var{parser:e,funcName:t}=r;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:yh,mathmlBuilder:kf});Y({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(r){var{parser:e,funcName:t}=r;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:yh,mathmlBuilder:kf});Y({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","","","","","",""],props:{numArgs:0},handler(r){var{parser:e,funcName:t}=r,n=t;return n.length===1&&(n=FM[n]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:yh,mathmlBuilder:kf});var mx=(r,e)=>{var t,n,s=!1,i;r.type==="supsub"?(t=r.sup,n=r.sub,i=Ee(r.base,"operatorname"),s=!0):i=Ee(r,"operatorname");var a;if(i.body.length>0){for(var o=i.body.map(d=>{var f=d.text;return typeof f=="string"?{type:"textord",mode:d.mode,text:f}:d}),l=Ht(o,e.withFont("mathrm"),!0),c=0;c<l.length;c++){var h=l[c];h instanceof Qn&&(h.text=h.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}a=L.makeSpan(["mop"],l,e)}else a=L.makeSpan(["mop"],[],e);return s?fx(a,t,n,e,e.style,0,0):a},zM=(r,e)=>{for(var t=rn(r.body,e.withFont("mathrm")),n=!0,s=0;s<t.length;s++){var i=t[s];if(!(i instanceof $.SpaceNode))if(i instanceof $.MathNode)switch(i.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var a=i.children[0];i.children.length===1&&a instanceof $.TextNode?a.text=a.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break}default:n=!1}else n=!1}if(n){var o=t.map(h=>h.toText()).join("");t=[new $.TextNode(o)]}var l=new $.MathNode("mi",t);l.setAttribute("mathvariant","normal");var c=new $.MathNode("mo",[Jn("","text")]);return r.parentIsSupSub?new $.MathNode("mrow",[l,c]):$.newDocumentFragment([l,c])};Y({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(r,e)=>{var{parser:t,funcName:n}=r,s=e[0];return{type:"operatorname",mode:t.mode,body:kt(s),alwaysHandleSupSub:n==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:mx,mathmlBuilder:zM});T("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");uu({type:"ordgroup",htmlBuilder(r,e){return r.semisimple?L.makeFragment(Ht(r.body,e,!1)):L.makeSpan(["mord"],Ht(r.body,e,!0),e)},mathmlBuilder(r,e){return vo(r.body,e,!0)}});Y({type:"overline",names:["\\overline"],props:{numArgs:1},handler(r,e){var{parser:t}=r,n=e[0];return{type:"overline",mode:t.mode,body:n}},htmlBuilder(r,e){var t=Le(r.body,e.havingCrampedStyle()),n=L.makeLineSpan("overline-line",e),s=e.fontMetrics().defaultRuleThickness,i=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t},{type:"kern",size:3*s},{type:"elem",elem:n},{type:"kern",size:s}]},e);return L.makeSpan(["mord","overline"],[i],e)},mathmlBuilder(r,e){var t=new $.MathNode("mo",[new $.TextNode("")]);t.setAttribute("stretchy","true");var n=new $.MathNode("mover",[Xe(r.body,e),t]);return n.setAttribute("accent","true"),n}});Y({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:t}=r,n=e[0];return{type:"phantom",mode:t.mode,body:kt(n)}},htmlBuilder:(r,e)=>{var t=Ht(r.body,e.withPhantom(),!1);return L.makeFragment(t)},mathmlBuilder:(r,e)=>{var t=rn(r.body,e);return new $.MathNode("mphantom",t)}});Y({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:t}=r,n=e[0];return{type:"hphantom",mode:t.mode,body:n}},htmlBuilder:(r,e)=>{var t=L.makeSpan([],[Le(r.body,e.withPhantom())]);if(t.height=0,t.depth=0,t.children)for(var n=0;n<t.children.length;n++)t.children[n].height=0,t.children[n].depth=0;return t=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e),L.makeSpan(["mord"],[t],e)},mathmlBuilder:(r,e)=>{var t=rn(kt(r.body),e),n=new $.MathNode("mphantom",t),s=new $.MathNode("mpadded",[n]);return s.setAttribute("height","0px"),s.setAttribute("depth","0px"),s}});Y({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:t}=r,n=e[0];return{type:"vphantom",mode:t.mode,body:n}},htmlBuilder:(r,e)=>{var t=L.makeSpan(["inner"],[Le(r.body,e.withPhantom())]),n=L.makeSpan(["fix"],[]);return L.makeSpan(["mord","rlap"],[t,n],e)},mathmlBuilder:(r,e)=>{var t=rn(kt(r.body),e),n=new $.MathNode("mphantom",t),s=new $.MathNode("mpadded",[n]);return s.setAttribute("width","0px"),s}});Y({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(r,e){var{parser:t}=r,n=Ee(e[0],"size").value,s=e[1];return{type:"raisebox",mode:t.mode,dy:n,body:s}},htmlBuilder(r,e){var t=Le(r.body,e),n=mt(r.dy,e);return L.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(r,e){var t=new $.MathNode("mpadded",[Xe(r.body,e)]),n=r.dy.number+r.dy.unit;return t.setAttribute("voffset",n),t}});Y({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(r){var{parser:e}=r;return{type:"internal",mode:e.mode}}});Y({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(r,e,t){var{parser:n}=r,s=t[0],i=Ee(e[0],"size"),a=Ee(e[1],"size");return{type:"rule",mode:n.mode,shift:s&&Ee(s,"size").value,width:i.value,height:a.value}},htmlBuilder(r,e){var t=L.makeSpan(["mord","rule"],[],e),n=mt(r.width,e),s=mt(r.height,e),i=r.shift?mt(r.shift,e):0;return t.style.borderRightWidth=G(n),t.style.borderTopWidth=G(s),t.style.bottom=G(i),t.width=n,t.height=s+i,t.depth=-i,t.maxFontSize=s*1.125*e.sizeMultiplier,t},mathmlBuilder(r,e){var t=mt(r.width,e),n=mt(r.height,e),s=r.shift?mt(r.shift,e):0,i=e.color&&e.getColor()||"black",a=new $.MathNode("mspace");a.setAttribute("mathbackground",i),a.setAttribute("width",G(t)),a.setAttribute("height",G(n));var o=new $.MathNode("mpadded",[a]);return s>=0?o.setAttribute("height",G(s)):(o.setAttribute("height",G(s)),o.setAttribute("depth",G(-s))),o.setAttribute("voffset",G(s)),o}});function gx(r,e,t){for(var n=Ht(r,e,!1),s=e.sizeMultiplier/t.sizeMultiplier,i=0;i<n.length;i++){var a=n[i].classes.indexOf("sizing");a<0?Array.prototype.push.apply(n[i].classes,e.sizingClasses(t)):n[i].classes[a+1]==="reset-size"+e.size&&(n[i].classes[a+1]="reset-size"+t.size),n[i].height*=s,n[i].depth*=s}return L.makeFragment(n)}var Jw=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],BM=(r,e)=>{var t=e.havingSize(r.size);return gx(r.body,t,e)};Y({type:"sizing",names:Jw,props:{numArgs:0,allowedInText:!0},handler:(r,e)=>{var{breakOnTokenText:t,funcName:n,parser:s}=r,i=s.parseExpression(!1,t);return{type:"sizing",mode:s.mode,size:Jw.indexOf(n)+1,body:i}},htmlBuilder:BM,mathmlBuilder:(r,e)=>{var t=e.havingSize(r.size),n=rn(r.body,t),s=new $.MathNode("mstyle",n);return s.setAttribute("mathsize",G(t.sizeMultiplier)),s}});Y({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(r,e,t)=>{var{parser:n}=r,s=!1,i=!1,a=t[0]&&Ee(t[0],"ordgroup");if(a)for(var o="",l=0;l<a.body.length;++l){var c=a.body[l];if(o=c.text,o==="t")s=!0;else if(o==="b")i=!0;else{s=!1,i=!1;break}}else s=!0,i=!0;var h=e[0];return{type:"smash",mode:n.mode,body:h,smashHeight:s,smashDepth:i}},htmlBuilder:(r,e)=>{var t=L.makeSpan([],[Le(r.body,e)]);if(!r.smashHeight&&!r.smashDepth)return t;if(r.smashHeight&&(t.height=0,t.children))for(var n=0;n<t.children.length;n++)t.children[n].height=0;if(r.smashDepth&&(t.depth=0,t.children))for(var s=0;s<t.children.length;s++)t.children[s].depth=0;var i=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e);return L.makeSpan(["mord"],[i],e)},mathmlBuilder:(r,e)=>{var t=new $.MathNode("mpadded",[Xe(r.body,e)]);return r.smashHeight&&t.setAttribute("height","0px"),r.smashDepth&&t.setAttribute("depth","0px"),t}});Y({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(r,e,t){var{parser:n}=r,s=t[0],i=e[0];return{type:"sqrt",mode:n.mode,body:i,index:s}},htmlBuilder(r,e){var t=Le(r.body,e.havingCrampedStyle());t.height===0&&(t.height=e.fontMetrics().xHeight),t=L.wrapFragment(t,e);var n=e.fontMetrics(),s=n.defaultRuleThickness,i=s;e.style.id<pe.TEXT.id&&(i=e.fontMetrics().xHeight);var a=s+i/4,o=t.height+t.depth+a+s,{span:l,ruleWidth:c,advanceWidth:h}=Xi.sqrtImage(o,e),d=l.height-c;d>t.height+t.depth+a&&(a=(a+d-t.height-t.depth)/2);var f=l.height-t.height-a-c;t.style.paddingLeft=G(h);var p=L.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t,wrapperClasses:["svg-align"]},{type:"kern",size:-(t.height+f)},{type:"elem",elem:l},{type:"kern",size:c}]},e);if(r.index){var g=e.havingStyle(pe.SCRIPTSCRIPT),w=Le(r.index,g,e),x=.6*(p.height-p.depth),y=L.makeVList({positionType:"shift",positionData:-x,children:[{type:"elem",elem:w}]},e),b=L.makeSpan(["root"],[y]);return L.makeSpan(["mord","sqrt"],[b,p],e)}else return L.makeSpan(["mord","sqrt"],[p],e)},mathmlBuilder(r,e){var{body:t,index:n}=r;return n?new $.MathNode("mroot",[Xe(t,e),Xe(n,e)]):new $.MathNode("msqrt",[Xe(t,e)])}});var Zw={display:pe.DISPLAY,text:pe.TEXT,script:pe.SCRIPT,scriptscript:pe.SCRIPTSCRIPT};Y({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r,e){var{breakOnTokenText:t,funcName:n,parser:s}=r,i=s.parseExpression(!0,t),a=n.slice(1,n.length-5);return{type:"styling",mode:s.mode,style:a,body:i}},htmlBuilder(r,e){var t=Zw[r.style],n=e.havingStyle(t).withFont("");return gx(r.body,n,e)},mathmlBuilder(r,e){var t=Zw[r.style],n=e.havingStyle(t),s=rn(r.body,n),i=new $.MathNode("mstyle",s),a={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},o=a[r.style];return i.setAttribute("scriptlevel",o[0]),i.setAttribute("displaystyle",o[1]),i}});var jM=function(e,t){var n=e.base;if(n)if(n.type==="op"){var s=n.limits&&(t.style.size===pe.DISPLAY.size||n.alwaysHandleSupSub);return s?yh:null}else if(n.type==="operatorname"){var i=n.alwaysHandleSupSub&&(t.style.size===pe.DISPLAY.size||n.limits);return i?mx:null}else{if(n.type==="accent")return Fe.isCharacterBox(n.base)?W2:null;if(n.type==="horizBrace"){var a=!e.sub;return a===n.isOver?dx:null}else return null}else return null};uu({type:"supsub",htmlBuilder(r,e){var t=jM(r,e);if(t)return t(r,e);var{base:n,sup:s,sub:i}=r,a=Le(n,e),o,l,c=e.fontMetrics(),h=0,d=0,f=n&&Fe.isCharacterBox(n);if(s){var p=e.havingStyle(e.style.sup());o=Le(s,p,e),f||(h=a.height-p.fontMetrics().supDrop*p.sizeMultiplier/e.sizeMultiplier)}if(i){var g=e.havingStyle(e.style.sub());l=Le(i,g,e),f||(d=a.depth+g.fontMetrics().subDrop*g.sizeMultiplier/e.sizeMultiplier)}var w;e.style===pe.DISPLAY?w=c.sup1:e.style.cramped?w=c.sup3:w=c.sup2;var x=e.sizeMultiplier,y=G(.5/c.ptPerEm/x),b=null;if(l){var _=r.base&&r.base.type==="op"&&r.base.name&&(r.base.name==="\\oiint"||r.base.name==="\\oiiint");(a instanceof Qn||_)&&(b=G(-a.italic))}var C;if(o&&l){h=Math.max(h,w,o.depth+.25*c.xHeight),d=Math.max(d,c.sub2);var R=c.defaultRuleThickness,I=4*R;if(h-o.depth-(l.height-d)<I){d=I-(h-o.depth)+l.height;var O=.8*c.xHeight-(h-o.depth);O>0&&(h+=O,d-=O)}var D=[{type:"elem",elem:l,shift:d,marginRight:y,marginLeft:b},{type:"elem",elem:o,shift:-h,marginRight:y}];C=L.makeVList({positionType:"individualShift",children:D},e)}else if(l){d=Math.max(d,c.sub1,l.height-.8*c.xHeight);var B=[{type:"elem",elem:l,marginLeft:b,marginRight:y}];C=L.makeVList({positionType:"shift",positionData:d,children:B},e)}else if(o)h=Math.max(h,w,o.depth+.25*c.xHeight),C=L.makeVList({positionType:"shift",positionData:-h,children:[{type:"elem",elem:o,marginRight:y}]},e);else throw new Error("supsub must have either sup or sub.");var q=by(a,"right")||"mord";return L.makeSpan([q],[a,L.makeSpan(["msupsub"],[C])],e)},mathmlBuilder(r,e){var t=!1,n,s;r.base&&r.base.type==="horizBrace"&&(s=!!r.sup,s===r.base.isOver&&(t=!0,n=r.base.isOver)),r.base&&(r.base.type==="op"||r.base.type==="operatorname")&&(r.base.parentIsSupSub=!0);var i=[Xe(r.base,e)];r.sub&&i.push(Xe(r.sub,e)),r.sup&&i.push(Xe(r.sup,e));var a;if(t)a=n?"mover":"munder";else if(r.sub)if(r.sup){var c=r.base;c&&c.type==="op"&&c.limits&&e.style===pe.DISPLAY||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(e.style===pe.DISPLAY||c.limits)?a="munderover":a="msubsup"}else{var l=r.base;l&&l.type==="op"&&l.limits&&(e.style===pe.DISPLAY||l.alwaysHandleSupSub)||l&&l.type==="operatorname"&&l.alwaysHandleSupSub&&(l.limits||e.style===pe.DISPLAY)?a="munder":a="msub"}else{var o=r.base;o&&o.type==="op"&&o.limits&&(e.style===pe.DISPLAY||o.alwaysHandleSupSub)||o&&o.type==="operatorname"&&o.alwaysHandleSupSub&&(o.limits||e.style===pe.DISPLAY)?a="mover":a="msup"}return new $.MathNode(a,i)}});uu({type:"atom",htmlBuilder(r,e){return L.mathsym(r.text,r.mode,e,["m"+r.family])},mathmlBuilder(r,e){var t=new $.MathNode("mo",[Jn(r.text,r.mode)]);if(r.family==="bin"){var n=V2(r,e);n==="bold-italic"&&t.setAttribute("mathvariant",n)}else r.family==="punct"?t.setAttribute("separator","true"):(r.family==="open"||r.family==="close")&&t.setAttribute("stretchy","false");return t}});var vx={mi:"italic",mn:"normal",mtext:"normal"};uu({type:"mathord",htmlBuilder(r,e){return L.makeOrd(r,e,"mathord")},mathmlBuilder(r,e){var t=new $.MathNode("mi",[Jn(r.text,r.mode,e)]),n=V2(r,e)||"italic";return n!==vx[t.type]&&t.setAttribute("mathvariant",n),t}});uu({type:"textord",htmlBuilder(r,e){return L.makeOrd(r,e,"textord")},mathmlBuilder(r,e){var t=Jn(r.text,r.mode,e),n=V2(r,e)||"normal",s;return r.mode==="text"?s=new $.MathNode("mtext",[t]):/[0-9]/.test(r.text)?s=new $.MathNode("mn",[t]):r.text==="\\prime"?s=new $.MathNode("mo",[t]):s=new $.MathNode("mi",[t]),n!==vx[s.type]&&s.setAttribute("mathvariant",n),s}});var Gg={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Wg={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};uu({type:"spacing",htmlBuilder(r,e){if(Wg.hasOwnProperty(r.text)){var t=Wg[r.text].className||"";if(r.mode==="text"){var n=L.makeOrd(r,e,"textord");return n.classes.push(t),n}else return L.makeSpan(["mspace",t],[L.mathsym(r.text,r.mode,e)],e)}else{if(Gg.hasOwnProperty(r.text))return L.makeSpan(["mspace",Gg[r.text]],[],e);throw new U('Unknown type of space "'+r.text+'"')}},mathmlBuilder(r,e){var t;if(Wg.hasOwnProperty(r.text))t=new $.MathNode("mtext",[new $.TextNode("")]);else{if(Gg.hasOwnProperty(r.text))return new $.MathNode("mspace");throw new U('Unknown type of space "'+r.text+'"')}return t}});var e6=()=>{var r=new $.MathNode("mtd",[]);return r.setAttribute("width","50%"),r};uu({type:"tag",mathmlBuilder(r,e){var t=new $.MathNode("mtable",[new $.MathNode("mtr",[e6(),new $.MathNode("mtd",[vo(r.body,e)]),e6(),new $.MathNode("mtd",[vo(r.tag,e)])])]);return t.setAttribute("width","100%"),t}});var t6={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},r6={"\\textbf":"textbf","\\textmd":"textmd"},$M={"\\textit":"textit","\\textup":"textup"},n6=(r,e)=>{var t=r.font;if(t){if(t6[t])return e.withTextFontFamily(t6[t]);if(r6[t])return e.withTextFontWeight(r6[t]);if(t==="\\emph")return e.fontShape==="textit"?e.withTextFontShape("textup"):e.withTextFontShape("textit")}else return e;return e.withTextFontShape($M[t])};Y({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(r,e){var{parser:t,funcName:n}=r,s=e[0];return{type:"text",mode:t.mode,body:kt(s),font:n}},htmlBuilder(r,e){var t=n6(r,e),n=Ht(r.body,t,!0);return L.makeSpan(["mord","text"],n,t)},mathmlBuilder(r,e){var t=n6(r,e);return vo(r.body,t)}});Y({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(r,e){var{parser:t}=r;return{type:"underline",mode:t.mode,body:e[0]}},htmlBuilder(r,e){var t=Le(r.body,e),n=L.makeLineSpan("underline-line",e),s=e.fontMetrics().defaultRuleThickness,i=L.makeVList({positionType:"top",positionData:t.height,children:[{type:"kern",size:s},{type:"elem",elem:n},{type:"kern",size:3*s},{type:"elem",elem:t}]},e);return L.makeSpan(["mord","underline"],[i],e)},mathmlBuilder(r,e){var t=new $.MathNode("mo",[new $.TextNode("")]);t.setAttribute("stretchy","true");var n=new $.MathNode("munder",[Xe(r.body,e),t]);return n.setAttribute("accentunder","true"),n}});Y({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(r,e){var{parser:t}=r;return{type:"vcenter",mode:t.mode,body:e[0]}},htmlBuilder(r,e){var t=Le(r.body,e),n=e.fontMetrics().axisHeight,s=.5*(t.height-n-(t.depth+n));return L.makeVList({positionType:"shift",positionData:s,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(r,e){return new $.MathNode("mpadded",[Xe(r.body,e)],["vcenter"])}});Y({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(r,e,t){throw new U("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(r,e){for(var t=s6(r),n=[],s=e.havingStyle(e.style.text()),i=0;i<t.length;i++){var a=t[i];a==="~"&&(a="\\textasciitilde"),n.push(L.makeSymbol(a,"Typewriter-Regular",r.mode,s,["mord","texttt"]))}return L.makeSpan(["mord","text"].concat(s.sizingClasses(e)),L.tryCombineChars(n),s)},mathmlBuilder(r,e){var t=new $.TextNode(s6(r)),n=new $.MathNode("mtext",[t]);return n.setAttribute("mathvariant","monospace"),n}});var s6=r=>r.body.replace(/ /g,r.star?"":""),Za=j_,yx=`[ \r
	]`,UM="\\\\[a-zA-Z@]+",HM="\\\\[^\uD800-\uDFFF]",qM="("+UM+")"+yx+"*",VM=`\\\\(
|[ \r	]+
?)[ \r	]*`,Ay="[-]",GM=new RegExp(Ay+"+$"),WM="("+yx+"+)|"+(VM+"|")+"([!-\\[\\]---]"+(Ay+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(Ay+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+qM)+("|"+HM+")");class i6{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(WM,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){var e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new kn("EOF",new Xr(this,t,t));var n=this.tokenRegex.exec(e);if(n===null||n.index!==t)throw new U("Unexpected character: '"+e[t]+"'",new kn(e[t],new Xr(this,t,t+1)));var s=n[6]||n[3]||(n[2]?"\\ ":" ");if(this.catcodes[s]===14){var i=e.indexOf(`
`,this.tokenRegex.lastIndex);return i===-1?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=i+1,this.lex()}return new kn(s,new Xr(this,t,this.tokenRegex.lastIndex))}}class KM{constructor(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new U("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var t in e)e.hasOwnProperty(t)&&(e[t]==null?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,n){if(n===void 0&&(n=!1),n){for(var s=0;s<this.undefStack.length;s++)delete this.undefStack[s][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{var i=this.undefStack[this.undefStack.length-1];i&&!i.hasOwnProperty(e)&&(i[e]=this.current[e])}t==null?delete this.current[e]:this.current[e]=t}}var XM=ox;T("\\noexpand",function(r){var e=r.popToken();return r.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}});T("\\expandafter",function(r){var e=r.popToken();return r.expandOnce(!0),{tokens:[e],numArgs:0}});T("\\@firstoftwo",function(r){var e=r.consumeArgs(2);return{tokens:e[0],numArgs:0}});T("\\@secondoftwo",function(r){var e=r.consumeArgs(2);return{tokens:e[1],numArgs:0}});T("\\@ifnextchar",function(r){var e=r.consumeArgs(3);r.consumeSpaces();var t=r.future();return e[0].length===1&&e[0][0].text===t.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}});T("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");T("\\TextOrMath",function(r){var e=r.consumeArgs(2);return r.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});var a6={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};T("\\char",function(r){var e=r.popToken(),t,n="";if(e.text==="'")t=8,e=r.popToken();else if(e.text==='"')t=16,e=r.popToken();else if(e.text==="`")if(e=r.popToken(),e.text[0]==="\\")n=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new U("\\char` missing argument");n=e.text.charCodeAt(0)}else t=10;if(t){if(n=a6[e.text],n==null||n>=t)throw new U("Invalid base-"+t+" digit "+e.text);for(var s;(s=a6[r.future().text])!=null&&s<t;)n*=t,n+=s,r.popToken()}return"\\@char{"+n+"}"});var t3=(r,e,t,n)=>{var s=r.consumeArg().tokens;if(s.length!==1)throw new U("\\newcommand's first argument must be a macro name");var i=s[0].text,a=r.isDefined(i);if(a&&!e)throw new U("\\newcommand{"+i+"} attempting to redefine "+(i+"; use \\renewcommand"));if(!a&&!t)throw new U("\\renewcommand{"+i+"} when command "+i+" does not yet exist; use \\newcommand");var o=0;if(s=r.consumeArg().tokens,s.length===1&&s[0].text==="["){for(var l="",c=r.expandNextToken();c.text!=="]"&&c.text!=="EOF";)l+=c.text,c=r.expandNextToken();if(!l.match(/^\s*[0-9]+\s*$/))throw new U("Invalid number of arguments: "+l);o=parseInt(l),s=r.consumeArg().tokens}return a&&n||r.macros.set(i,{tokens:s,numArgs:o}),""};T("\\newcommand",r=>t3(r,!1,!0,!1));T("\\renewcommand",r=>t3(r,!0,!1,!1));T("\\providecommand",r=>t3(r,!0,!0,!0));T("\\message",r=>{var e=r.consumeArgs(1)[0];return console.log(e.reverse().map(t=>t.text).join("")),""});T("\\errmessage",r=>{var e=r.consumeArgs(1)[0];return console.error(e.reverse().map(t=>t.text).join("")),""});T("\\show",r=>{var e=r.popToken(),t=e.text;return console.log(e,r.macros.get(t),Za[t],et.math[t],et.text[t]),""});T("\\bgroup","{");T("\\egroup","}");T("~","\\nobreakspace");T("\\lq","`");T("\\rq","'");T("\\aa","\\r a");T("\\AA","\\r A");T("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`}");T("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");T("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`}");T("","\\mathscr{B}");T("","\\mathscr{E}");T("","\\mathscr{F}");T("","\\mathscr{H}");T("","\\mathscr{I}");T("","\\mathscr{L}");T("","\\mathscr{M}");T("","\\mathscr{R}");T("","\\mathfrak{C}");T("","\\mathfrak{H}");T("","\\mathfrak{Z}");T("\\Bbbk","\\Bbb{k}");T("","\\cdotp");T("\\llap","\\mathllap{\\textrm{#1}}");T("\\rlap","\\mathrlap{\\textrm{#1}}");T("\\clap","\\mathclap{\\textrm{#1}}");T("\\mathstrut","\\vphantom{(}");T("\\underbar","\\underline{\\text{#1}}");T("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');T("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`}}");T("\\ne","\\neq");T("","\\neq");T("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`}}");T("","\\notin");T("","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`}}");T("","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`}}");T("","\\perp");T("","\\mathclose{!\\mkern-0.8mu!}");T("","\\notni");T("","\\ulcorner");T("","\\urcorner");T("","\\llcorner");T("","\\lrcorner");T("","\\copyright");T("","\\textregistered");T("","\\textregistered");T("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');T("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');T("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');T("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');T("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");T("","\\vdots");T("\\varGamma","\\mathit{\\Gamma}");T("\\varDelta","\\mathit{\\Delta}");T("\\varTheta","\\mathit{\\Theta}");T("\\varLambda","\\mathit{\\Lambda}");T("\\varXi","\\mathit{\\Xi}");T("\\varPi","\\mathit{\\Pi}");T("\\varSigma","\\mathit{\\Sigma}");T("\\varUpsilon","\\mathit{\\Upsilon}");T("\\varPhi","\\mathit{\\Phi}");T("\\varPsi","\\mathit{\\Psi}");T("\\varOmega","\\mathit{\\Omega}");T("\\substack","\\begin{subarray}{c}#1\\end{subarray}");T("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");T("\\boxed","\\fbox{$\\displaystyle{#1}$}");T("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");T("\\implies","\\DOTSB\\;\\Longrightarrow\\;");T("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");T("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");T("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var o6={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};T("\\dots",function(r){var e="\\dotso",t=r.expandAfterFuture().text;return t in o6?e=o6[t]:(t.slice(0,4)==="\\not"||t in et.math&&["bin","rel"].includes(et.math[t].group))&&(e="\\dotsb"),e});var r3={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};T("\\dotso",function(r){var e=r.future().text;return e in r3?"\\ldots\\,":"\\ldots"});T("\\dotsc",function(r){var e=r.future().text;return e in r3&&e!==","?"\\ldots\\,":"\\ldots"});T("\\cdots",function(r){var e=r.future().text;return e in r3?"\\@cdots\\,":"\\@cdots"});T("\\dotsb","\\cdots");T("\\dotsm","\\cdots");T("\\dotsi","\\!\\cdots");T("\\dotsx","\\ldots\\,");T("\\DOTSI","\\relax");T("\\DOTSB","\\relax");T("\\DOTSX","\\relax");T("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");T("\\,","\\tmspace+{3mu}{.1667em}");T("\\thinspace","\\,");T("\\>","\\mskip{4mu}");T("\\:","\\tmspace+{4mu}{.2222em}");T("\\medspace","\\:");T("\\;","\\tmspace+{5mu}{.2777em}");T("\\thickspace","\\;");T("\\!","\\tmspace-{3mu}{.1667em}");T("\\negthinspace","\\!");T("\\negmedspace","\\tmspace-{4mu}{.2222em}");T("\\negthickspace","\\tmspace-{5mu}{.277em}");T("\\enspace","\\kern.5em ");T("\\enskip","\\hskip.5em\\relax");T("\\quad","\\hskip1em\\relax");T("\\qquad","\\hskip2em\\relax");T("\\tag","\\@ifstar\\tag@literal\\tag@paren");T("\\tag@paren","\\tag@literal{({#1})}");T("\\tag@literal",r=>{if(r.macros.get("\\df@tag"))throw new U("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});T("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");T("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");T("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");T("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");T("\\newline","\\\\\\relax");T("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var wx=G(ei["Main-Regular"][84][1]-.7*ei["Main-Regular"][65][1]);T("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+wx+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");T("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+wx+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");T("\\hspace","\\@ifstar\\@hspacer\\@hspace");T("\\@hspace","\\hskip #1\\relax");T("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");T("\\ordinarycolon",":");T("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");T("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');T("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');T("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');T("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');T("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');T("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');T("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');T("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');T("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');T("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');T("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');T("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');T("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');T("","\\dblcolon");T("","\\eqcolon");T("","\\coloneqq");T("","\\eqqcolon");T("","\\Coloneqq");T("\\ratio","\\vcentcolon");T("\\coloncolon","\\dblcolon");T("\\colonequals","\\coloneqq");T("\\coloncolonequals","\\Coloneqq");T("\\equalscolon","\\eqqcolon");T("\\equalscoloncolon","\\Eqqcolon");T("\\colonminus","\\coloneq");T("\\coloncolonminus","\\Coloneq");T("\\minuscolon","\\eqcolon");T("\\minuscoloncolon","\\Eqcolon");T("\\coloncolonapprox","\\Colonapprox");T("\\coloncolonsim","\\Colonsim");T("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");T("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");T("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");T("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");T("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`}}");T("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");T("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");T("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");T("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");T("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");T("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");T("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");T("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");T("\\gvertneqq","\\html@mathml{\\@gvertneqq}{}");T("\\lvertneqq","\\html@mathml{\\@lvertneqq}{}");T("\\ngeqq","\\html@mathml{\\@ngeqq}{}");T("\\ngeqslant","\\html@mathml{\\@ngeqslant}{}");T("\\nleqq","\\html@mathml{\\@nleqq}{}");T("\\nleqslant","\\html@mathml{\\@nleqslant}{}");T("\\nshortmid","\\html@mathml{\\@nshortmid}{}");T("\\nshortparallel","\\html@mathml{\\@nshortparallel}{}");T("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{}");T("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{}");T("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{}");T("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{}");T("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{}");T("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{}");T("\\imath","\\html@mathml{\\@imath}{}");T("\\jmath","\\html@mathml{\\@jmath}{}");T("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`}}");T("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`}}");T("","\\llbracket");T("","\\rrbracket");T("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`}}");T("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`}}");T("","\\lBrace");T("","\\rBrace");T("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`}}");T("","\\minuso");T("\\darr","\\downarrow");T("\\dArr","\\Downarrow");T("\\Darr","\\Downarrow");T("\\lang","\\langle");T("\\rang","\\rangle");T("\\uarr","\\uparrow");T("\\uArr","\\Uparrow");T("\\Uarr","\\Uparrow");T("\\N","\\mathbb{N}");T("\\R","\\mathbb{R}");T("\\Z","\\mathbb{Z}");T("\\alef","\\aleph");T("\\alefsym","\\aleph");T("\\Alpha","\\mathrm{A}");T("\\Beta","\\mathrm{B}");T("\\bull","\\bullet");T("\\Chi","\\mathrm{X}");T("\\clubs","\\clubsuit");T("\\cnums","\\mathbb{C}");T("\\Complex","\\mathbb{C}");T("\\Dagger","\\ddagger");T("\\diamonds","\\diamondsuit");T("\\empty","\\emptyset");T("\\Epsilon","\\mathrm{E}");T("\\Eta","\\mathrm{H}");T("\\exist","\\exists");T("\\harr","\\leftrightarrow");T("\\hArr","\\Leftrightarrow");T("\\Harr","\\Leftrightarrow");T("\\hearts","\\heartsuit");T("\\image","\\Im");T("\\infin","\\infty");T("\\Iota","\\mathrm{I}");T("\\isin","\\in");T("\\Kappa","\\mathrm{K}");T("\\larr","\\leftarrow");T("\\lArr","\\Leftarrow");T("\\Larr","\\Leftarrow");T("\\lrarr","\\leftrightarrow");T("\\lrArr","\\Leftrightarrow");T("\\Lrarr","\\Leftrightarrow");T("\\Mu","\\mathrm{M}");T("\\natnums","\\mathbb{N}");T("\\Nu","\\mathrm{N}");T("\\Omicron","\\mathrm{O}");T("\\plusmn","\\pm");T("\\rarr","\\rightarrow");T("\\rArr","\\Rightarrow");T("\\Rarr","\\Rightarrow");T("\\real","\\Re");T("\\reals","\\mathbb{R}");T("\\Reals","\\mathbb{R}");T("\\Rho","\\mathrm{P}");T("\\sdot","\\cdot");T("\\sect","\\S");T("\\spades","\\spadesuit");T("\\sub","\\subset");T("\\sube","\\subseteq");T("\\supe","\\supseteq");T("\\Tau","\\mathrm{T}");T("\\thetasym","\\vartheta");T("\\weierp","\\wp");T("\\Zeta","\\mathrm{Z}");T("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");T("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");T("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");T("\\bra","\\mathinner{\\langle{#1}|}");T("\\ket","\\mathinner{|{#1}\\rangle}");T("\\braket","\\mathinner{\\langle{#1}\\rangle}");T("\\Bra","\\left\\langle#1\\right|");T("\\Ket","\\left|#1\\right\\rangle");var bx=r=>e=>{var t=e.consumeArg().tokens,n=e.consumeArg().tokens,s=e.consumeArg().tokens,i=e.consumeArg().tokens,a=e.macros.get("|"),o=e.macros.get("\\|");e.macros.beginGroup();var l=d=>f=>{r&&(f.macros.set("|",a),s.length&&f.macros.set("\\|",o));var p=d;if(!d&&s.length){var g=f.future();g.text==="|"&&(f.popToken(),p=!0)}return{tokens:p?s:n,numArgs:0}};e.macros.set("|",l(!1)),s.length&&e.macros.set("\\|",l(!0));var c=e.consumeArg().tokens,h=e.expandTokens([...i,...c,...t]);return e.macros.endGroup(),{tokens:h.reverse(),numArgs:0}};T("\\bra@ket",bx(!1));T("\\bra@set",bx(!0));T("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");T("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");T("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");T("\\angln","{\\angl n}");T("\\blue","\\textcolor{##6495ed}{#1}");T("\\orange","\\textcolor{##ffa500}{#1}");T("\\pink","\\textcolor{##ff00af}{#1}");T("\\red","\\textcolor{##df0030}{#1}");T("\\green","\\textcolor{##28ae7b}{#1}");T("\\gray","\\textcolor{gray}{#1}");T("\\purple","\\textcolor{##9d38bd}{#1}");T("\\blueA","\\textcolor{##ccfaff}{#1}");T("\\blueB","\\textcolor{##80f6ff}{#1}");T("\\blueC","\\textcolor{##63d9ea}{#1}");T("\\blueD","\\textcolor{##11accd}{#1}");T("\\blueE","\\textcolor{##0c7f99}{#1}");T("\\tealA","\\textcolor{##94fff5}{#1}");T("\\tealB","\\textcolor{##26edd5}{#1}");T("\\tealC","\\textcolor{##01d1c1}{#1}");T("\\tealD","\\textcolor{##01a995}{#1}");T("\\tealE","\\textcolor{##208170}{#1}");T("\\greenA","\\textcolor{##b6ffb0}{#1}");T("\\greenB","\\textcolor{##8af281}{#1}");T("\\greenC","\\textcolor{##74cf70}{#1}");T("\\greenD","\\textcolor{##1fab54}{#1}");T("\\greenE","\\textcolor{##0d923f}{#1}");T("\\goldA","\\textcolor{##ffd0a9}{#1}");T("\\goldB","\\textcolor{##ffbb71}{#1}");T("\\goldC","\\textcolor{##ff9c39}{#1}");T("\\goldD","\\textcolor{##e07d10}{#1}");T("\\goldE","\\textcolor{##a75a05}{#1}");T("\\redA","\\textcolor{##fca9a9}{#1}");T("\\redB","\\textcolor{##ff8482}{#1}");T("\\redC","\\textcolor{##f9685d}{#1}");T("\\redD","\\textcolor{##e84d39}{#1}");T("\\redE","\\textcolor{##bc2612}{#1}");T("\\maroonA","\\textcolor{##ffbde0}{#1}");T("\\maroonB","\\textcolor{##ff92c6}{#1}");T("\\maroonC","\\textcolor{##ed5fa6}{#1}");T("\\maroonD","\\textcolor{##ca337c}{#1}");T("\\maroonE","\\textcolor{##9e034e}{#1}");T("\\purpleA","\\textcolor{##ddd7ff}{#1}");T("\\purpleB","\\textcolor{##c6b9fc}{#1}");T("\\purpleC","\\textcolor{##aa87ff}{#1}");T("\\purpleD","\\textcolor{##7854ab}{#1}");T("\\purpleE","\\textcolor{##543b78}{#1}");T("\\mintA","\\textcolor{##f5f9e8}{#1}");T("\\mintB","\\textcolor{##edf2df}{#1}");T("\\mintC","\\textcolor{##e0e5cc}{#1}");T("\\grayA","\\textcolor{##f6f7f7}{#1}");T("\\grayB","\\textcolor{##f0f1f2}{#1}");T("\\grayC","\\textcolor{##e3e5e6}{#1}");T("\\grayD","\\textcolor{##d6d8da}{#1}");T("\\grayE","\\textcolor{##babec2}{#1}");T("\\grayF","\\textcolor{##888d93}{#1}");T("\\grayG","\\textcolor{##626569}{#1}");T("\\grayH","\\textcolor{##3b3e40}{#1}");T("\\grayI","\\textcolor{##21242c}{#1}");T("\\kaBlue","\\textcolor{##314453}{#1}");T("\\kaGreen","\\textcolor{##71B307}{#1}");var Sx={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class YM{constructor(e,t,n){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new KM(XM,t.macros),this.mode=n,this.stack=[]}feed(e){this.lexer=new i6(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var t,n,s;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;t=this.popToken(),{tokens:s,end:n}=this.consumeArg(["]"])}else({tokens:s,start:t,end:n}=this.consumeArg());return this.pushToken(new kn("EOF",n.loc)),this.pushTokens(s),new kn("",Xr.range(t,n))}consumeSpaces(){for(;;){var e=this.future();if(e.text===" ")this.stack.pop();else break}}consumeArg(e){var t=[],n=e&&e.length>0;n||this.consumeSpaces();var s=this.future(),i,a=0,o=0;do{if(i=this.popToken(),t.push(i),i.text==="{")++a;else if(i.text==="}"){if(--a,a===-1)throw new U("Extra }",i)}else if(i.text==="EOF")throw new U("Unexpected end of input in a macro argument, expected '"+(e&&n?e[o]:"}")+"'",i);if(e&&n)if((a===0||a===1&&e[o]==="{")&&i.text===e[o]){if(++o,o===e.length){t.splice(-o,o);break}}else o=0}while(a!==0||n);return s.text==="{"&&t[t.length-1].text==="}"&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:s,end:i}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new U("The length of delimiters doesn't match the number of args!");for(var n=t[0],s=0;s<n.length;s++){var i=this.popToken();if(n[s]!==i.text)throw new U("Use of the macro doesn't match its definition",i)}}for(var a=[],o=0;o<e;o++)a.push(this.consumeArg(t&&t[o+1]).tokens);return a}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new U("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var t=this.popToken(),n=t.text,s=t.noexpand?null:this._getExpansion(n);if(s==null||e&&s.unexpandable){if(e&&s==null&&n[0]==="\\"&&!this.isDefined(n))throw new U("Undefined control sequence: "+n);return this.pushToken(t),!1}this.countExpansion(1);var i=s.tokens,a=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){i=i.slice();for(var o=i.length-1;o>=0;--o){var l=i[o];if(l.text==="#"){if(o===0)throw new U("Incomplete placeholder at end of macro body",l);if(l=i[--o],l.text==="#")i.splice(o+1,1);else if(/^[1-9]$/.test(l.text))i.splice(o,2,...a[+l.text-1]);else throw new U("Not a valid argument number",l)}}}return this.pushTokens(i),i.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new kn(e)]):void 0}expandTokens(e){var t=[],n=this.stack.length;for(this.pushTokens(e);this.stack.length>n;)if(this.expandOnce(!0)===!1){var s=this.stack.pop();s.treatAsRelax&&(s.noexpand=!1,s.treatAsRelax=!1),t.push(s)}return this.countExpansion(t.length),t}expandMacroAsText(e){var t=this.expandMacro(e);return t&&t.map(n=>n.text).join("")}_getExpansion(e){var t=this.macros.get(e);if(t==null)return t;if(e.length===1){var n=this.lexer.catcodes[e];if(n!=null&&n!==13)return}var s=typeof t=="function"?t(this):t;if(typeof s=="string"){var i=0;if(s.indexOf("#")!==-1)for(var a=s.replace(/##/g,"");a.indexOf("#"+(i+1))!==-1;)++i;for(var o=new i6(s,this.settings),l=[],c=o.lex();c.text!=="EOF";)l.push(c),c=o.lex();l.reverse();var h={tokens:l,numArgs:i};return h}return s}isDefined(e){return this.macros.has(e)||Za.hasOwnProperty(e)||et.math.hasOwnProperty(e)||et.text.hasOwnProperty(e)||Sx.hasOwnProperty(e)}isExpandable(e){var t=this.macros.get(e);return t!=null?typeof t=="string"||typeof t=="function"||!t.unexpandable:Za.hasOwnProperty(e)&&!Za[e].primitive}}var l6=/^[]/,dp=Object.freeze({"":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"a","":"e","":"h","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"v","":"x","":"","":"","":"","":"","":"","":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"A","":"B","":"D","":"E","":"G","":"H","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"T","":"U","":"V","":"W","":"a","":"b","":"c","":"d","":"e","":"f","":"g",:"h","":"i",:"j","":"k",:"l","":"m",:"n","":"o","":"p",:"r",:"s","":"t","":"u","":"v",:"w",:"x",:"y","":"z","":"","":"","":"","":"","":"","":""}),Kg={"":{text:"\\'",math:"\\acute"},"":{text:"\\`",math:"\\grave"},"":{text:'\\"',math:"\\ddot"},"":{text:"\\~",math:"\\tilde"},"":{text:"\\=",math:"\\bar"},"":{text:"\\u",math:"\\breve"},"":{text:"\\v",math:"\\check"},"":{text:"\\^",math:"\\hat"},"":{text:"\\.",math:"\\dot"},"":{text:"\\r",math:"\\mathring"},"":{text:"\\H"},"":{text:"\\c"}},u6={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"b",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"j",:"j",:"k",:"k",:"k",:"l",:"l",:"l",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"p",:"p",:"r",:"r",:"r",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"t",:"t",:"t",:"t",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"v",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"J",:"K",:"K",:"K",:"L",:"L",:"L",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"P",:"P",:"R",:"R",:"R",:"R",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};class H1{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new YM(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(t===void 0&&(t=!0),this.fetch().text!==e)throw new U("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var t=this.nextToken;this.consume(),this.gullet.pushToken(new kn("}")),this.gullet.pushTokens(e);var n=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,n}parseExpression(e,t){for(var n=[];;){this.mode==="math"&&this.consumeSpaces();var s=this.fetch();if(H1.endOfExpression.indexOf(s.text)!==-1||t&&s.text===t||e&&Za[s.text]&&Za[s.text].infix)break;var i=this.parseAtom(t);if(i){if(i.type==="internal")continue}else break;n.push(i)}return this.mode==="text"&&this.formLigatures(n),this.handleInfixNodes(n)}handleInfixNodes(e){for(var t=-1,n,s=0;s<e.length;s++)if(e[s].type==="infix"){if(t!==-1)throw new U("only one infix operator per group",e[s].token);t=s,n=e[s].replaceWith}if(t!==-1&&n){var i,a,o=e.slice(0,t),l=e.slice(t+1);o.length===1&&o[0].type==="ordgroup"?i=o[0]:i={type:"ordgroup",mode:this.mode,body:o},l.length===1&&l[0].type==="ordgroup"?a=l[0]:a={type:"ordgroup",mode:this.mode,body:l};var c;return n==="\\\\abovefrac"?c=this.callFunction(n,[i,e[t],a],[]):c=this.callFunction(n,[i,a],[]),[c]}else return e}handleSupSubscript(e){var t=this.fetch(),n=t.text;this.consume(),this.consumeSpaces();var s;do{var i;s=this.parseGroup(e)}while(((i=s)==null?void 0:i.type)==="internal");if(!s)throw new U("Expected group after '"+n+"'",t);return s}formatUnsupportedCmd(e){for(var t=[],n=0;n<e.length;n++)t.push({type:"textord",mode:"text",text:e[n]});var s={type:"text",mode:this.mode,body:t},i={type:"color",mode:this.mode,color:this.settings.errorColor,body:[s]};return i}parseAtom(e){var t=this.parseGroup("atom",e);if((t==null?void 0:t.type)==="internal"||this.mode==="text")return t;for(var n,s;;){this.consumeSpaces();var i=this.fetch();if(i.text==="\\limits"||i.text==="\\nolimits"){if(t&&t.type==="op"){var a=i.text==="\\limits";t.limits=a,t.alwaysHandleSupSub=!0}else if(t&&t.type==="operatorname")t.alwaysHandleSupSub&&(t.limits=i.text==="\\limits");else throw new U("Limit controls must follow a math operator",i);this.consume()}else if(i.text==="^"){if(n)throw new U("Double superscript",i);n=this.handleSupSubscript("superscript")}else if(i.text==="_"){if(s)throw new U("Double subscript",i);s=this.handleSupSubscript("subscript")}else if(i.text==="'"){if(n)throw new U("Double superscript",i);var o={type:"textord",mode:this.mode,text:"\\prime"},l=[o];for(this.consume();this.fetch().text==="'";)l.push(o),this.consume();this.fetch().text==="^"&&l.push(this.handleSupSubscript("superscript")),n={type:"ordgroup",mode:this.mode,body:l}}else if(dp[i.text]){var c=l6.test(i.text),h=[];for(h.push(new kn(dp[i.text])),this.consume();;){var d=this.fetch().text;if(!dp[d]||l6.test(d)!==c)break;h.unshift(new kn(dp[d])),this.consume()}var f=this.subparse(h);c?s={type:"ordgroup",mode:"math",body:f}:n={type:"ordgroup",mode:"math",body:f}}else break}return n||s?{type:"supsub",mode:this.mode,base:t,sup:n,sub:s}:t}parseFunction(e,t){var n=this.fetch(),s=n.text,i=Za[s];if(!i)return null;if(this.consume(),t&&t!=="atom"&&!i.allowedInArgument)throw new U("Got function '"+s+"' with no arguments"+(t?" as "+t:""),n);if(this.mode==="text"&&!i.allowedInText)throw new U("Can't use function '"+s+"' in text mode",n);if(this.mode==="math"&&i.allowedInMath===!1)throw new U("Can't use function '"+s+"' in math mode",n);var{args:a,optArgs:o}=this.parseArguments(s,i);return this.callFunction(s,a,o,n,e)}callFunction(e,t,n,s,i){var a={funcName:e,parser:this,token:s,breakOnTokenText:i},o=Za[e];if(o&&o.handler)return o.handler(a,t,n);throw new U("No function handler for "+e)}parseArguments(e,t){var n=t.numArgs+t.numOptionalArgs;if(n===0)return{args:[],optArgs:[]};for(var s=[],i=[],a=0;a<n;a++){var o=t.argTypes&&t.argTypes[a],l=a<t.numOptionalArgs;(t.primitive&&o==null||t.type==="sqrt"&&a===1&&i[0]==null)&&(o="primitive");var c=this.parseGroupOfType("argument to '"+e+"'",o,l);if(l)i.push(c);else if(c!=null)s.push(c);else throw new U("Null argument, please report this as a bug")}return{args:s,optArgs:i}}parseGroupOfType(e,t,n){switch(t){case"color":return this.parseColorGroup(n);case"size":return this.parseSizeGroup(n);case"url":return this.parseUrlGroup(n);case"math":case"text":return this.parseArgumentGroup(n,t);case"hbox":{var s=this.parseArgumentGroup(n,"text");return s!=null?{type:"styling",mode:s.mode,body:[s],style:"text"}:null}case"raw":{var i=this.parseStringGroup("raw",n);return i!=null?{type:"raw",mode:"text",string:i.text}:null}case"primitive":{if(n)throw new U("A primitive argument cannot be optional");var a=this.parseGroup(e);if(a==null)throw new U("Expected group as "+e,this.fetch());return a}case"original":case null:case void 0:return this.parseArgumentGroup(n);default:throw new U("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(e,t){var n=this.gullet.scanArgument(t);if(n==null)return null;for(var s="",i;(i=this.fetch()).text!=="EOF";)s+=i.text,this.consume();return this.consume(),n.text=s,n}parseRegexGroup(e,t){for(var n=this.fetch(),s=n,i="",a;(a=this.fetch()).text!=="EOF"&&e.test(i+a.text);)s=a,i+=s.text,this.consume();if(i==="")throw new U("Invalid "+t+": '"+n.text+"'",n);return n.range(s,i)}parseColorGroup(e){var t=this.parseStringGroup("color",e);if(t==null)return null;var n=/^(#[a-f0-9]{3,4}|#[a-f0-9]{6}|#[a-f0-9]{8}|[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!n)throw new U("Invalid color: '"+t.text+"'",t);var s=n[0];return/^[0-9a-f]{6}$/i.test(s)&&(s="#"+s),{type:"color-token",mode:this.mode,color:s}}parseSizeGroup(e){var t,n=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?t=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):t=this.parseStringGroup("size",e),!t)return null;!e&&t.text.length===0&&(t.text="0pt",n=!0);var s=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t.text);if(!s)throw new U("Invalid size: '"+t.text+"'",t);var i={number:+(s[1]+s[2]),unit:s[3]};if(!M_(i))throw new U("Invalid unit: '"+i.unit+"'",t);return{type:"size",mode:this.mode,value:i,isBlank:n}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),t==null)return null;var n=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:n}}parseArgumentGroup(e,t){var n=this.gullet.scanArgument(e);if(n==null)return null;var s=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();var i=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var a={type:"ordgroup",mode:this.mode,loc:n.loc,body:i};return t&&this.switchMode(s),a}parseGroup(e,t){var n=this.fetch(),s=n.text,i;if(s==="{"||s==="\\begingroup"){this.consume();var a=s==="{"?"}":"\\endgroup";this.gullet.beginGroup();var o=this.parseExpression(!1,a),l=this.fetch();this.expect(a),this.gullet.endGroup(),i={type:"ordgroup",mode:this.mode,loc:Xr.range(n,l),body:o,semisimple:s==="\\begingroup"||void 0}}else if(i=this.parseFunction(t,e)||this.parseSymbol(),i==null&&s[0]==="\\"&&!Sx.hasOwnProperty(s)){if(this.settings.throwOnError)throw new U("Undefined control sequence: "+s,n);i=this.formatUnsupportedCmd(s),this.consume()}return i}formLigatures(e){for(var t=e.length-1,n=0;n<t;++n){var s=e[n],i=s.text;i==="-"&&e[n+1].text==="-"&&(n+1<t&&e[n+2].text==="-"?(e.splice(n,3,{type:"textord",mode:"text",loc:Xr.range(s,e[n+2]),text:"---"}),t-=2):(e.splice(n,2,{type:"textord",mode:"text",loc:Xr.range(s,e[n+1]),text:"--"}),t-=1)),(i==="'"||i==="`")&&e[n+1].text===i&&(e.splice(n,2,{type:"textord",mode:"text",loc:Xr.range(s,e[n+1]),text:i+i}),t-=1)}}parseSymbol(){var e=this.fetch(),t=e.text;if(/^\\verb[^a-zA-Z]/.test(t)){this.consume();var n=t.slice(5),s=n.charAt(0)==="*";if(s&&(n=n.slice(1)),n.length<2||n.charAt(0)!==n.slice(-1))throw new U(`\\verb assertion failed --
                    please report what input caused this bug`);return n=n.slice(1,-1),{type:"verb",mode:"text",body:n,star:s}}u6.hasOwnProperty(t[0])&&!et[this.mode][t[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+t[0]+'" used in math mode',e),t=u6[t[0]]+t.slice(1));var i=GM.exec(t);i&&(t=t.substring(0,i.index),t==="i"?t="":t==="j"&&(t=""));var a;if(et[this.mode][t]){this.settings.strict&&this.mode==="math"&&wy.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+t[0]+'" used in math mode',e);var o=et[this.mode][t].group,l=Xr.range(e),c;if(zP.hasOwnProperty(o)){var h=o;c={type:"atom",mode:this.mode,family:h,loc:l,text:t}}else c={type:o,mode:this.mode,loc:l,text:t};a=c}else if(t.charCodeAt(0)>=128)this.settings.strict&&(P_(t.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+t[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+t[0]+'"'+(" ("+t.charCodeAt(0)+")"),e)),a={type:"textord",mode:"text",loc:Xr.range(e),text:t};else return null;if(this.consume(),i)for(var d=0;d<i[0].length;d++){var f=i[0][d];if(!Kg[f])throw new U("Unknown accent ' "+f+"'",e);var p=Kg[f][this.mode]||Kg[f].text;if(!p)throw new U("Accent "+f+" unsupported in "+this.mode+" mode",e);a={type:"accent",mode:this.mode,loc:Xr.range(e),label:p,isStretchy:!1,isShifty:!0,base:a}}return a}}H1.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var n3=function(e,t){if(!(typeof e=="string"||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var n=new H1(e,t);delete n.gullet.macros.current["\\df@tag"];var s=n.parse();if(delete n.gullet.macros.current["\\current@color"],delete n.gullet.macros.current["\\color"],n.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new U("\\tag works only in display equations");s=[{type:"tag",mode:"text",body:s,tag:n.subparse([new kn("\\df@tag")])}]}return s},_x=function(e,t,n){t.textContent="";var s=s3(e,n).toNode();t.appendChild(s)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),_x=function(){throw new U("KaTeX doesn't work in quirks mode.")});var QM=function(e,t){var n=s3(e,t).toMarkup();return n},JM=function(e,t){var n=new B2(t);return n3(e,n)},xx=function(e,t,n){if(n.throwOnError||!(e instanceof U))throw e;var s=L.makeSpan(["katex-error"],[new Qn(t)]);return s.setAttribute("title",e.toString()),s.setAttribute("style","color:"+n.errorColor),s},s3=function(e,t){var n=new B2(t);try{var s=n3(e,n);return oM(s,e,n)}catch(i){return xx(i,e,n)}},ZM=function(e,t){var n=new B2(t);try{var s=n3(e,n);return lM(s,e,n)}catch(i){return xx(i,e,n)}},eI="0.16.25",tI={Span:Ef,Anchor:U2,SymbolNode:Qn,SvgNode:ra,PathNode:go,LineNode:yy},Xg={version:eI,render:_x,renderToString:QM,ParseError:U,SETTINGS_SCHEMA:rm,__parse:JM,__renderToDomTree:s3,__renderToHTMLTree:ZM,__setFontMetrics:PP,__defineSymbol:m,__defineFunction:Y,__defineMacro:T,__domTree:tI};function rI({statement:r,options:e}){const t=nt.useRef(null),n=nt.useRef([]);nt.useEffect(()=>{t.current&&s(t.current,r)},[r]),nt.useEffect(()=>{e&&e.forEach((a,o)=>{const l=n.current[o];l&&s(l,a)})},[e]);const s=(a,o)=>{try{const l=o.match(/<svg[\s\S]*?<\/svg>/i);if(l){const c=o.split(l[0]),h=c[0]||"",d=c[1]||"",f=document.createElement("div");i(f,h);const p=document.createElement("div");p.style.margin="20px 0",p.style.padding="20px",p.style.background="#fff",p.style.border="1px solid #e2e8f0",p.style.borderRadius="8px",p.innerHTML=l[0];const g=document.createElement("div");i(g,d),a.innerHTML="",a.appendChild(f),a.appendChild(p),a.appendChild(g)}else i(a,o)}catch{a.textContent=o}},i=(a,o)=>{const l=o.split(/(\$\$[\s\S]+?\$\$|\$[\s\S]+?\$|\\text\{[^}]+\}|\\[a-zA-Z]+)/g);a.innerHTML="",l.forEach(c=>{if(!c)return;const h=document.createElement("span");try{c.startsWith("$$")&&c.endsWith("$$")?Xg.render(c.slice(2,-2),h,{displayMode:!0,throwOnError:!1}):c.startsWith("$")&&c.endsWith("$")?Xg.render(c.slice(1,-1),h,{displayMode:!1,throwOnError:!1}):c.startsWith("\\")?Xg.render(c,h,{displayMode:!1,throwOnError:!1}):h.textContent=c}catch{h.textContent=c}a.appendChild(h)})};return z.jsxs("div",{style:{padding:"20px",background:"#fff",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[z.jsx("div",{ref:t,style:{fontSize:"16px",lineHeight:"1.6",marginBottom:e&&e.length>0?"16px":"0"}}),e&&e.length>0&&z.jsx("div",{style:{marginTop:"16px"},children:e.map((a,o)=>z.jsx("div",{ref:l=>n.current[o]=l,style:{padding:"12px",marginBottom:"8px",background:"#f7fafc",borderRadius:"6px",border:"1px solid #e2e8f0"}},o))})]})}const nI=[{type:"MCQ",enabled:!0,correct_marks:4,incorrect_marks:-1,skipped_marks:0,partial_marks:0,time_minutes:3},{type:"MSQ",enabled:!0,correct_marks:4,incorrect_marks:-2,skipped_marks:0,partial_marks:1,time_minutes:3},{type:"NAT",enabled:!0,correct_marks:4,incorrect_marks:0,skipped_marks:0,partial_marks:0,time_minutes:3},{type:"SUB",enabled:!0,correct_marks:10,incorrect_marks:0,skipped_marks:0,partial_marks:2,time_minutes:15}];function sI(){const[r,e]=nt.useState([]),[t,n]=nt.useState([]),[s,i]=nt.useState([]),[a,o]=nt.useState([]),[l,c]=nt.useState(""),[h,d]=nt.useState(""),[f,p]=nt.useState(""),[g,w]=nt.useState(""),[x,y]=nt.useState(nI),[b,_]=nt.useState(["","",""]),[C,R]=nt.useState([]),[I,O]=nt.useState(!0),[D,B]=nt.useState([]),[q,K]=nt.useState(!1);nt.useEffect(()=>{de()},[]),nt.useEffect(()=>{l&&Re(l)},[l]),nt.useEffect(()=>{h&&ge(h)},[h]),nt.useEffect(()=>{h&&Be(h,f)},[h,f]);const de=async()=>{const{data:F}=await Th.from("exams").select("id, name").order("name");F&&e(F)},Re=async F=>{const{data:se}=await Th.from("courses").select("id, name, exam_id").eq("exam_id",F).order("name");se&&n(se)},ge=async F=>{const{data:se}=await Th.from("slots").select("id, slot_name, course_id").eq("course_id",F).order("slot_name");se&&i(se)},Be=async(F,se)=>{let ae=Th.from("parts").select("id, part_name, course_id, slot_id").eq("course_id",F);se&&(ae=ae.eq("slot_id",se));const{data:Ie}=await ae.order("part_name");Ie&&o(Ie)},W=F=>{const ae=Array.from(F.target.files||[]).map(Ie=>({id:Math.random().toString(36).substr(2,9),file:Ie,year:new Date().getFullYear(),status:"pending",progress:0,totalPages:0,processedPages:0}));R(Ie=>[...Ie,...ae])},ne=(F,se)=>{const ae=[...b];ae[F]=se,_(ae)},V=()=>{_([...b,""])},le=F=>{_(b.filter((se,ae)=>ae!==F))},re=(F,se,ae)=>{const Ie=[...x];Ie[F]={...Ie[F],[se]:ae},y(Ie)},Se=(F,se)=>{R(ae=>ae.map(Ie=>Ie.id===F?{...Ie,year:se}:Ie))},ve=F=>{R(se=>se.filter(ae=>ae.id!==F))},De=async()=>{if(!h){alert("Please select exam and course");return}const F=b.filter(ae=>ae.trim()!=="");if(F.length===0){alert("Please provide at least one Gemini API key");return}K(!0),B([]);const se=new ZT(F);for(const ae of C)if(ae.status!=="completed")try{R(Ye=>Ye.map(je=>je.id===ae.id?{...je,status:"processing"}:je));const Ie=await rP(ae.file);R(Ye=>Ye.map(je=>je.id===ae.id?{...je,totalPages:Ie.length}:je));for(let Ye=0;Ye<Ie.length;Ye++){const je=Ie[Ye],Cs=Ct();let Zn=[],nn=0,li="",lr="";const Rs=6;for(let wt=1;wt<=Rs;wt++)try{wt===1?li=await se.analyzeImage(je,Cs):(console.log(`Page ${Ye+1}, attempt ${wt}: Fixing based on feedback: ${lr}`),li=await se.fixExtraction(je,li,lr));const jr=qt(li,ae.year);if(jr.length===0){if(console.log(`Page ${Ye+1}: No questions found, attempt ${wt}/${Rs}`),wt<Rs){lr="No questions were extracted. Please scan the image again and extract all complete questions.",await new Promise(q1=>setTimeout(q1,1e3));continue}break}const Tf=await se.verifyExtraction(je,li);if(nn=Tf.score,lr=Tf.feedback,console.log(`Page ${Ye+1}, attempt ${wt}: Score ${nn}% - ${lr}`),nn>=95){Zn=jr,console.log(`Page ${Ye+1}: Approved with score ${nn}%`);break}else wt<Rs?(console.log(`Page ${Ye+1}: Score too low (${nn}%), fixing issues...`),await new Promise(q1=>setTimeout(q1,1500))):(console.log(`Page ${Ye+1}: Max attempts reached, using best extraction (score: ${nn}%)`),Zn=jr)}catch(jr){if(console.error(`Page ${Ye+1}, attempt ${wt} failed:`,jr),wt===Rs)throw jr;lr="Previous attempt failed with error. Please try again.",await new Promise(Tf=>setTimeout(Tf,2e3))}for(const wt of Zn)if(B(jr=>[...jr,wt]),I)try{await Ve(wt)}catch(jr){console.error("Error auto-saving question:",jr)}R(wt=>wt.map(jr=>jr.id===ae.id?{...jr,processedPages:Ye+1,progress:(Ye+1)/Ie.length*100}:jr)),await new Promise(wt=>setTimeout(wt,100))}R(Ye=>Ye.map(je=>je.id===ae.id?{...je,status:"completed"}:je))}catch(Ie){console.error("Error processing PDF:",Ie),R(Ye=>Ye.map(je=>je.id===ae.id?{...je,status:"error",error:Ie.message}:je))}K(!1)},Ct=()=>`You are an expert at extracting questions from exam papers with PERFECT accuracy. Every detail matters.

IMPORTANT RULES:
1. Extract ONLY COMPLETE questions (ignore partial/continued questions)
2. You MUST use KaTeX for ALL mathematical content, tables, and matrices
3. You MUST create SVG for ALL visual elements (diagrams, circuits, graphs, etc.)
4. Extraction must be 100% accurate - students should not notice any difference

Question types to extract: ${x.filter(se=>se.enabled).map(se=>se.type).join(", ")}
- MCQ: Multiple Choice (single correct)
- MSQ: Multiple Select (multiple correct)
- NAT: Numerical Answer
- SUB: Subjective

FORMATTING REQUIREMENTS:

KaTeX (MANDATORY for ALL math, tables, matrices):
- Inline math: $x^2 + y^2 = z^2$
- Display math: $$\\int_0^1 f(x)dx$$
- Fractions: $\\frac{a}{b}$
- Matrices: $$\\begin{bmatrix}1 & 2\\\\3 & 4\\end{bmatrix}$$
- Bold variables: \\mathbf{P}, \\mathbf{Q}
- Greek letters: \\alpha, \\beta, \\gamma
- Symbols: \\sum, \\prod, \\int, \\infty

TABLES (CRITICAL - NEVER use plain text tables):
WRONG: Column-I | Column-II or using || symbols
RIGHT: $$\\begin{array}{|c|l|c|l|}\\hline\\textbf{Column-I} & & \\textbf{Column-II} & \\\\\\hline P. & \\text{This house is in a mess.} & 1. & \\text{Alright, I won't bring it up.}\\\\\\hline Q. & \\text{I am not happy with the marks.} & 2. & \\text{Well, you can look it up.}\\\\\\hline\\end{array}$$

KEY TABLE RULES:
- Use $$\\begin{array}{|c|l|c|l|}...\\end{array}$$ for ALL tables
- Use \\hline for horizontal lines
- Use & to separate columns
- Use \\\\ to end rows
- Use \\text{} for non-math text in tables
- Use \\textbf{} for bold headers
- Column alignment: |c| = centered, |l| = left, |r| = right

SVG (MANDATORY for ALL diagrams):
- Venn diagrams, circuits, graphs, geometric figures
- Use clean SVG with proper viewBox
- Label all elements accurately
- Match original exactly

EXAMPLE (Table with KaTeX):
question_statement: "Column-I has statements; Column-II has responses.

$$\\begin{array}{|c|l|c|l|}\\hline\\textbf{Column-I} & & \\textbf{Column-II} & \\\\\\hline P. & \\text{This house is in a mess.} & 1. & \\text{Alright, I won't bring it up.}\\\\\\hline Q. & \\text{Not happy with marks.} & 2. & \\text{You can look it up.}\\\\\\hline\\end{array}$$

Identify the correct match."

EXAMPLE (Diagram with SVG):
question_statement: "In the given figure, numbers 1, 2, and 3 are associated with rectangle, triangle, and circle. Find \\mathbf{P}, \\mathbf{Q}, \\mathbf{R}.

<svg width="600" height="400" viewBox="0 0 600 400" xmlns="http://www.w3.org/2000/svg"><style>.set{fill:none;stroke:black;stroke-width:2;}.label{font-size:20px;}</style><rect x="50" y="100" width="300" height="200" class="set"/><polygon points="350,50 550,320 150,320" class="set"/><circle cx="400" cy="220" r="120" class="set"/><text x="100" y="200" class="label">1</text></svg>"

OPTIONS (MCQ/MSQ):
- Use KaTeX for math: ["$P = 6$; $Q = 5$; $R = 3$", "$P = 5$; $Q = 6$; $R = 3$"]
- Ensure ALL options are visible

VALIDATION:
- Complete question statement
- ALL options visible (MCQ/MSQ)
- No "continued..." text
- All math in KaTeX
- All tables in KaTeX array format
- All diagrams in SVG
- NO plain text tables with || symbols

Return ONLY valid JSON (no markdown):
[{"question_type":"MCQ","question_statement":"What is $x^2$ if $x=2$?","options":["$2$","$4$","$8$","$16$"]}]

Empty if no complete questions: []`,qt=(F,se)=>{try{let ae=F.trim();ae=ae.replace(/```json\n?/g,"").replace(/```\n?/g,"");const Ie=JSON.parse(ae),Ye=Array.isArray(Ie)?Ie:[Ie];return!Ye||Ye.length===0?[]:Ye.filter(je=>je.question_type&&je.question_statement).map(je=>{const Cs=x.find(lr=>lr.type===je.question_type);if(!Cs)return null;const Zn=s.find(lr=>lr.id===f),nn=a.find(lr=>lr.id===g);return{question_type:je.question_type,question_statement:je.question_statement,options:je.options||null,course_id:h,year:se,slot:(Zn==null?void 0:Zn.slot_name)||"",part:(nn==null?void 0:nn.part_name)||"",correct_marks:Cs.correct_marks,incorrect_marks:Cs.incorrect_marks,skipped_marks:Cs.skipped_marks,partial_marks:Cs.partial_marks,time_minutes:Cs.time_minutes,categorized:!1,slot_id:f,part_id:g}}).filter(je=>je!==null)}catch(ae){return console.error("Error parsing Gemini response:",ae),[]}},Ve=async F=>{const se={question_type:F.question_type,question_statement:F.question_statement,options:F.options,course_id:F.course_id||null,year:F.year,slot:F.slot||null,part:F.part||null,correct_marks:F.correct_marks,incorrect_marks:F.incorrect_marks,skipped_marks:F.skipped_marks,partial_marks:F.partial_marks,time_minutes:F.time_minutes,categorized:F.categorized,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};F.slot_id&&(se.slot_id=F.slot_id),F.part_id&&(se.part_id=F.part_id);const{error:ae}=await Th.from("questions").insert(se);if(ae)throw console.error("Error saving question:",ae),ae};return z.jsxs("div",{style:{minHeight:"100vh",background:"#f5f7fa"},children:[z.jsxs("header",{style:{background:"#fff",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",alignItems:"center",gap:"12px"},children:[z.jsx("div",{style:{width:"40px",height:"40px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:"bold",fontSize:"20px"},children:"M"}),z.jsx("h1",{style:{fontSize:"24px",fontWeight:"600"},children:"Masters Up AI Platform"})]}),z.jsxs("main",{style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[z.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"32px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px"},children:[z.jsx("div",{style:{width:"60px",height:"60px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"30px"},children:""}),z.jsxs("div",{children:[z.jsx("h2",{style:{fontSize:"28px",fontWeight:"600",marginBottom:"4px"},children:"Super Advanced PDF Scanner"}),z.jsx("p",{style:{color:"#718096",fontSize:"14px"},children:"AI-powered vision system that scans every page and extracts all questions with perfect accuracy"})]})]}),z.jsxs("div",{style:{display:"flex",gap:"24px",padding:"16px",background:"#f7fafc",borderRadius:"8px",marginBottom:"24px"},children:[z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[z.jsx("span",{style:{color:"#667eea"},children:""}),z.jsx("span",{style:{fontSize:"14px",color:"#4a5568"},children:"Gemini Vision"})]}),z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[z.jsx("span",{style:{color:"#667eea"},children:""}),z.jsx("span",{style:{fontSize:"14px",color:"#4a5568"},children:"Page by Page Scanning"})]}),z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[z.jsx("span",{style:{color:"#667eea"},children:""}),z.jsx("span",{style:{fontSize:"14px",color:"#4a5568"},children:"KaTeX Support"})]})]}),z.jsxs("div",{style:{background:"#fff9e6",border:"1px solid #ffd666",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[z.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",color:"#d48806"},children:" Gemini API Keys (Smart Round Robin)"}),z.jsx("p",{style:{fontSize:"14px",color:"#8c6d1f",marginBottom:"12px"},children:"Add up to 100 Gemini API keys. The system will rotate them automatically and handle errors with 15-second delays."}),b.map((F,se)=>z.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[z.jsx("input",{type:"text",placeholder:`API Key ${se+1} (One-Click Import)`,value:F,onChange:ae=>ne(se,ae.target.value),style:{flex:1,padding:"10px 14px",border:"1px solid #d9d9d9",borderRadius:"6px",fontSize:"14px"}}),b.length>1&&z.jsx("button",{onClick:()=>le(se),style:{padding:"10px 16px",background:"#fff",border:"1px solid #ff4d4f",borderRadius:"6px",color:"#ff4d4f",cursor:"pointer",fontSize:"14px"},children:""})]},se)),z.jsx("button",{onClick:V,style:{marginTop:"8px",padding:"10px 20px",background:"#52c41a",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"+ Add API Key"}),z.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#e6f7ff",borderRadius:"6px"},children:[z.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#0050b3"},children:"How it works:"}),z.jsxs("ul",{style:{fontSize:"13px",color:"#096dd9",marginLeft:"20px",lineHeight:"1.8"},children:[z.jsx("li",{children:"Keys are used in round-robin rotation: 1st  2nd  3rd  1st"}),z.jsx("li",{children:"Keys with 15+ consecutive errors are temporarily disabled"}),z.jsx("li",{children:"Disabled keys retry after 15-second cooldown"}),z.jsx("li",{children:"Perfect for handling multiple PDFs without rate limits"})]})]})]}),z.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[z.jsxs("div",{children:[z.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:" Select Exam"}),z.jsxs("select",{value:l,onChange:F=>c(F.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d9d9d9",borderRadius:"6px",fontSize:"14px"},children:[z.jsx("option",{value:"",children:"Select exam"}),r.map(F=>z.jsx("option",{value:F.id,children:F.name},F.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:" Select Course"}),z.jsxs("select",{value:h,onChange:F=>d(F.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d9d9d9",borderRadius:"6px",fontSize:"14px"},disabled:!l,children:[z.jsx("option",{value:"",children:"Select course"}),t.map(F=>z.jsx("option",{value:F.id,children:F.name},F.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:" Slot"}),z.jsxs("select",{value:f,onChange:F=>p(F.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d9d9d9",borderRadius:"6px",fontSize:"14px"},disabled:!h,children:[z.jsx("option",{value:"",children:"Select a slot (optional)"}),s.map(F=>z.jsx("option",{value:F.id,children:F.slot_name},F.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:" Part"}),z.jsxs("select",{value:g,onChange:F=>w(F.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d9d9d9",borderRadius:"6px",fontSize:"14px"},disabled:!h,children:[z.jsx("option",{value:"",children:"Select a part (optional)"}),a.map(F=>z.jsx("option",{value:F.id,children:F.part_name},F.id))]})]})]}),z.jsxs("div",{style:{background:"#f7fafc",borderRadius:"8px",padding:"20px",marginBottom:"24px"},children:[z.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px"},children:"Question Types & Marking Scheme"}),z.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:x.map((F,se)=>z.jsxs("div",{style:{background:"#fff",padding:"16px",borderRadius:"8px",border:F.enabled?"2px solid #667eea":"1px solid #e2e8f0"},children:[z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[z.jsx("input",{type:"checkbox",checked:F.enabled,onChange:ae=>re(se,"enabled",ae.target.checked),style:{width:"18px",height:"18px",cursor:"pointer"}}),z.jsxs("label",{style:{fontSize:"14px",fontWeight:"600"},children:[F.type==="MCQ"&&" MCQ (Single Correct)",F.type==="MSQ"&&" MSQ (Multiple Correct)",F.type==="NAT"&&" NAT (Numerical Answer)",F.type==="SUB"&&" Subjective (Short Write)"]})]}),z.jsxs("div",{style:{fontSize:"12px",color:"#718096"},children:[z.jsxs("div",{style:{marginBottom:"4px"},children:[z.jsx("strong",{children:"Correct:"}),z.jsx("input",{type:"number",value:F.correct_marks,onChange:ae=>re(se,"correct_marks",Number(ae.target.value)),style:{width:"50px",marginLeft:"8px",padding:"4px",border:"1px solid #d9d9d9",borderRadius:"4px"}})]}),z.jsxs("div",{style:{marginBottom:"4px"},children:[z.jsx("strong",{children:"Incorrect:"}),z.jsx("input",{type:"number",value:F.incorrect_marks,onChange:ae=>re(se,"incorrect_marks",Number(ae.target.value)),style:{width:"50px",marginLeft:"8px",padding:"4px",border:"1px solid #d9d9d9",borderRadius:"4px"}})]}),z.jsxs("div",{style:{marginBottom:"4px"},children:[z.jsx("strong",{children:"Skipped:"}),z.jsx("input",{type:"number",value:F.skipped_marks,onChange:ae=>re(se,"skipped_marks",Number(ae.target.value)),style:{width:"50px",marginLeft:"8px",padding:"4px",border:"1px solid #d9d9d9",borderRadius:"4px"}})]}),z.jsxs("div",{style:{marginBottom:"4px"},children:[z.jsx("strong",{children:"Partial:"}),z.jsx("input",{type:"number",value:F.partial_marks,onChange:ae=>re(se,"partial_marks",Number(ae.target.value)),style:{width:"50px",marginLeft:"8px",padding:"4px",border:"1px solid #d9d9d9",borderRadius:"4px"}})]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Time (min):"}),z.jsx("input",{type:"number",value:F.time_minutes,onChange:ae=>re(se,"time_minutes",Number(ae.target.value)),style:{width:"50px",marginLeft:"8px",padding:"4px",border:"1px solid #d9d9d9",borderRadius:"4px"}})]})]})]},F.type))})]}),z.jsxs("div",{style:{marginBottom:"24px"},children:[z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[z.jsx("h3",{style:{fontSize:"16px",fontWeight:"600"},children:"Upload PDFs (Up to 20)"}),z.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[z.jsx("input",{type:"checkbox",checked:I,onChange:F=>O(F.target.checked),style:{width:"18px",height:"18px"}}),z.jsx("span",{style:{fontSize:"14px",color:"#4a5568"},children:" Auto save & Continue"})]})]}),z.jsx("input",{type:"file",accept:".pdf",multiple:!0,onChange:W,style:{display:"none"},id:"pdf-upload"}),z.jsxs("label",{htmlFor:"pdf-upload",style:{display:"block",padding:"40px",border:"2px dashed #cbd5e0",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:"#f7fafc"},children:[z.jsx("div",{style:{fontSize:"48px",marginBottom:"8px"},children:""}),z.jsx("div",{style:{fontSize:"16px",color:"#4a5568",marginBottom:"4px"},children:"Drop PDF or click"}),z.jsx("div",{style:{fontSize:"14px",color:"#718096"},children:"Upload multiple PDFs with their respective years. They will be processed one by one."})]}),C.length>0&&z.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginTop:"16px"},children:C.map(F=>z.jsxs("div",{style:{padding:"16px",background:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px"},children:[z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[z.jsx("div",{style:{fontSize:"14px",fontWeight:"500",flex:1},children:F.file.name}),z.jsx("button",{onClick:()=>ve(F.id),style:{padding:"4px 8px",background:"transparent",border:"none",color:"#e53e3e",cursor:"pointer",fontSize:"16px"},children:""})]}),z.jsxs("div",{style:{marginBottom:"8px"},children:[z.jsx("label",{style:{fontSize:"12px",color:"#718096",display:"block",marginBottom:"4px"},children:" Year"}),z.jsx("input",{type:"number",value:F.year,onChange:se=>Se(F.id,Number(se.target.value)),style:{width:"100%",padding:"6px",border:"1px solid #d9d9d9",borderRadius:"4px",fontSize:"14px"}})]}),z.jsxs("div",{style:{fontSize:"12px",color:"#718096",display:"flex",justifyContent:"space-between"},children:[z.jsxs("span",{children:["Status: ",F.status]}),F.totalPages>0&&z.jsxs("span",{children:[F.processedPages,"/",F.totalPages," pages"]})]}),F.progress>0&&z.jsx("div",{style:{marginTop:"8px",height:"4px",background:"#e2e8f0",borderRadius:"2px",overflow:"hidden"},children:z.jsx("div",{style:{width:`${F.progress}%`,height:"100%",background:"linear-gradient(90deg, #667eea 0%, #764ba2 100%)",transition:"width 0.3s"}})}),F.error&&z.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#fff5f5",borderRadius:"4px",fontSize:"12px",color:"#e53e3e"},children:F.error})]},F.id))})]}),z.jsx("button",{onClick:De,disabled:q||C.length===0,style:{width:"100%",padding:"16px",background:q?"#cbd5e0":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:q?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:q?" Processing...":" Scan & Extract Questions"})]}),D.length>0&&z.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"32px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[z.jsxs("h3",{style:{fontSize:"20px",fontWeight:"600"},children:["Extracted Questions (",D.length,")"]}),!I&&z.jsx("button",{onClick:async()=>{for(const F of D)await Ve(F);alert("All questions saved!")},style:{padding:"12px 24px",background:"#48bb78",color:"#fff",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Save All to Database"})]}),z.jsx("div",{style:{maxHeight:"600px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"24px"},children:D.map((F,se)=>z.jsxs("div",{style:{padding:"20px",background:"#f7fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[z.jsx("div",{style:{marginBottom:"16px",padding:"12px",background:"#fff",borderRadius:"8px",fontSize:"14px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:z.jsxs("div",{children:[z.jsxs("strong",{children:["Question ",se+1]})," |"," ",z.jsx("strong",{children:"Type:"})," ",F.question_type," |"," ",z.jsx("strong",{children:"Marks:"})," ",F.correct_marks," |"," ",z.jsx("strong",{children:"Year:"})," ",F.year,F.slot&&` | Slot: ${F.slot}`,F.part&&` | Part: ${F.part}`]})}),z.jsx(rI,{statement:F.question_statement,options:F.options})]},se))})]})]})]})}Yg.createRoot(document.getElementById("root")).render(z.jsx(qx.StrictMode,{children:z.jsx(sI,{})}));
